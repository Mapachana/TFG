MODELOS EPIDEMIOLÃ“GICOS
ana buendÃ­a ruiz-azuaga

Trabajo Fin de Grado
Doble Grado en IngenierÃ­a InformÃ¡tica y MatemÃ¡ticas
Tutores
Teresa E. PÃ©rez
Manuel Pegalajar CuÃ©llar
facultad de ciencias
e.t.s. ingenierÃ­as informÃ¡tica y de telecomunicaciÃ³n
Granada, a 21 de mayo de 2022

ÃNDICE GENERAL

1.

2.

introducciÃ³n
1.1.

MotivaciÃ³n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4

1.2.

Estado del arte . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5

1.3.

Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

1.4.

DescripciÃ³n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

1.5.

Fuentes y resultados . . . . . . . . . . . . . . . . . . . . . . . . .

6

1.6.

Estructura de la documentaciÃ³n . . . . . . . . . . . . . . . . . .

6

herramientas bÃ¡sicas

4.

2

7

Ecuaciones en diferencias . . . . . . . . . . . . . . . . . . . . . .

7

2.1.1.

Sistemas de ecuaciones en diferencias . . . . . . . . . .

9

2.1.2.

Puntos de equilibrio . . . . . . . . . . . . . . . . . . . .

9

2.2.

La ecuaciÃ³n logÃ­stica . . . . . . . . . . . . . . . . . . . . . . . .

11

2.3.

EpidemiologÃ­a . . . . . . . . . . . . . . . . . . . . . . . . . . . .

15

2.4.

Tipos de modelos epidemiolÃ³gicos . . . . . . . . . . . . . . . .

16

2.5.

OptimizaciÃ³n de parÃ¡metros . . . . . . . . . . . . . . . . . . . .

16

2.1.

3.

4

modelos discretos en epidemiologÃ­a

19

3.1.

Modelos discretos . . . . . . . . . . . . . . . . . . . . . . . . . .

19

3.2.

Modelo SI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

19

3.3.

Modelo SIR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

22

3.4.

Modelo SIS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

29

3.5.

Modelos multipoblacionales . . . . . . . . . . . . . . . . . . . .

33

3.5.1.

Modelo SI . . . . . . . . . . . . . . . . . . . . . . . . . .

35

3.5.2.

Modelo SIR . . . . . . . . . . . . . . . . . . . . . . . . .

36

3.5.3.

Modelo SIS . . . . . . . . . . . . . . . . . . . . . . . . .

37

modelos continuos en epidemiologÃ­a

39

4.1.

Tipos de modelos . . . . . . . . . . . . . . . . . . . . . . . . . .

39

4.2.

Modelo SI continuo . . . . . . . . . . . . . . . . . . . . . . . . .

40

4.3.

Modelo SIS continuo . . . . . . . . . . . . . . . . . . . . . . . .

42

4.4.

Modelo SIR continuo . . . . . . . . . . . . . . . . . . . . . . . .

44

4.5.

Modelo Kermack-McKendrick . . . . . . . . . . . . . . . . . . .

45

Ãndice general

.
.
.
.

48
48
50
52

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

53
53
54
55
55
55
56
57
57
59
61
62
63
64
72
73
74
74
75
75
75
78
81
82
86
86
86
89

conclusiones y vÃ­as futuras
6.1. Conclusiones . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6.2. VÃ­as futuras . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

93
93
93

4.6.

5.

6.

AnÃ¡lisis de los parÃ¡metros de los modelos
4.6.1. IntroducciÃ³n . . . . . . . . . . . . .
4.6.2. AproximaciÃ³n de I0 y Ï„ (t0 ) . . . .
4.6.3. FÃ³rmula teÃ³rica para Ï„ (t) . . . . .

desarrollo del software: anÃ¡lisis y
5.1. Objetivos y anÃ¡lisis de requisitos . . .
5.2. Desarrollo del proyecto . . . . . . . . .
5.3. GestiÃ³n de recursos . . . . . . . . . . .
5.3.1. Recursos humanos . . . . . . .
5.3.2. Recursos hardware . . . . . . .
5.3.3. Recursos software . . . . . . . .
5.3.4. EstimaciÃ³n del coste . . . . . .
5.4. PlanificaciÃ³n temporal . . . . . . . . .
5.5. Diagrama conceptual . . . . . . . . . .
5.6. Casos de uso . . . . . . . . . . . . . . .
5.6.1. Actores del sistema . . . . . . .
5.6.2. Diagrama de casos de uso . . .
5.6.3. Plantillas de casos de uso . . .
5.7. Diagramas de actividad . . . . . . . . .
5.8. Pruebas . . . . . . . . . . . . . . . . . .
5.8.1. Pruebas unitarias . . . . . . . .
5.8.2. Pruebas de usuario . . . . . . .
5.9. DiseÃ±o de la interfaz de usuario . . . .
5.10. Manual de usuario . . . . . . . . . . . .
5.10.1. DescripciÃ³n del proyecto . . . .
5.10.2. Comenzando a usar la web . .
5.10.3. Funcionalidades . . . . . . . . .
5.10.4. Ajuste de datos . . . . . . . . .
5.10.5. InstalaciÃ³n del backend . . . .
5.11. Datos reales . . . . . . . . . . . . . . . .
5.12. El VIH en Baleares . . . . . . . . . . . .
5.13. El covid en EspaÃ±a . . . . . . . . . . . .

BibliografÃ­a

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

diseÃ±o
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

93

3

1
INTRODUCCIÃ“N

1.1

motivaciÃ³n

Las enfermedades contagiosas como la influenza o tuberculosis son problemas importantes, asÃ­ como epidemias mÃ¡s recientes como el SIDA, el SARS
o el Ã‰bola. Estas enfermedades y sus comportamientos son interesantes para
una gran parte de la poblaciÃ³n. En especial, los efectos de estas u otras enfermedades en paÃ­ses menos desarrollados adquiere aÃºn mÃ¡s relevancia ya que
debido a la falta de medios la mortalidad y consecuencias de las epidemias
en estas regiones es mucho mÃ¡s grave que en otros lugares, lo que afecta
entre otros factores a su esperanza de vida y economÃ­a.
Las epidemias han tenido un peso importante en la civilizaciÃ³n a lo largo de
la historia, encontrando referencias a ellas en diversos escritos histÃ³ricos, pese
a que antiguamente se referÃ­an a estas epidemias como plagas, que registran
caÃ­das de imperios como el Imperio Romano por la plaga de Antonine o el
Imperio de Han en China en circunstancias similares, de acuerdo a cita y cita.
De la misma manera, hay constancia de las importantes consecuencias que
tuvo la plaga bubÃ³nica en Asia y Europa durante el siglo XIV.
Cuando hablamos de enfermedades contagiosas, especialmente si nos resultan desconocidas, surgen muchas preguntas, destacando entre otras â€Â¿CÃ³mo
de grave va a ser la epidemia?â€, â€Â¿CuÃ¡ntas personas van a contagiarse?â€ o
â€Â¿CuÃ¡nto va a durar la epidemia?â€.
Dado que los experimentos para obtener informaciÃ³n acerca de las epidemias
son casi imposibles de llevar a cabo por la propia naturaleza de las epidemias

4

1.2 estado del arte

y cuestiones Ã©ticas y morales, se suelen obtener los datos de las epidemias que
surgen naturalmente, por lo que muchos de estos datos no estÃ¡n completos
o pueden no ser precisos.
Los modelos matemÃ¡ticos en epidemiologÃ­a ayudan a comprender los mecanismos que intervienen en la propagaciÃ³n de la enfermedad a la vez que
sugieren mecanismos para el control de esta. Los modelos suelen identificar
comportamientos que no son evidentes en los datos empÃ­ricos.

1.2

estado del arte

La epidemiologÃ­a tiene su origen con HipÃ³crates de Cos, conocido como el
padre de la medicina. Fue la primera persona de la que se tiene conocimiento
que haya estudiado la relaciÃ³n entre la apariciÃ³n de enfermedades y su entorno. HipÃ³crates creÃ­a que la enfermedad era causada por el desequilibrio
de cuatro humores: sangre, flema, bilis amarilla y bilis negra. La cura para
las enfermedades era aÃ±adir o quitar el humor correspondiente para reequilibrar el cuerpo. Esta creencia comenzÃ³ la aplicaciÃ³n de sangrar a los enfermos
y aplicarles dietas en la medicina. UsÃ³ ademÃ¡s los tÃ©rminos endÃ©mico, para
enfermedades que se encuentran en ciertos lugares y no en otros, y epidemia
para enfermedades que se ven en unos momentos determinados pero no en
otros.
A mediados del siglo XVI el doctor Girolamo Fracastoro fue el primero en
proponer la teorÃ­a sobre la existencia de partÃ­culas tan pequeÃ±as que resultaban invisibles que causaban enfermedades. Se creÃ­a que se propagaban por
el aire, se multiplicaban por sÃ­ mismas y se podÃ­an destruir aplicando fuego.
Fue el primero en recomendar higiene personal y del entorno de los individuos para prevenir enfermedades. Finalmente, en 1675 Antonie van Leeuenhoek aportÃ³ evidencia visual de partÃ­culas consistentes con esta teorÃ­a con un
microscopio lo suficientemente potente.
AdemÃ¡s, Wu Youke tambiÃ©n tuvo la idea de que algunas enfermedades eran
causadas por agentes transmisibles cuando observÃ³ varias epidemias. Sus
consideraciones aÃºn resultan muy relevantes en la medicina china en la actualidad.

5

6

introducciÃ³n

Thomas Sydenham fue el primero en distinguir entre diversas fiebres entre
la poblaciÃ³n de Londres a finales de 1600.
John Graunt, un propietario de una tienda pequeÃ±a y estadÃ­stico aficionado
analizÃ³ la mortalidad en Londres antes de la Gran Plaga, presentando asÃ­
una de las primeras tablas de mortalidad, esto es, una tabla mostrando para
cada edad cuÃ¡l es la probabilidad de que una persona muera antes de su
prÃ³ximo cumpleaÃ±os. TambiÃ©n reportÃ³ tendencias en el tiempo de mÃºltiples
enfermedades, tanto nuevas como ya conocidas en la Ã©poca, asÃ­ como aportÃ³
evidencia estadÃ­stica para muchas teorÃ­as sobre las enfermedades, asÃ­ como
refutÃ³ otras creencias muy extendidas.
John Snow es ampliamente conocido por sus investigaciones sobre la epidemia de cÃ³lera del siglo XIV, y se le conoce como el padre de la epidemiologÃ­a
moderna. Entre sus diversas aportaciones, destaca como terminÃ³ el brote de
Broad Street, que el doctor estableciÃ³ se debÃ­a al agua proveniente de un pozo contaminado con heces en esa calle. MezclÃ³ cloro en el agua y cambiÃ³ la
bomba del pozo, frenando asÃ­ la epidemia. Esto supuso un gran avance de
cara a la higiene y sanidad pÃºblica, pese a que sus investigaciones y avances
no fueron puestas en prÃ¡ctica hasta despuÃ©s de su fallecimiento.
A principios del siglo XX se introdujeron modelos matemÃ¡ticos en la epidemiologÃ­a por Ronald Ross, Janed Lane-Claypon y Anderson Gray mcKendrick (cuyo modelo presentaremos mÃ¡s adelante), entre otros. Desde entonces, muchos especialistas se unieron progresivamente al estudio de este campo.

1.3

objetivos

1.4

descripciÃ³n

1.5

fuentes y resultados

1.6

estructura de la documentaciÃ³n

2
H E R R A M I E N TA S B Ã S I C A S

En este capÃ­tulo se presentarÃ¡n algunos conceptos y herramientas bÃ¡sicas que
nos resultarÃ¡n Ãºtiles a lo largo de los siguientes capÃ­tulos. Como referencias
se ha usado principalmente [3], [7] y [8].

2.1

ecuaciones en diferencias

Comenzamos presentando la teorÃ­a bÃ¡sica necesaria. Para su elaboraciÃ³n se
ha usado principalmente [7].
DefiniciÃ³n 1. Se define una ecuaciÃ³n en diferencias de orden k, con k â‰¥ 1,
como una ecuaciÃ³n en la que intervienen un nÃºmero fijo de tÃ©rminos consecutivos de una sucesiÃ³n.

F (n, Xn , Xn+1 , Â· Â· Â· , Xn+k ) = 0,

âˆ€n âˆˆ N,

(1)

donde F es una funciÃ³n de k + 2 variables en la forma F : N Ã— I k+1 â†’ R,
con I un intervalo con al menos dos puntos, k indica el nÃºmero de tÃ©rminos necesarios para generar el siguiente y donde la sucesiÃ³n { Xn }nâ‰¥0 es la
incÃ³gnita.
En las aplicaciones reales de ecuaciones en diferencias, el subÃ­ndice n suele
considerarse el tiempo, por lo que en estas se considera positivo y discreto.
DefiniciÃ³n 2. Una ecuaciÃ³n en diferencias de orden k, con k â‰¥ 1 se dice que
estÃ¡ en forma normal si estÃ¡ expresada de la forma:

7

8

herramientas bÃ¡sicas

Xn+k = Î¦(n, Xn , Xn+1 Â· Â· Â· , Xn+kâˆ’1 )

(2)

donde Î¦ es una funciÃ³n dada definida en Î¦ : N Ã— I k â†’ I.
DefiniciÃ³n 3. Una soluciÃ³n de una ecuaciÃ³n en diferencias de orden k es una
sucesiÃ³n { Xn }nâ‰¥0 de nÃºmeros reales definida explÃ­citamente de la forma:
Xn = f ( n ),

n â‰¥ 0,

donde f : N â†’ I es una funciÃ³n que cumple (1) al sustituir Xn por f (n) para
cualquier n âˆˆ N.
El conjunto de todas las soluciones de (1) se llama soluciÃ³n general de la
ecuaciÃ³n.
Teorema 1 (Existencia y unicidad). Sea Î¦ una funciÃ³n de la forma presentada en
(2). Entonces la ecuaciÃ³n en diferencias en forma normal (2) tiene soluciÃ³n. Para cada
k-upla (Î±0 , Î±1 , Â· Â· Â· , Î±kâˆ’1 ) âˆˆ I k el problema anterior en forma normal con condiciones
iniciales dadas tiene una Ãºnica soluciÃ³n.
Xn+k = Î¦(n, Xn , Xn+1 Â· Â· Â· , Xn+kâˆ’1 )

X0 = Î± 0 , X1 = Î± 1 , Â· Â· Â· , X k âˆ’ 1 = Î± k âˆ’ 1 .

(3)

DemostraciÃ³n. Sustituyendo las condiciones iniciales en (2) con k = 0 obtenemos el valor exacto para Xk , al que llamamos Î±k . Por definiciÃ³n de Î¦,
(Î±1 , Î±2 , Â· Â· Â· , Î±k ) âˆˆ I k , luego sustituyendo de nuevo en la misma ecuaciÃ³n por
las condiciones iniciales

X1 = Î± 1 , X2 = Î± 2 , Â· Â· Â· , X k = Î± k ,
obtenemos Xk+1 . Repitiendo este proceso se crea una sucesiÃ³n { Xn }nâ‰¥0 Ãºnica,
que es soluciÃ³n de (2).

2.1 ecuaciones en diferencias

2.1.1

Sistemas de ecuaciones en diferencias

DefiniciÃ³n 4. Se define un sistema de m ecuaciones en diferencias como un
conjunto de m ecuaciones en diferencias a resolver.

ï£±
ï£´
ï£´
Xn1 +k = Î¦1 (n, Xn1 , Â· Â· Â· , Xn1 +kâˆ’1 , Xn2 , Â· Â· Â· , Xn2 +kâˆ’1 , Â· Â· Â· , Xnm , Â· Â· Â· Xnm+kâˆ’1 )
ï£´
ï£´
ï£²
Â·Â·Â·
ï£´
ï£´
ï£´
ï£´
ï£³ m
Xn+k = Î¦m (n, Xn1 , Â· Â· Â· , Xn1 +kâˆ’1 , Xn2 , Â· Â· Â· , Xn2 +kâˆ’1 , Â· Â· Â· , Xnm , Â· Â· Â· Xnm+kâˆ’1 )

(4)

Donde Î¦i : N Ã— D â†’ D, con D âŠ‚ Rmk para todo i = 1, Â· Â· Â· , m.
Renombrando, podemos expresar el conjunto de sucesiones como:

Xn = ( Xn1 , Xn2 , Â· Â· Â· , Xnm ) T

(5)

luego el sistema de ecuaciones resultarÃ­a:

Xn+k = Î¦(n, Xn , Â· Â· Â· , Xn+kâˆ’1 )

(6)

donde Î¦ : D â†’ D, con D siendo el dominio de la funciÃ³n Î¦, y por tanto
D âŠ‚ N Ã— Rk y con Î¦ = (Î¦1 , Â· Â· Â· Î¦m ).
DefiniciÃ³n 5. Una soluciÃ³n de un sistema de ecuaciones en diferencias son
las soluciones explÃ­citas de cada ecuaciÃ³n del sistema, de forma que se satisfagan todas ellas; es decir, encontrar una soluciÃ³n explÃ­cita para Xn en (6).

2.1.2

Puntos de equilibrio

DefiniciÃ³n 6. Sea D âŠ‚ Rm y Î¦ : D â†’ D una funciÃ³n continua. Entonces
un vector X âˆ— âˆˆ Rm se dice que es un punto de equilibrio de un sistema de
ecuaciones en diferencias de la forma (6) si

9

10

herramientas bÃ¡sicas

X âˆ— = Î¦ ( X âˆ— ),

X âˆ— âˆˆ D.

Se suele decir que los puntos de equilibrio son soluciones independientes del
tiempo.
ProposiciÃ³n 1. Si tomamos como valor inicial un punto de equilibrio, llamemoslo
X âˆ— , de un sistema de ecuaciones en diferencias, entonces la soluciÃ³n explÃ­cita del
sistema es constante y viene dada por:
Xn = X âˆ— ,

âˆ€n âˆˆ N.

DefiniciÃ³n 7. Un punto de equilibrio X âˆ— de un sistema de ecuaciones en
diferencias como (6) se dice que es un atractor global o globalmente asintÃ³ticamente estable si para cualquier X0 âˆˆ D se verifica
lÄ±Ìm Xn = X âˆ— .

nâ†’âˆ

DefiniciÃ³n 8. Un punto de equilibrio X âˆ— de un sistema de ecuaciones en
diferencias como (6) se dice que es un atractor local (o es localmente asintÃ³ticamente estable) si existe Î· > 0 tal que para cualquier X0 âˆˆ D âˆ© B( X âˆ— , Î· ) se
verifica
lÄ±Ìm Xn = X âˆ— .
nâ†’âˆ

DefiniciÃ³n 9. Un punto de equilibrio X âˆ— de una ecuaciÃ³n en diferencias
Xn+1 = f ( Xn ), con f derivable se dice que es:
Estable si para cualquier e > 0 existe una constante Î´ > 0 tal que si
| X0 âˆ’ X âˆ— | < Î´ y Xn = f ( X0 ) con n âˆˆ N, entonces se verifica

| Xn âˆ’ X âˆ— | < e âˆ€n âˆˆ N.
Inestable si no es estable, esto es âˆƒe0 > 0 tal que para todo Î´ > 0
podemos encontrar X0 y n0 âˆˆ N tal que

| X0 âˆ’ X âˆ— | < Î´ y | X n 0 âˆ’ X âˆ— | > e0 .

2.2 la ecuaciÃ³n logÃ­stica

ProposiciÃ³n 2. Si X âˆ— es un punto de equilibrio de una ecuaciÃ³n en diferencias
Xn+1 = f ( Xn ), f âˆˆ C1 , entonces:
Si | f 0 ( X âˆ— )| < 1 entonces X âˆ— es un atractor local o localmente asintÃ³ticamente
estable.
Si | f 0 ( X âˆ— )| > 1 entonces X âˆ— es inestable.
ProposiciÃ³n 3. Si X âˆ— es un punto de equilibrio de una ecuaciÃ³n en diferencias
Xn+1 = f ( Xn ), con f âˆˆ C3 y f 0 ( X âˆ— ) = 1, entonces:
Si | f 00 ( X âˆ— )| 6= 0 entonces X âˆ— es inestable.
Si | f 00 ( X âˆ— )| = 0 y f 000 ( X âˆ— ) < 0 entonces X âˆ— es localmente asintÃ³ticamente
estable.
Si | f 00 ( X âˆ— )| = 0 y f 000 ( X âˆ— ) > 0 entonces X âˆ— es inestable.
2.2

la ecuaciÃ³n logÃ­stica

En este apartado describiremos la ecuaciÃ³n logÃ­stica discreta y sus principales
propiedades que serÃ¡n utilizadas mÃ¡s adelante. La teorÃ­a puede ampliarse en
[8].
DefiniciÃ³n 10. La ecuaciÃ³n logÃ­stica discreta tiene la siguiente forma:

xn+1 = Âµxn (1 âˆ’ xn ),

Âµ > 0,

que estÃ¡ definida en el intervalo [0, 1]. Definimos

f ( x ) = Âµx (1 âˆ’ x )
Para que 0 â‰¤ xn â‰¤ 1 es necesario que xn = f ( xnâˆ’1 ) estÃ© en el intervalo [0, 1].
Tenemos que f ( x ) es una parÃ¡bola cÃ³ncava con puntos de corte con el eje x
en 0 y 1. Para que f ( x ) < 1 su mÃ¡ximo debe ser menor que 1.
Este mÃ¡ximo se alcanza en

1
2

y su valor es

 


1
1
1
Âµ
f
=Âµ
1âˆ’
= .
2
2
2
4

11

12

herramientas bÃ¡sicas

Luego debe ser 0 < Âµ â‰¤ 4.
ProposiciÃ³n 4. Consideramos la ecuaciÃ³n logÃ­stica con 0 â‰¤ x0 â‰¤ 1 y 0 < Âµ â‰¤ 4.
Entonces los puntos de equilibrio son 0, siendo este estable si Âµ < 1 e inestable si
Âµ > 1; y 1 âˆ’ Âµ1 con Âµ â‰¥ 1 siendo estable si 1 < Âµ < 3 e inestable si Âµ > 3.
DemostraciÃ³n. Consideramos la ecuaciÃ³n logÃ­stica:
xn+1 = Âµxn (1 âˆ’ xn ),
y definamos f ( x ) = Âµx (1 âˆ’ x ). Es claro que f es de clase infinito por ser
polinÃ³mica.
Los puntos de equilibrio cumplen
x âˆ— = f ( x âˆ— ) = Âµx âˆ— (1 âˆ’ x âˆ— ).
Luego se tiene x âˆ— = 0 o 1 = Âµ(1 âˆ’ x âˆ— ), de donde se obtiene x âˆ— = 1 âˆ’ Âµ1 .
Estudiamos ahora la estabilidad de los puntos de equilibrio a travÃ©s de su
derivada, para ello consideramos:
f 0 ( x ) = Âµ(1 âˆ’ 2x ).
Entonces se tiene que f 0 (0) = Âµ, por lo tanto x âˆ— = 0 es localmente asintÃ³ticamente estable si Âµ < 1 e inestable si Âµ > 1. Estudiamos ahora el caso
Âµ = 1.
Tenemos f 00 ( x ) = âˆ’2Âµx y f 000 ( x ) = âˆ’2Âµ. Considerando Âµ = 1, tenemos que
f 0 (0) = 1,
f 00 (0) = 0,
f 000 (0) = âˆ’2.
Por tanto, 0 es localmente asintÃ³ticamente estable.

2.2 la ecuaciÃ³n logÃ­stica

Figura 1: Diagrama Cobweb de la ecuaciÃ³n logÃ­stica, con x0 = 0,2, Âµ = 2,8.

x0 = 0.2, Âµ = 2.8
1.0

0.8

Âµx(1 âˆ’ x)

0.6

0.4

0.2

0.0
0.0

0.2

0.4

0.6

0.8

1.0

x

f0



1
Âµ



Por otra parte,
1âˆ’
= 2 âˆ’ Âµ. Por tanto es localmente asintÃ³ticamente
estable si âˆ’1 < 2 âˆ’ Âµ < 1, o, equivalentemente, 1 < Âµ < 3 y es inestable si
Âµ > 3.
Se ha comprobado grÃ¡ficamente mediante las representaciones grÃ¡ficas (1) y
(2).
En (1) podemos ver como el punto de equilibrio x âˆ— = 0 es inestable y como
el otro punto de equilibrio x âˆ— es localmente asintÃ³ticamente estable.
Asimismo, en (2) observamos como ambos puntos de equilibrio son inestables.

ProposiciÃ³n 5. La ecuaciÃ³n logÃ­stica tiene un 2-ciclo para todo Âµ > 3, es decir,
existen dos puntos p y q tal que f ( p) = q y f (q) = p.
DemostraciÃ³n. Tenemos que f ( p) = q y f (q) = p es equivalente a f ( f ( p)) =
p y f ( f (q)) = q, es decir, p es un punto fijo al iterar dos veces la funciÃ³n
dada.

13

herramientas bÃ¡sicas

Figura 2: Diagrama Cobweb de la ecuaciÃ³n logÃ­stica, con x0 = 0,2, Âµ = 3,8.

x0 = 0.2, Âµ = 3.8
1.0

0.8

0.6

Âµx(1 âˆ’ x)

14

0.4

0.2

0.0
0.0

0.2

0.4

0.6

0.8

1.0

x

Como f ( x ) es una funciÃ³n polinÃ³mica de segundo grado, entonces f ( f ( x ))
serÃ¡ de cuarto grado, luego tendrÃ¡ 4 raÃ­ces entre reales y complejas.
Por tanto necesitamos resolver la ecuaciÃ³n de cuarto grado f ( f ( x )) = x. Sabemos que los puntos fijos de la ecuaciÃ³n logÃ­stica cumplen f ( x âˆ— ) = x âˆ— , luego
f ( f ( x âˆ— )) = f ( x âˆ— ) = x âˆ— ,
por lo que son soluciÃ³n de la ecuaciÃ³n. Y al factorizar conociendo estas soluciones el problema se reduce a resolver una ecuaciÃ³n cuadrÃ¡tica de la que
obtenemos las siguientes raÃ­ces:
p, q =

Âµ+1Â±

p

(Âµ âˆ’ 3)(Âµ + 1)
.
2Âµ

Estas soluciones son reales si Âµ > 3 luego existe un 2-ciclo.
Si Âµ = 3 estas raÃ­ces coinciden y valen p = q = 32 = 1 âˆ’
existe un 2-ciclo, hemos obtenido el mismo punto fijo.

1
3

= 1 âˆ’ Âµ1 , luego no

2.3 epidemiologÃ­a

Por Ãºltimo, si Âµ < 3 las raÃ­ces no son reales y por tanto no existe un 2ciclo.
Si Âµ = 3,3 tenemos que la soluciÃ³n de la ecuaciÃ³n logÃ­stica oscila repitiÃ©ndose
cada dos iteraciones, es decir, sigue un 2-ciclo. Si Âµ = 3,5 la soluciÃ³n se
repite cada 4 iteraciones, luego sigue un 4-ciclo. Se encuentran perÃ­odos mÃ¡s
grandes (de 8, 16, 32...) a medida que Âµ toma valores mayores.
Sea Âµn el valor de Âµ para el cual aparece un 2n -ciclo. Entonces experimentalmente se obtiene que Âµn converge a un valor Âµâˆ = 3,569946....
ProposiciÃ³n 6. En la ecuaciÃ³n logÃ­stica, se tiene que su soluciÃ³n converge si Âµ < 3,
oscila si 3 < Âµ . 3,57 y se produce caos si Âµ & 3,57.

2.3

epidemiologÃ­a

Las enfermedades infecciosas como la influenza (o gripe) o la tuberculosis
pueden ser severas. La epidemia del SIDA, pandemias recurrentes de influenza, brotes de Ã©bola y la pandemia del Covid-19 son acontecimientos que preocupan e interesan a muchas personas. La prevalencia y los efectos de estas
enfermedades sobre todo en paÃ­ses menos desarrollados son menos estudiadas, pero de mayor interÃ©s, pues la mortalidad de estas y otras enfermedades
en estas zonas es mucho mayor que en paÃ­ses desarrollados. Muchas enfermedades como la malaria o el cÃ³lera son endÃ©micas en muchas partes del
mundo. Los efectos de enfermedades con alta mortalidad en la esperanza de
vida y en la economÃ­a de los paÃ­ses afectados es considerable. Por ello, el
estudio y modelado de epidemias es muy relevante.
A continuaciÃ³n se explican algunos conceptos bÃ¡sicos de epidemiologÃ­a. Para
esta secciÃ³n se ha usado principalmente [3].
DefiniciÃ³n 11. Las epidemias son brotes espontÃ¡neos de una enfermedad o
situaciones endÃ©micas, en las que la enfermedad estÃ¡ siempre presente.
Los individuos de una poblaciÃ³n se pueden dividir en tres grupos, haciendo
referencia a su situaciÃ³n con respecto a la enfermedad.

15

16

herramientas bÃ¡sicas

DefiniciÃ³n 12. Los individuos susceptibles, que denotamos Sn , son aquellos
que pueden infectarse con la enfermedad pero aÃºn no lo han hecho en el
momento n.
DefiniciÃ³n 13. Los individuos infectados, a los que denotamos In , son las
personas infectadas en el instante n por la enfermedad y pueden contagiar la
enfermedad a los individuos susceptibles.
DefiniciÃ³n 14. Los individuos recuperados, que denotamos Rn , son los individuos que han estado infectados y ya no contagian la enfermedad ni pueden
volver a infectarse. Los individuos recuperados hacen referencia a los individuos inmunizados, aislados, recuperados o fallecidos.

2.4

tipos de modelos epidemiolÃ³gicos

Los modelos epidemiolÃ³gicos (principalmente SI, SIR y SIS) usan los estados
Susceptible, Infectado y Recuperado. Los nombres suelen hacer referencia al
flujo que se sigue para pasar entre los estados. AsÃ­, por ejemplo un modelo SI pasa de susceptible a infectado, uno SIR de susceptible a infectado y
recuperado y SIS alterna entre susceptible e infectado.
En estos modelos se hacen dos suposiciones:
1. La poblaciÃ³n se mezcla de manera homogÃ©nea, es decir, todos los individuos tienen la misma probabilidad de contraer la enfermedad.
2. El total de la poblaciÃ³n es constante y lo denotaremos por N.

2.5

optimizaciÃ³n de parÃ¡metros

Para la realizaciÃ³n de este proyecto se va a desarrollar una funcionalidad
quee estime los parÃ¡metros de los modelos de forma automÃ¡tica. Para ello,
se va a utilizar una funciÃ³n de pÃ©rdida que sea flexible a varios modelos,
buscando un equilibrio entre su rapidez y precisiÃ³n.
Se ha decidido utilizar scipy, pues proporciona diversas funciones para minimizar o maximizar funciones objetivo, posiblemente sujetas a restricciones.

2.5 optimizaciÃ³n de parÃ¡metros

Es importante destacar tambiÃ©n que sirve para problemas no lineales, como
lo son los modelos epidemiolÃ³gicos a estudiar.
DefiniciÃ³n 15. Llamamos funciÃ³n objetivo a la funciÃ³n que queremos maximizar o minimizar.
Dado un conjunto de datos con N datos ( x, y) y un modelo que aproxima
y en funciÃ³n de x, al que notamos yÌ‚ = f ( x, w) + Îµ. Tenemos que yÌ‚ es una
aproximaciÃ³n de y y Îµ el error de la aproximaciÃ³n segÃºn el modelo f . A los
parÃ¡metros del modelo, los hemos denotado w, son desconocidos y son los
que buscamos estimar de forma que yÌ‚ sea lo mÃ¡s parecido o cercano a y
posible.
Para medir la bondad del ajuste, escogemos una medida del error, en este
1
caso se ha tomado como medida 1+ MSE
, donde MSE es el Minimum Squared
Error o Error CuadrÃ¡tico Medio.
DefiniciÃ³n 16. El Error CuadrÃ¡tico Medio (MSE) de una aproximaciÃ³n yÌ‚ de
y se calcula como:
1 N
(yÌ‚ âˆ’ y)2
MSE(yÌ‚, y) =
N iâˆ‘
=1
Por tanto, queremos encontrar los parÃ¡metros que hagan mÃ­nima esta medida
del error, siendo esta nuestra funciÃ³n objetivo.
Para estimar estos parÃ¡metros, scipy nos ofrece varias funciones que podemos usar. Se han probado dos alternativas, minimize y curve_fit, ambas de
scipy.optimize.
Debido a la simplicidad, rapidez y resultar mÃ¡s intuitiva para su utilizaciÃ³n,
finalmente se ha optado por usar curve_fit en lugar de minimize.
curve_fit usa el mÃ©todo de mÃ­nimos cuadrados no lineales para ajustar la

funciÃ³n dada a los datos, y con el argumento method='lm', se usa el algoritmo de Levenberg-Marquardt en mÃ­nimos cuadrados. Pero dado que este
algoritmo solo admite problemas sin restricciones, no se usarÃ¡, pues todos
los parÃ¡metros en los modelos epidemiolÃ³gicos estÃ¡n sujetos a restricciones.

17

18

herramientas bÃ¡sicas

Para su utilizaciÃ³n, se define una funciÃ³n con el modelo para el ajuste, que
serÃ¡ el primer argumento de curve_fit. En nuestro caso esta funciÃ³n serÃ¡ un
modelo epidemiolÃ³gico. Su segundo argumento serÃ¡n los datos x o independientes, en el caso de modelos epidemiolÃ³gicos serÃ¡ el tiempo, tambiÃ©n los
datos y, que en nuestro caso serÃ¡n el nÃºmero de infectados, y finalmente como Ãºltimo parÃ¡metro se pueden proporcionar restricciones de los intervalos
a los que pertenecen los parÃ¡metros buscados.
La funciÃ³n devuelve los parÃ¡metros optimizados, a partir de los cuales obtenemos yÌ‚ y podemos calcular el error de forma explÃ­cita y la covarianza
estimada de los parÃ¡metros optimizados.
popt, pcov = curve_fit(modeloSI, tiempo, I, bounds=((0, 0), (np.inf, N)))

3
MODELOS DISCRETOS EN EPIDEMIOLOGÃA

3.1

modelos discretos

En este capÃ­tulo estudiaremos los principales modelos epidemiolÃ³gicos discretos.
En un modelo discreto el tiempo se considera que toma valores discretos,
siendo estos 1, 2, 3..., expresado en horas, dÃ­as, semanas...
Para realizar este capÃ­tulo se ha usado principalmente la referencia [1].

3.2

modelo si

El modelo SI es el modelo mÃ¡s simple de todos. Los individuos nacen siendo
susceptibles a una enfermedad, y una vez infectados permanecen infectados
el resto de su vida. Un ejemplo de una enfermedad que pueda modelarse
usando SI es el herpes.
Para n â‰¥ 0 las siguientes ecuaciones describen el modelo SI discreto:


S n +1
In+1


Î±âˆ†t
= Sn 1 âˆ’
In
N


Î±âˆ†t
Sn
= In 1 +
N

(7)

donde Sn indica el nÃºmero de individuos susceptibles en el instante tn , e In
hace referencia al nÃºmero de individuos infectados en ese instante. âˆ†t es el

19

20

modelos discretos en epidemiologÃ­a

tiempo transcurrido entre dos instantes tn+1 âˆ’ tn , y N es el tamaÃ±o total de
la poblaciÃ³n, con condiciones iniciales S0 > 0, I0 > 0 y S0 + I0 = N.
En estas ecuaciones Î± es la tasa de contacto; es decir, el nÃºmero medio de
individuos con los que un infectado tiene suficiente contacto para contagiarlo
en un intervalo de tiempo. Por tanto, Sn representa el nÃºmero de individuos
susceptibles en el tiempo nâˆ†t.
AdemÃ¡s, cabe destacar que a partir de (7) podemos obtener la ecuaciÃ³n logÃ­stica. Usando Sn + In = N tenemos

In+1 = In


Î±âˆ†t
1+
( N âˆ’ In ) ,
N

equivalentemente


In+1
In+1
Î±âˆ†t
In+1
N (1 + Î±âˆ†t)
luego, tomando Xn =
obtenemos:


Î±âˆ†t
= In 1 + Î±âˆ†t âˆ’
In â‡”
N


Î±âˆ†t
In â‡”
= In (1 + Î±âˆ†t) 1 âˆ’
N (1 + Î±âˆ†t)


Î±âˆ†t
Î±âˆ†t
=
In (1 + Î±âˆ†t) 1 âˆ’
In
N (1 + Î±âˆ†t)
N (1 + Î±âˆ†t)
Î±âˆ†t
I
N (1+Î±âˆ†t) n

(8)

y renombrando en la expresiÃ³n anterior,

Xn+1 = (1 + Î±âˆ†t) Xn (1 âˆ’ Xn ).
Que se corresponde con la expresiÃ³n de la ecuaciÃ³n logÃ­stica tomando Âµ =
1 + Î±âˆ†t.
Pasaremos a imponer las suposiciones descritas anteriormente para estos modelos. En primer lugar, suponemos que la poblaciÃ³n se mezcla de manera
homogÃ©nea de ahora en adelante. Para imponer la segunda suposiciÃ³n, la poblaciÃ³n total se mantiene constante, siendo trivial que se cumpla siempre, ya
que sumando el sistema de ecuaciones el resultado es N y asumimos que las
soluciones son siempre positivas dado que las soluciones negativas no tienen
sentido, ya que serÃ­a hablar de un nÃºmero negativo de individuos, ya sean
infectados, recuperados o susceptibles de contraer la enfermedad.

3.2 modelo si

ProposiciÃ³n 7. Las soluciones de las ecuaciones (7) son positivas si y solo si Î±âˆ†t â‰¤
1.
DemostraciÃ³n. Supongamos que In , Sn > 0. Por la segunda ecuaciÃ³n del
modelo (7) es claro que In+1 > 0, pues Sn > 0 y 1 + Î±âˆ†t
N > 0.
Para la primera ecuaciÃ³n tenemos que Sn+1 > 0 si y solo si
1âˆ’

Î±âˆ†t
In > 0,
N

ya que Sn es positivo por hipÃ³tesis. Esto equivale a N > Î±âˆ†tIn , y puesto que
Sn + In = N se tiene:
N > Î±âˆ†t( N âˆ’ Sn ),
esto es
Î±âˆ†tSn > (Î±âˆ†t âˆ’ 1) N.
Como Î±âˆ†tSn > 0, tenemos entonces que la desigualdad se da para todo n si
y solo si:
Î±âˆ†t âˆ’ 1 â‰¤ 0 â‡” Î±âˆ†t â‰¤ 1.

Lema 1. Sn es monÃ³tonamente decreciente e In es monÃ³tonamente creciente.
DemostraciÃ³n. Sn+1 es Sn multiplicado por un valor menor que 1, mientras
que In+1 corresponde a In multiplicado por un valor mayor que 1.
Buscamos ahora ver cual es el comportamiento del sistema, calculando los
puntos de equilibrio; esto es, las soluciones constantes en el tiempo, resolviendo:

Î±âˆ†t âˆ—
S = S 1âˆ’
I
N


Î±âˆ†t âˆ—
âˆ—
âˆ—
I = I 1+
S
N
âˆ—

âˆ—



Sâˆ— + I âˆ— = N

21

modelos discretos en epidemiologÃ­a

Figura 3: GrÃ¡fica del modelo SI discreto, en una poblaciÃ³n total de 100 individuos,
con valores iniciales S0 = 99, I0 = 1, Î± = 0,1, T0 = 0, T = 100.

100
80
Datos

22

60

Susceptibles
Infectados

40
20
0

0

20

40

tiempo

60

80

100

Los Ãºnicos puntos de equilibrio posibles son: (Sâˆ— , I âˆ— ) = (0, N ) y (Sâˆ— , I âˆ— ) =
( N, 0). Puesto que las condiciones iniciales son positivas y como Sn es monÃ³tonamente decreciente e In es monÃ³tonamente creciente, asÃ­ Sn+1 < Sn y
In+1 > In para cualquier n âˆˆ N, entonces debe converger a (Sâˆ— , I âˆ— ) = (0, N ),
pues son sucesiones monÃ³tonas acotadas.
En la figura 4, se representa el nÃºmero de individuos infectados en funciÃ³n
del nÃºmero de susceptibles se aprecia una relaciÃ³n lineal pero inversamente
proporcional, donde al subir el nÃºmero de infectados baja el de susceptibles
y al contrario.

3.3

modelo sir

El modelo SIR comienza como el SI, pero tras infectarse los individuos pasan
a un estado Recuperado, en el cual no pueden volver a infectarse ni infectar
a otros. Un ejemplo de este tipo de enfermedad es la varicela.

3.3 modelo sir

Figura 4: GrÃ¡fica del modelo SI, representando el nÃºmero de infectados segÃºn el nÃºmero de individuos susceptibles, en una poblaciÃ³n total de 100 individuos,
con valores iniciales S0 = 99, I0 = 1, Î± = 0,1, T0 = 0, T = 100.

â€“QIHFWDGRV

0RGHOR 6â€“

6XVFHSWLEOHV

El modelo es el siguiente:

S n +1 = S n

In+1 = In

Î±âˆ†t
1âˆ’
In
N



Î±âˆ†t
1 âˆ’ Î³âˆ†t +
Sn
N



(9)

Rn+1 = Rn + Î³âˆ†tIn
con condiciones iniciales S0 > 0, I0 > 0, R0 â‰¥ 0, satisfaciendo S0 + I0 + R0 =
N.
En estas ecuaciones, de nuevo tenemos que Î± es la tasa de contacto, esto es, el
nÃºmero medio de individuos con los que un infectado tiene suficiente contacto para contagiarlo en un intervalo de tiempo, y Î³ es la probabilidad de que
un infectado pase a recuperado/retirado/aislado/fallecido en un intervalo
de tiempo, con Î± > 0 y Î³ > 0.
Se supone que la poblaciÃ³n permanece constante, esto es: Sn + In + Rn = N.

23

24

modelos discretos en epidemiologÃ­a

ProposiciÃ³n 8. Las soluciones a este sistema discreto son positivas para cualquier
valor de las condiciones iniciales si, y solo si:

maÌx Î³âˆ†t, Î±âˆ†t â‰¤ 1
o equivalentemente:

mÄ±Ìn

1 1
,
Î³ Î±



â‰¥ âˆ†t

DemostraciÃ³n. Comenzamos probando una de las implicaciones, suponien
do que maÌx Î³âˆ†t, Î±âˆ†t â‰¤ 1.
Por hipÃ³tesis inicial, tenemos que S0 , I0 > 0, R0 â‰¥ 0 y S0 + I0 + R0 = N, luego
es suficiente comprobar que:
1âˆ’
Lo cual es evidente, pues

In
N

Î±âˆ†t
I0 > 0.
N

< 1 por hipÃ³tesis del modelo y Î±âˆ†t < 1.

Por un razonamiento anÃ¡logo, como Î³âˆ†t < 1, tenemos que
1 âˆ’ Î³âˆ†t +

Î±âˆ†t
S0 > 0.
N

Y finalmente
R0 + Î³âˆ†tI0 > 0
pues Î³ > 0 y âˆ†t > 0.
Aplicando un razonamiento por inducciÃ³n, suponiÃ©ndolo para n se puede
demostrar que Sn+1 , In+1 , Rn+1 son siempre positivas.
Para probar el recÃ­proco basta probar que ambas cantidades son menores o
iguales a 1. Comenzamos trabajando en la primera ecuaciÃ³n (9).

S n +1 = S n

Î±âˆ†t
1âˆ’
In
N



3.3 modelo sir

Por hipÃ³tesis Sn , Sn+1 > 0, entonces 1 âˆ’ Î±âˆ†t
N In > 0. Usamos de nuevo que
In â‰¤ N luego:
Î±âˆ†t
0 < 1âˆ’
In â‰¤ 1 âˆ’ Î±âˆ†t,
N
y por tanto:
Î±âˆ†t â‰¤ 1.
Puesto que Î±âˆ†t â‰¤ 1 y In â‰¤ N, n â‰¥ 0, entonces Sn+1 < Sn para cualquier
n â‰¥ 0, luego es una sucesiÃ³n estrictamente decreciente. Por otro lado, In es
siempre positiva, por tanto
1 âˆ’ Î³âˆ†t +

Î±âˆ†t
Sn > 0
N

n â‰¥ 0,

y Sn estrictamente decreciente, por tanto 1 âˆ’ Î³âˆ†t â‰¥ 0.
Luego, despejando tenemos Î³âˆ†t â‰¤ 1.
De la Ãºltima ecuaciÃ³n no sacamos ninguna condiciÃ³n mÃ¡s, pues su soluciÃ³n
es siempre positiva por definiciÃ³n de Î³ y âˆ†t.

Lema 2. Sn es estrictamente decreciente y Rn es estrictamentre creciente.
DemostraciÃ³n.
Por el Lema 1 de [1], se tiene que lÄ±Ìmnâ†’âˆ Sn = Sâˆ > 0, cuyo lÃ­mite existe,
pues es una sucesiÃ³n estrictamente decreciente y acotada inferiormente por
0.
Estudiamos las condiciones iniciales. Si S0 â‰¤ Î³N
Î± , y, como Sn es estrictamente
decreciente, tenemos que In+1 â‰¤ In , es decir, no hay epidemia, ya que la
velocidad de propagaciÃ³n no es lo bastante alta.
NÎ³
En otro caso, tenemos S0 > Î³N
Î± , entonces I1 > I0 . Debe ocurrir que Sâˆ < Î± ,
pues si no fuera asÃ­, tendrÃ­amos que In crece hacia un equilibrio, Iâˆ , lo que
implica que Rn se aproxima a infinito cuando n â†’ âˆ, lo que no es posible, pues el total de la poblaciÃ³n es constante. AsÃ­, el nÃºmero de infectados
finalmente comienza a decrecer.

25

modelos discretos en epidemiologÃ­a

Figura 5: GrÃ¡fica del modelo SIR, en una poblaciÃ³n total de 100 individuos, con valores iniciales S0 = 99, I0 = 1, R0 = 0, Î± = 0,1, Î³ = 0,01, T0 = 0, T = 300.

100
80
Datos

26

60

Susceptibles
Infectados
Recuperados

40
20
0
0

50

100

150
tiempo

200

250

300

Por tanto, a partir del resultado anterior podemos deducir que el intervalo
de tiempo, âˆ†t, debe ser menor que el tiempo medio requerido para contagiar
a otro individuo susceptible, Î±, y menor que el perÃ­odo medio infeccioso, Î³.
El comportamiento global del sistema es fÃ¡cil de ver. Definimos el nÃºmero
bÃ¡sico reproductivo como la constante

RSIR =

S0 Î±
.
NÎ³

El valor de RSIR determina el comportamiento global del modelo. En particular, si RSIR < 1 se considera que no hay epidemia.
En otros trabajos como [5] este nÃºmero bÃ¡sico reproductivo se llama tasa de
transmisiÃ³n media.
En la figura 6 se representan el nÃºmero de infectados y los individuos susceptibles. En este modelo, al contrario de lo que ocurrÃ­a en el modelo SI no son

3.3 modelo sir

Figura 6: GrÃ¡fica del modelo SIR, representando el nÃºmero de infectados segÃºn el
nÃºmero de individuos susceptibles, en una poblaciÃ³n total de 100 individuos, con valores iniciales S0 = 99, I0 = 1, Î± = 0,1, Î³ = 0,01, T0 = 0, T =
300.

â€“QIHFWDGRV

0RGHOR 6â€“5 â€“ 6

6XVFHSWLEOHV

cantidades inversamente proporcionales. Vemos que primero los infectados
crecen muy rÃ¡pidamente y despuÃ©s decaen mÃ¡s lentamente, esto es porque
las personas susceptibles se infectan, pero despuÃ©s aunque los individuos
susceptibles sigan disminuyendo los infectados bajan, esto es debido a que
los individuos previamente infectados se estÃ¡n recuperando.
Estudiamos ahora la figura 7, en la que se muestra como varÃ­an los individuos
recuperados en funciÃ³n de los susceptibles.
A medida que los individuos susceptibles crecen los recuperados disminuyen,
en particular se ve un decrecimiento exponencial. Esto se debe a que los individuos susceptibles primero deben infectarse y luego recuperarse, y, como
ya hemos visto en la figura 6 los infectados bajan muy rÃ¡pidamente cuando
las personas susceptibles son pocas, por ello los recuperados tambiÃ©n crecen
rÃ¡pidamente a menor nÃºmero de individuos susceptibles.
Finalmente, en la figura 8 se muestran los individuos recuperados en funciÃ³n
de los infectados, en una grÃ¡fica implÃ­cita del tiempo.

27

modelos discretos en epidemiologÃ­a

Figura 7: GrÃ¡fica del modelo SIR discreto, representando el nÃºmero de recuperados
segÃºn el nÃºmero de individuos susceptibles, en una poblaciÃ³n total de 100
individuos, con valores iniciales S0 = 99, I0 = 1, Î± = 0,1, Î³ = 0,01, T0 =
0, T = 300.
0RGHOR 6â€“5 5 6

5HFXSHUDGRV

28

6XVFHSWLEOHV

3.4 modelo sis

Figura 8: GrÃ¡fica del modelo SIR discreto, representando el nÃºmero de recuperados
segÃºn el nÃºmero de individuos infectados, en una poblaciÃ³n total de 100
individuos, con valores iniciales S0 = 99, I0 = 1, Î± = 0,1, Î³ = 0,01, T0 =
0, T = 300.

5HFXSHUDGRV

0RGHOR 6â€“5 5 â€“

â€“QIHFWDGRV

Un aspecto a tener en cuenta es la distancia entre las marcas en la curva.
Cada marca indica la medida del nÃºmero de infectados y recuperados en un
mismo tiempo t.
Al comenzar el nÃºmero de recuperados es bajo y crece despacio a medida que
aumentan los infectados. Llega un punto mÃ¡ximo del nÃºmero de infectados,
en el que se produce la curva, y cuando los infectados comienzan a descrecer
los recuperados aumentan rÃ¡pidamente, lo que se puede ver por la distancia
mÃ¡s corta que hay entre las marcas de la curva.

3.4

modelo sis

El modelo SIS es similar al SI, con la salvedad de que los individuos son susceptibles a mÃºltiples reinfecciones. Por ejemplo, los resfriados pueden modelarse usando SIS.
El modelo es una perturbaciÃ³n del modelo SI descrito anteriormente. Se define de la siguiente forma:

29

30

modelos discretos en epidemiologÃ­a





+ Î³âˆ†tIn


Î±âˆ†t
= In 1 âˆ’ Î³âˆ†t +
Sn
N

S n +1 = S n
In+1

Î±âˆ†t
In
1âˆ’
N

(10)

con condiciones iniciales positivas S0 > 0, I0 > 0 cumpliendo S0 + I0 = N.
Por lo tanto, el tamaÃ±o de la poblaciÃ³n es constante.
En estas ecuaciones, Î± de nuevo representa la tasa de contacto, esto es, el nÃºmero medio de individuos con los que un infectado tiene suficiente contacto
para contagiarlo en un intervalo de tiempo, y Î³ es la probabilidad de que
un infectado pase a recuperado/retirado/aislado en un intervalo de tiempo,
donde se cumple Î± > 0 y Î³ > 0.
ProposiciÃ³n 9. Las soluciones de (10) siempre son positivas si, y solo si:

Î³âˆ†t â‰¤ 1
y


Î±âˆ†t < 1 +

p

2
Î³âˆ†t

DemostraciÃ³n. Sea I0 = e y S0 = N âˆ’ e, entonces por la definiciÃ³n del modelo
tenemos:


Nâˆ’e
I1 = e 1 âˆ’ Î³âˆ†t + Î±âˆ†t
N
2
Î±âˆ†te
(11)
=âˆ’
+ e(1 âˆ’ Î³âˆ†t + Î±âˆ†t)
N
= p(e)
Luego tenemos que ver cuÃ¡ndo la parÃ¡bola satisface 0 < p(e) < N para
0 < e < N.
Notemos que p(0) = 0 y p( N ) = N (1 âˆ’ Î³âˆ†t).
Sea (eâˆ— , pâˆ— ) el vÃ©rtice de la parÃ¡bola, entonces
âˆ—

âˆ—

(e , p ) =



N (1 âˆ’ Î³âˆ†t + Î±âˆ†t) N (1 âˆ’ Î³âˆ†t + Î±âˆ†t)2
,
2Î±âˆ†t
4Î±âˆ†t


.

3.4 modelo sis

Por tanto, 0 < p(e) < N para 0 < e < N si y solo si:

Î³âˆ†t â‰¤ 1,
y por tanto, o bien eâˆ— â‰¥ N, que es equivalente a Î±âˆ†t â‰¤ 1 âˆ’ Î³âˆ†t, o bien eâˆ— <
N y pâˆ— < N, lo que requiere que Î±âˆ†t > 1 âˆ’ Î³âˆ†t y (1 âˆ’ Î³âˆ†t + Î±âˆ†t)2 < 4Î±âˆ†t.
Estas desigualdades se dan si y solo si:

2
p
1 âˆ’ Î³âˆ†t < Î±âˆ†t < 1 + Î³âˆ†t .

En el modelo SIS, el nÃºmero bÃ¡sico reproductivo se define como

RSIS =

Î±
.
Î³

Lema 3. Los puntos de equilibrio de (10) son o bien (Sâˆ— , I âˆ— ) = ( N, 0), o bien
NÎ³
(Sâˆ— , I âˆ— ) = ( NÎ³
Î± , N âˆ’ Î± ).
DemostraciÃ³n. Consideramos los puntos de equilibrio (Sâˆ— , I âˆ— ) cumpliendo
(10) y satisfaciendo Sâˆ— + I âˆ— = N.
Por tanto, resolvemos el sistema:

âˆ—



Î±âˆ†t âˆ—
1âˆ’
I
N



+ Î³âˆ†tI âˆ—


Î±âˆ†t âˆ—
âˆ—
âˆ—
I = I 1 âˆ’ Î³âˆ†t +
S
N

S =S

âˆ—

de donde se tiene:

âˆ—

I =I

âˆ—



Î±âˆ†t âˆ—
1 âˆ’ Î³âˆ†t +
S
N



â‡”

Distinguimos por tanto dos posibles casos:

Î±âˆ†t âˆ— âˆ—
S I = Î³âˆ†tI âˆ—
N

(12)

31

32

modelos discretos en epidemiologÃ­a

O bien, si I âˆ— = 0 se da la igualdad, y, dado que Sâˆ— + I âˆ— = N tenemos que
Sâˆ— = N. Un primer punto de equilibrio serÃ­a por tanto (Sâˆ— , I âˆ— ) = ( N, 0).
âˆ—
O bien I âˆ— 6= 0, luego se tiene que S = NÎ³
Î± , y por tanto I = N âˆ’
NÎ³
de equilibrio por tanto serÃ­a (Sâˆ— , I âˆ— ) = ( NÎ³
Î± , N âˆ’ Î± ).

NÎ³
Î± .

El punto

Lema 4. Si RSIS â‰¤ 1 entonces se tiene que In+1 < In , ya que 0 < Sn < N y las
soluciones son positivas. En este caso es fÃ¡cil ver que el lÃ­mite, al ser una sucesiÃ³n
monÃ³tona decreciente y acotada inferiormente, es (Sâˆ— , I âˆ— ) = ( N, 0).
Si RSIS > 1 las soluciones convergen si se cumple la condiciÃ³n Î±âˆ†t â‰¤ 2 + Î³âˆ†t.
DemostraciÃ³n. Supongamos que Sâˆ— < N, entonces existen n1 , e tales que
para todo n â‰¥ n1 :
Sn < S âˆ— + e < N
y usando las ecuaciones (10)

In+1 = In

Î±âˆ†t
Sn
1 âˆ’ Î³âˆ†t +
N



â‰¤ In (1 âˆ’ Î³âˆ†t + Î±âˆ†t)

(13)

= In Ï
donde hemos denotado Ï = 1 âˆ’ Î³âˆ†t + Î±âˆ†t.
Como Ï < 1 tendrÃ­amos que I âˆ— = 0, lo que contradice que Sâˆ— < N.
Si RSIS > 1 realizando la sustituciÃ³n Sn = N âˆ’ In y el cambio
xn =

Î±âˆ†tIn
,
N (1 + Î±âˆ†t âˆ’ Î³âˆ†t)

tenemos:
Î±âˆ†tIn = xn N (1 + Î±âˆ†t âˆ’ Î³âˆ†t) â‡”
In = xn

N (1 + Î±âˆ†t âˆ’ Î³âˆ†t)
Î±âˆ†t

(14)

3.5 modelos multipoblacionales

entonces sustituyendo en la ecuaciÃ³n (10):

N (1 âˆ’ Î±âˆ†t âˆ’ Î³âˆ†t)
=
Î±âˆ†t



N (1 + Î±âˆ†t âˆ’ Î³âˆ†t)
Î±âˆ†t
N (1 + Î±âˆ†t âˆ’ Î³âˆ†t)
xn
1 âˆ’ Î³âˆ†t +
N âˆ’ xn
Î±âˆ†t
N
Î±âˆ†t
x n +1

(15)

Despejando de esta expresiÃ³n:

x n +1 = x n

Î±âˆ†t
Î±âˆ†t N (1 + Î±âˆ†t âˆ’ Î³âˆ†t)
1 âˆ’ Î³âˆ†t +
Nâˆ’
xn
N
N
Î±âˆ†t



= xn (1 âˆ’ Î³âˆ†t + Î±âˆ†t âˆ’ xn (1 + Î±âˆ†t âˆ’ Î³âˆ†t))

(16)

= xn ((1 âˆ’ Î³âˆ†t + Î±âˆ†t)(1 âˆ’ xn ))

luego obtenemos la ecuaciÃ³n logÃ­stica con parÃ¡metro Âµ = 1 âˆ’ Î³âˆ†t + Î±âˆ†t
xn+1 = (1 âˆ’ Î³âˆ†t + Î±âˆ†t) xn (1 âˆ’ xn ).
En el modelo SIS la restricciÃ³n necesaria para garantizar soluciones positivas
no es suficiente para asegurar la convergencia. En este caso a dicha restricciÃ³n
hay que aÃ±adir la condiciÃ³n Î±âˆ†t â‰¤ 2 + Î³âˆ†t, restricciÃ³n del parÃ¡metro de la
ecuaciÃ³n logÃ­stica para la convergencia, como vimos en el capÃ­tulo 1.

En la figura (10) se representa el nÃºmero de infectados en funciÃ³n del nÃºmero
de individuos susceptibles. Se puede ver que son inversamente proporcionales, es decir, a mayor nÃºmero de infectados menos individuos susceptibles
hay y al revÃ©s.
Cabe destacar el parecido de esta grÃ¡fica con su anÃ¡loga del modelo SI (4).

3.5

modelos multipoblacionales

Los modelos multipoblacionales agrupan la poblaciÃ³n en varias subpoblaciones. En estas subpoblaciones, los individuos pertenecientes a una misma

33

modelos discretos en epidemiologÃ­a

Figura 9: GrÃ¡fica del modelo SIS, en una poblaciÃ³n total de 100 individuos, con valores iniciales S0 = 95, I0 = 5, Î± = 0,1, Î³ = 0,01, T0 = 0, T = 150.
0RGHOR 6â€“6

6XVFHSWLEOHV

6XVFHSWLEOHV â€“QIHFWDGRV

â€“QIHFWDGRV

7LHPSR

Figura 10: GrÃ¡fica del modelo SIS discreto, representando el nÃºmero de infectados
segÃºn el nÃºmero de individuos susceptibles, en una poblaciÃ³n total de 100
individuos, con valores iniciales S0 = 95, I0 = 5, Î± = 0,1, Î³ = 0,01, T0 =
0, T = 200.
0RGHOR 6â€“6

â€“QIHFWDGRV

34

6XVFHSWLEOHV

3.5 modelos multipoblacionales

subpoblaciÃ³n interactÃºan entre ellos, y, al mismo tiempo, interactÃºan las distintas subpoblaciones entre ellas.
De esta forma, se obtiene un modelo mÃ¡s realista, pues no se asume que
todos los individuos interactÃºan igual con todos los demÃ¡s individuos de la
poblaciÃ³n, si no que se relacionan formando grupos mÃ¡s pequeÃ±os que a su
vez interactÃºan entre ellos.

3.5.1

Modelo SI

El modelo SI discreto multipoblacional muestra el mismo comportamiento
monÃ³tono que el modelo SI discreto. Este modelo permite agrupar la poblaciÃ³n en varias subpoblaciones que se relacionan entre ellas, a la vez que los
individuos de cada una de ellas interactÃºan, permitiendo asÃ­ obtener datos
mÃ¡s realistas. Se considera el modelo SI con k subpoblaciones:

Sni

Î± âˆ†t
1 âˆ’ âˆ‘ ik i Ink
N
k =1
K

Sni +1

=

Ini +1

Î± âˆ†t
= Ini + Sni âˆ‘ ik i Ink
N
k =1
K

!
(17)

donde i = 1, Â· Â· Â· , K y con las condiciones iniciales S0i > 0 y I0i â‰¥ 0 para todo
valor de i, existiendo algÃºn k cumpliendo I0k > 0. Y ademÃ¡s, para todo i debe
satisfacerse S0i + I0i = N i , siendo N i el tamaÃ±o de la i-Ã©sima subpoblaciÃ³n.
Asimismo, Î±ik es la tasa de contacto en la subpoblaciÃ³n i-Ã©sima, es decir, el
nÃºmero medio de contactos por unidad de tiempo de un grupo infeccioso k
con individuos del grupo i.
Como en el caso discreto ya estudiado, el tamaÃ±o de cada subpoblaciÃ³n se
mantiene constante, Sni + Ini = N i .
ProposiciÃ³n 10. Las soluciones del sistema (17) son no negativas para cualquieras
condiciones iniciales si, y solo si,
(
maÌx
i

Î±ik âˆ†tN k
âˆ‘ Ni
k =1
K

)

â‰¤1

35

36

modelos discretos en epidemiologÃ­a

ProposiciÃ³n 11. Cada Sni es estrictamente monÃ³tonamente decreciente para cada i
y se aproxima a 0, mientras Ini es monÃ³tonamente creciente y se aproxima a N i .
3.5.2 Modelo SIR
El modelo SIR discreto multipoblacional muestra el mismo comportamiento
monÃ³tono que el modelo SIR discreto. Se considera el modelo SIR con K
subpoblaciones:
Î± âˆ†t
1 âˆ’ âˆ‘ ik i Ink
N
k =1
K

Sni +1 = Sni

Ini +1 = Ini (1 âˆ’ Î³i âˆ†t) + Sni

!

Î±ik âˆ†t k
I
Ni n
k =1
K

âˆ‘

(18)

Rin+1 = Rin + Î³i âˆ†tIni
donde i = 1, Â· Â· Â· , K y con las condiciones iniciales S0i > 0, R0i â‰¥ 0 y I0i â‰¥ 0
para todo valor de i, existiendo algÃºn k cumpliendo I0k > 0. Y ademÃ¡s, para
todo i debe satisfacerse S0i + I0i + R0i = N, siendo N i el tamaÃ±o de la i-Ã©sima
subpoblaciÃ³n. Asimismo, Î±ik es la tasa de contacto en la subpoblaciÃ³n i-Ã©sima,
es decir, el nÃºmero medio de contactos por unidad de tiempo de un grupo
infeccioso k con individuos del grupo i y Î³i es la probabilidad de que un
infectado pase a recuperado/retirado/aislado/fallecido en un intervalo de
tiempo.
Como en el caso discreto ya estudiado, el tamaÃ±o de cada subpoblaciÃ³n se
mantiene constante, Sni + Ini + Rin = N i .
ProposiciÃ³n 12. Las soluciones del sistema (18) son no negativas para cualquiera
condiciones iniciales si, y solo si,
(
maÌx
i

Î±ik âˆ†tN k
âˆ‘ N i , Î³i âˆ†t
k =1
K

)

â‰¤1

ProposiciÃ³n 13. Cada Sni es estrictamente monÃ³tonamente decreciente para cada
i, mientras Rin es monÃ³tonamente estrictamente creciente. AdemÃ¡s, al estar ambas
acotadas, se obtiene que Ini se aproxima a 0 en el lÃ­mite n â†’ âˆ.

3.5 modelos multipoblacionales

En el modelo multipoblacional no es tan simple determinar si ocurre una
epidemia en una subpoblaciÃ³n como en el modelo con una sola poblaciÃ³n.
Consideramos

RiSIR =

S0i Î±ii
.
Î³i N i

Si RiSIR > 1 entonces el nÃºmero de infectados en la i-Ã©sima poblaciÃ³n comenzarÃ¡ a crecer. Sin embargo, si RiSIR â‰¤ 1 no es suficiente para garantizar
que no se producirÃ¡ una epidemia en la poblaciÃ³n i-esima, ya que las otras
poblaciones influyen tambiÃ©n en esta.
En lugar de considerar las subpoblaciones independientemente unas de otras,
se debe tener en cuenta el total de infectados:
K

In =

âˆ‘ Ini .

i =1
Si Î±
âˆ‘iK=1 Î³0 Niki
k



Si Î±
âˆ‘iK=1 Î³0 Niki
k




Si maÌxk

Si mÄ±Ìnk

â‰¤ 1 entonces In decrece y no hay una epidemia.
> 1 entonces In crece y hay una epidemia.

Como hemos visto, no se puede definir de manera sencilla un nÃºmero bÃ¡sico
reproductivo.

3.5.3

Modelo SIS

El modelo SIS discreto multipoblacional muestra el mismo comportamiento
que el modelo SIS discreto. Se considera el modelo SIS con K subpoblaciones:

Sni +1 = Sni
Ini +1

Î±ik âˆ†t k
I
Ni n
k =1
K

1âˆ’

âˆ‘

!

+ Î³i âˆ†tIni

Î± âˆ†t
= Ini (1 âˆ’ Î³i âˆ†t) + Sni âˆ‘ ik i Ink
N
k =1
K

(19)

donde i = 1, Â· Â· Â· , K, y con las condiciones iniciales S0i > 0 y I0i â‰¥ 0 para todo
valor de i, existiendo algÃºn k cumpliendo I0k > 0. Y ademÃ¡s, para todo i debe
satisfacerse S0i + I0i = N i , siendo N i el tamaÃ±o de la i-Ã©sima subpoblaciÃ³n.

37

38

modelos discretos en epidemiologÃ­a

Asimismo, Î±ik es la tasa de contacto en la subpoblaciÃ³n i-Ã©sima, es decir, el
nÃºmero medio de contactos por unidad de tiempo de un grupo infeccioso k
con individuos del grupo i, y Î³i es la probabilidad de que un infectado pase
a susceptible de nuevo en un intervalo de tiempo.
Como en el caso discreto ya estudiado, el tamaÃ±o de cada subpoblaciÃ³n se
mantiene constante, Sni + Ini = N i .
ProposiciÃ³n 14. Las soluciones del sistema (19) son no negativas para cualquieras
condiciones iniciales si, y solo si,
(
maÌx
i

âˆ‘

k 6 =i

Î±ik

âˆ†tN k
Ni

)
, Î³i âˆ†t

â‰¤ 1,

ï£«v
ï£¶2
u
k
p
u
Î± âˆ†tN
Î±ii âˆ†t â‰¤ ï£­t1 âˆ’ âˆ‘ ik i
+ Î³i âˆ†tï£¸
N
k 6 =i

4
MODELOS CONTINUOS EN EPIDEMIOLOGÃA

Los modelos continuos, al igual que los discretos, tratan de describir la evoluciÃ³n y desarrollo de una enfermedad a lo largo del tiempo. La diferencia con
los modelos discretos es que, al contrario que en estos, el tiempo se supone
continuo.
Mientras en los modelos discretos consideramos un âˆ†t que hace referencia
a los incrementos del tiempo entre dos valores consecutivos de la cantidad
de individuos de cada estado, en los modelos continuos el tiempo se supone
continuo, y por tanto no se trabaja con una cantidad numerable de valores.

4.1

tipos de modelos

Al igual que los modelos discretos, los modelos continuos (principalmente SI,
SIR y SIS) usan los estados Susceptible, Infectado y Recuperado. Los nombres
suelen hacer referencia al flujo que se sigue para pasar entre los estados. AsÃ­,
por ejemplo un modelo SI pasa de susceptible a infectado, uno SIR de susceptible a infectado y recuperado y SIS alterna entre susceptible e infectado.
En estos modelos se hacen dos suposiciones:
1. La poblaciÃ³n se mezcla de manera homogÃ©nea, es decir, todos los individuos tienen la misma probabilidad de contraer la enfermedad.
2. El total de la poblaciÃ³n es constante y lo denotaremos por N.
En este capÃ­tulo estudiaremos los principales modelos epidemiolÃ³gicos continuos anÃ¡logos a los estudiados en el capÃ­tulo anterior.

39

40

modelos continuos en epidemiologÃ­a

4.2

modelo si continuo

Expresando Î± como una tasa podemos obtener las ecuaciones diferenciales
anÃ¡logas de la siguiente manera. Considerando
S n +1 âˆ’ S n
â‰ˆ S 0 ( t ),
âˆ†t
El anÃ¡logo continuo al sistema (7) viene dado por:
S0 (t) = âˆ’

Î±
SI
N

Î±
I (t) = SI
N
0

(20)

con condiciones iniciales S(0) + I (0) = N.
De (20) se puede ver que I 0 > 0 y S0 < 0, luego ambas funciones son estrictamente monÃ³tonas, al igual que el modelo discreto.
Calculamos los puntos de equilibrio de manera anÃ¡loga al caso discreto, es
decir, suponemos que las funciones son constantes y, resolviendo el sistema
de ecuaciones, podemos comprobar que las soluciones convergen a (Sâˆ— , I âˆ— ) =
(0, N ) y, por tanto, tienen el mismo comportamiento que en el caso discreto.
Sustituyendo en el modelo S = N âˆ’ I obtenemos la ecuaciÃ³n diferencial logÃ­stica continua

I0 =

Î±
N ( N âˆ’ I ).
I

Esta ecuaciÃ³n diferencial se puede resolver por separaciÃ³n de variables como
sigue:

4.2 modelo si continuo

Figura 11: GrÃ¡fica del modelo SI continuo, en una poblaciÃ³n total de 100 individuos,
con valores iniciales S(0) = 99, I (0) = 1, Î± = 0,1, T0 = 0, T = 100.

Î±
I = I(N âˆ’ I) â‡”
N
0

â‡”
â‡”
â‡”
â‡”

dI
Î±
=
dt
I(N âˆ’ I)
N

Z 
1
1
Î±
1
+
dI = t + c
N
I
Nâˆ’I
N
1
I
Î±
log
= t+c
N
Nâˆ’I
N
I
= AeÎ±t
Nâˆ’I
I = AeÎ±t ( N âˆ’ I )

Z

Z

(21)

â‡” I (1 + AeÎ±t ) = AeÎ±t N
â‡” I (t) =

AeÎ±t N
1 + AeÎ±t

Usando el valor inicial I (0) = I0 tenemos:

I0 = I (0) =

AN
â‡” (1 + A) I0 = AN
1+A
â‡” A( N âˆ’ I0 ) = I0
I0
â‡”A=
N âˆ’ I0

(22)

41

42

modelos continuos en epidemiologÃ­a

luego la soluciÃ³n general es:

I (t) =

I0 eÎ±t N
I0 N
=
.
Î±t
( N âˆ’ I0 ) + I0 e
( N âˆ’ I0 )eâˆ’Î±t + I0

Es claro que I tiende monÃ³tonamente a N, luego tiene el mismo comportamiento que el modelo discreto.
En (11) tenemos la representaciÃ³n grÃ¡fica del comportamiento del modelo SI
continuo. Podemos comprobar que su comportamiento es anÃ¡logo al modelo
discreto. TambiÃ©n es claro que se cumple que I es siempre creciente y tiende
a N, mientras S es decreciente y tiende a 0.

4.3

modelo sis continuo

El modelo continuo correspondiente al modelo SIS se comporta de la misma
forma que el modelo discreto, y viene expresado por:
Î±
S0 (t) = âˆ’ SI + Î³I

N
Î±
0
Sâˆ’Î³
I (t) = I
N

(23)

donde S(0) + I (0) = N.
Si RSIS â‰¤ 1 entonces no ocurre una epidemia, y si RSIS > 1 entonces hay
una epidemia.
En (12) comprobamos al igual que hicimos antes que su comportamiento es
anÃ¡logo al modelo discreto. TambiÃ©n se observa que al igual que en el modelo
SI el nÃºmero de individuos susceptibles es decreciente y tendiente a 0 y el de
infectados creciente y tiende a N, pero esto no siempre es asÃ­ y se debe a los
parÃ¡metros usados.
Por ejemplo, en (13) vemos como variando solamente Î³ el modelo se comporta de forma muy diferente, pues los susceptibles e infectados parecen
estabilizarse en torno a la mitad de la poblaciÃ³n.

4.3 modelo sis continuo

Figura 12: GrÃ¡fica del modelo SIS continuo, en una poblaciÃ³n total de 100 individuos,
con valores iniciales S(0) = 95, I (0) = 5, Î± = 0,1, Î³ = 0,01, T0 = 0, T =
150.

Figura 13: GrÃ¡fica del modelo SIS continuo, en una poblaciÃ³n total de 100 individuos,
con valores iniciales S(0) = 95, I (0) = 5, Î± = 0,1, Î³ = 0,05, T0 = 0, T =
150.

43

44

modelos continuos en epidemiologÃ­a

Figura 14: GrÃ¡fica del modelo SIS continuo, en una poblaciÃ³n total de 100 individuos,
con valores iniciales S(0) = 95, I (0) = 5, Î± = 0,1, Î³ = 0,2, T0 = 0, T = 150.

Por otro lado, si Î³ > Î± entonces tenemos que no se produce una epidemia,
pues los infectados tienden a 0 y los susceptibles a N, como puede verse en
(14).

4.4

modelo sir continuo

El modelo continuo correspondiente al modelo SIR se comporta de la misma
forma que el modelo discreto, y viene expresado por:
Î±
S0 (t) = âˆ’ SI

N
Î±
0
I (t) = I
Sâˆ’Î³
N
R0 (t) =Î³I

(24)

donde S(0) + I (0) + R(0) = N. El nÃºmero bÃ¡sico reproductivo en este caso
se define como
S (0) Î±
RSIR =
,
NÎ³
y si como hemos visto RSIR â‰¤ 1 se dice que no hay epidemia, pero en cambio,
si es mayor, se dice que sÃ­ la hay.

4.5 modelo kermack-mckendrick

Figura 15: GrÃ¡fica del modelo SIR continuo, en una poblaciÃ³n total de 100 individuos, con valores iniciales S(0) = 99, I (0) = 1, Î± = 0,1, Î³ = 0,01, T0 =
0, T = 300.

En (15) observamos el comportamiento del modelo SIR representado. Al igual
que en su anÃ¡logo discreto, el nÃºmero de individuos susceptibles siempre
decreciente y el de recuperados siempre creciente.

4.5

modelo kermack-mckendrick

La informaciÃ³n para el desarrollo de esta secciÃ³n se ha obtenido principalmente de [3].
El modelo de Kermack-McKendrick es un modelo sencillo basado en suposiciones simples en el flujo de la poblaciÃ³n de unos grupos a otros segÃºn su
estado respecto a la enfermedad. Estos grupos son susceptibles, infectados y
recuperados, inmunizados o fallecidos.
Este modelo es, por tanto, una modificaciÃ³n del modelo SIR ya estudiado. La
diferencia con el modelo SIR ya estudiado es que en este modelo se supone
que un individuo infectado hace contacto suficiente para contagiar la enfermedad con Î±N individuos por unidad de tiempo, mientras en el modelo SIR
se supone que Î± es el nÃºmero medio de individuos con los que un infectado

45

46

modelos continuos en epidemiologÃ­a

Figura 16: Esquema del modelo de Kermack-McKendrick y modelo SIR

tiene suficiente contacto para contagiarlo en una unidad de tiempo. Por tanto,
en este apartado y para hacer notar esta diferencia usaremos Î±Ì„ en lugar de Î±.
El modelo se describe como:
S0 = âˆ’Î±Ì„SI

I 0 = Î±Ì„SI âˆ’ Î³I

(25)

R0 = Î³I

Las suposiciones en las que se basa el modelo descrito son:
Un individuo hace contacto suficiente para contagiar la enfermedad con
Î±Ì„N individuos por unidad de tiempo, sienod N el total de la poblaciÃ³n.
Los infectados pasan a recuperados, inmunizados o fallecidos con la
tasa Î³I por unidad de tiempo.
La poblaciÃ³n total es constante, no hay incorporaciones ni salidas.
No se consideran fallecimientos como grupo aparte, asÃ­ la poblaciÃ³n es
constante.
De acuerdo con la primera suposiciÃ³n, dado que la probabilidad de que aleaS
toriamente el contacto de un infectado sea con un individuo susceptible es N
,
Î±NS
el nÃºmero de nuevos infectados por unidad de tiempo por infectado es N ,
dando lugar a una tasa de nuevos infectados de Î±Ì„NSI
= Î±Ì„SI. Notemos que
N
ambas aproximaciones dan lugar a la misma tasa de nuevos infectados.
Observemos tambiÃ©n que, al igual que en el modelo SIR, se cumple N =
S + I + R.
Para la tercera suposiciÃ³n consideramos el grupo de individuos que fueron
infectados en un mismo momento, y sea u(s) el conjunto de estos que aÃºn
son infecciosos s unidades de tiempo despuÃ©s de haber sido infectados. Si

4.5 modelo kermack-mckendrick

una porciÃ³n Î³ de estos deja de pertenecer a la clase de individuos infectados
por unidad de tiempo, entonces

u0 = âˆ’Î³u,
y la soluciÃ³n de esta ecuaciÃ³n diferencial es

u(s) = u(0)eâˆ’Î³s .
Por tanto, la fracciÃ³n de infectados que siguen estando en la clase infectados
s unidades de tiempo despuÃ©s de haberse convertido en infectados es eâˆ’Î³s ,
luego la duraciÃ³n del perÃ­odo infeccioso se distribuye segÃºn una exponencial,
con significado
Z
âˆ

0

eâˆ’Î³s ds = 1/Î³,

y esto es lo que la segunda suposiciÃ³n realmente significa. Si en lugar de
suponer esto, suponemos que la fracciÃ³n de infectados que permanecen infectados en un tiempo Ï„ despuÃ©s de haberse infectado es P(Ï„ ), la segunda
ecuaciÃ³n de (25) se reemplaza por:

I (t) = I0 (t) +

Z âˆ
0

Î±Ì„S(t âˆ’ Ï„ ) I (t âˆ’ Ï„ ) P(Ï„ )dÏ„,

donde I0 (t) hace referencia a los miembros de la poblaciÃ³n que eran infectados en el instante inicial y siguen siendo infecciosos en el momento t.
Las suposiciones de que la tasa de contactos es proporcional al tamaÃ±o de
la poblaciÃ³n N con una constante de proporcionalidad constante Î±Ì„ y de una
distribuciÃ³n exponencial de tasa de recuperaciÃ³n son demasiado simples para
ser realistas. Existen otros modelos mÃ¡s generales que se pueden analizar,
pero finalmente muchos modelos mÃ¡s realistas muestran comportamientos
similares a estos modelos mÃ¡s simples.
En nuestro modelo (25), R se determina una vez que se conocen S e I, pero podemos eliminar la tercera ecuaciÃ³n del modelo, dejando este formado
solamente por dos ecuaciones:

47

48

modelos continuos en epidemiologÃ­a

S0 = âˆ’Î±Ì„SI,

I 0 = (Î±Ì„S âˆ’ Î³) I,

(26)

junto con las condiciones iniciales:
S ( 0 ) = S0 ,

I (0) = I0 ,

S0 + I0 = N.

El modelo solo tiene sentido si S(t) e I (t) se mantienen no negativos, luego
si alguno de los dos llega a 0, consideramos que el estudio ha terminado.
Lema 5. Dado el modelo (26), se tiene que S0 < 0 para todo t, y ademÃ¡s I 0 > 0 si, y
solo si, S > Î³Î±Ì„ .
Es decir, I aumenta mientras se cumpla que S > Î³Î±Ì„ , pero como S decrece para
todo t, finalmente se tiene que S < Î³Î±Ì„ , y por tanto I deja de aumentar.
Si S0 < Î³Î±Ì„ , entonces I decrece a 0 y no hay una epidemia, mientras que si
S0 > Î³Î±Ì„ , I comienza creciendo hasta el mÃ¡ximo obtenido cuando S = Î³Î±Ì„ y
luego decrece hasta 0, en cuyo caso hay una epidemia.
Definimos el nÃºmero bÃ¡sico reproductivo como:

RKMK =

Î±Ì„S0
.
Î³

De esta manera, si RKMK < 1 no hay una epidemia, mientras si RKMK > 1
hay una epidemia.

4.6

anÃ¡lisis de los parÃ¡metros de los modelos

4.6.1 IntroducciÃ³n
Estimar la tasa de transmisiÃ³n media es uno de los aspectos mÃ¡s cruciales en
epidemiologÃ­a. Esta tasa condiciona la fase de la epidemia e incluso si va a
extinguirse. Es combinaciÃ³n de tres factores:
1. Coeficiente de virulencia: Relacionado con el agente infeccioso.

4.6 anÃ¡lisis de los parÃ¡metros de los modelos

2. Coeficiente de susceptibilidad: Relacionado con el anfitriÃ³n.
3. NÃºmero de contactos por unidad de tiempo entre individuos.
Los dos primeros factores se tienen en cuenta a la vez en la probabilidad de
transmisiÃ³n.
Todos los factores pueden cambiar con el tiempo. El primero, debido a mutaciones del virus y los dos Ãºltimos por medidas de contenciÃ³n. Por tanto,
observar el decrecimiento de la transmisiÃ³n media en una enfermedad es
una buena forma de comprobar la efectividad de las medidas de contenciÃ³n.
En el artÃ­culo [5] se presenta un modelo SI modificado con el objetivo de
compararlo con los datos obtenidos en la pandemia de la COVID-19 en China
hasta el momento, y asÃ­ tratar de predecir su comportamiento en el futuro.
El modelo SI continuo considerado es el siguiente:
S0 (t) = âˆ’ Ï„ (t)S(t) I (t)

I 0 (t) =Ï„ (t)S(t) I (t) âˆ’ vI (t)

(27)

donde S(t) es el nÃºmero de individuos susceptibles , I (t) el nÃºmero de individuos infectados en el tiempo t y Ï„ (t) la tasa de transmisiÃ³n, que combina el
nÃºmero de contactos por unidad de tiempo y la probabilidad de transmisiÃ³n.
Observemos que Ï„ (t) se considera variable respecto al tiempo, al contrario
que en el caso SI clÃ¡sico estudiado antes. AdemÃ¡s, notemos que v es una
constante, donde 1/v es la duraciÃ³n media del perÃ­odo de infecciÃ³n, y vI (t)
el flujo de individuos recuperados o fallecidos.
Se consideran las condiciones iniciales

S(t0 ) = S0 > 0, I (t0 ) = I0 > 0.
Ahora, consideramos que al final del perÃ­odo infeccioso nos han informado
de una fracciÃ³n del total de casos, en este caso la fracciÃ³n la denotamos por
f âˆˆ (0, 1]. Sea CR (t) el nÃºmero total acumulado de casos reportados. Entonces:

49

50

modelos continuos en epidemiologÃ­a

CR (t) = CR0 + v f C I (t), âˆ€t â‰¥ t0

(28)

donde CR0 representa el nÃºmero de casos reportados al inicio del estudio y

C I (t) =

Z t
t0

I (w)dw

siendo C I el nÃºmero total de infectados acumulado.
Asumimos conocidos S0 > 0, 1/v > 0, f âˆˆ (0, 1]. Por tanto, queremos averiguar el nÃºmero inicial de infectados I0 y la tasa de transmisiÃ³n Ï„ (t).
4.6.2 AproximaciÃ³n de I0 y Ï„ (t0 )
Siguiendo [5], procedemos a intentar aproximar I0 y Ï„ (t0 ):
Al comienzo de la pandemia podemos suponer que S(t) y Ï„ (t) son constantes
e iguales a S0 y Ï„0 = Ï„ (t0 ), respectivamente. Sustituyendo estos valores en la
ecuaciÃ³n (27) obtenemos:

I 0 (t) = (Ï„0 S0 âˆ’ v) I (t).
Resolviendo la ecuaciÃ³n diferencial llegamos a:

I (t) = I0 exp ((Ï„0 S0 âˆ’ v)(t âˆ’ t0 )).
Sustituyendo en (28):

CR (t) = CR0 + v f I0

e(Ï„0 S0 âˆ’v)(tâˆ’t0 ) âˆ’ 1
.
Ï„0 S0 âˆ’ v

De este modo, hemos obtenido un primer modelo para los casos acumulados
al principio de la pandemia.
Reescribimos la ecuaciÃ³n anterior como:

4.6 anÃ¡lisis de los parÃ¡metros de los modelos

CR ( t ) = Ï‡ 1 eÏ‡2 t âˆ’ Ï‡ 3 .

(29)

Estimamos Ï‡3 usando los datos de la epidemia obtenidos, y el mejor ajuste
para los datos se obtiene con Ï‡3 = 0.
Ahora, usando (28) y (29) tenemos:

I0 =

Ï‡ 1 Ï‡ 2 eÏ‡2 t0
vf

(30)

Y, como sabemos que Ï‡2 = Ï„0 S0 âˆ’ v, entonces
Ï„0 =

Ï‡2 + v
.
S0

(31)

Si suponemos Ï„ (t) = Ï„0 constante, tenemos que el modelo queda:
S0 (t) = âˆ’Ï„0 S(t) I (t)

I 0 (t) = Ï„0 S(t) I (t) âˆ’ vI (t)

(32)

Usando la ecuaciÃ³n de S(t) y resolviÃ©ndola obtenemos:

S(t) = S0 exp âˆ’Ï„0

Z t
t0


I (w)dw

= S0 exp (âˆ’Ï„0 C I (t))

Ahora, sustituyendo esta expresiÃ³n en la ecuaciÃ³n de I (t) del modelo y usando C 0I (t) = I (t):
I 0 (t) = S0 exp (âˆ’Ï„0 C I (t))Ï„0 C 0I (t) âˆ’ vI (t)
Finalmente, integrando entre t0 y t tenemos que:
I (t) = C 0I (t) = I0 + S0 (1 âˆ’ exp (âˆ’Ï„0 C I (t))) âˆ’ vC I (t).

51

52

modelos continuos en epidemiologÃ­a

Observamos entonces que el nÃºmero total acumulado de infectados es monÃ³tono creciente, ya que I (t) > 0 siempre por positividad de las soluciones
y C 0I (t) = I (t) > 0. Cabe destacar que esto no implica que el nÃºmero de
infectados sea monÃ³tono creciente.
Teorema 2. Sea t > t0 fijo. El nÃºmero de infectados acumulados es estrictamente
creciente respecto a las siguiente cantidades:
I0 > 0: NÃºmero inicial de infectados
S0 > 0: NÃºmero inicial de individuos susceptibles.
Ï„ > 0: Tasa de transmisiÃ³n
1/v: Tiempo medio de la infecciÃ³n.
4.6.3 FÃ³rmula teÃ³rica para Ï„ (t)
Usando la ecuaciÃ³n del modelo inicial (27) obtenemos:

S(t) = S0 exp âˆ’

Z t
t0


Ï„ (w) I (w)dw

Ahora, sustituyendo en la ecuaciÃ³n (27):


0

I (t) = S0 exp âˆ’

Z t
t0


Ï„ (w) I (w)dw Ï„ (t) I (t) âˆ’ vI (t)

Integramos en ambos lados entre t0 y t, luego:
C 0I (t)





= I0 + S0 1 âˆ’ exp âˆ’

Z t
t0


Ï„ (w) I (w)dw

âˆ’ vC I (t)

Equivalentemente, por (28):

CR0 (t)



= vf


I0 + S0



1
1 âˆ’ exp âˆ’
vf

Z t
t0

Ï„ (w)CR0 (w)dw



+ vCR0 âˆ’ vCR (t)

AsÃ­, obtenemos el Teorema 3.1 de [5], que nos da la relaciÃ³n directa buscada.

5
D E S A R R O L L O D E L S O F T WA R E : A N Ã L I S I S Y D I S E Ã‘ O

5.1

objetivos y anÃ¡lisis de requisitos

Los objetivos que se persiguen al realizar este proyecto son realizar un estudio de distintos modelos de epidemiologÃ­a. Se pretende comprender cÃ³mo
afectan sus parÃ¡metros y condiciones iniciales a la evoluciÃ³n en el tiempo de
estos modelos desde un punto de vista tanto teÃ³rico como prÃ¡ctico, apoyÃ¡ndonos en distintas grÃ¡ficas interactivas para ilustrar dichos comportamientos.
Asimismo, se va a analizar la bondad de ajustes de parÃ¡metros de algunos
de los modelos presentados aplicados a datos reales comprobando cuÃ¡les
proporcionan mejores resultados en cada caso. Con el fin de satisfacer todos
estos objetivos, se ha extraÃ­do la siguiente lista de requisitos:
Requisitos funcionales
â€¢ RF1: Se debe poder modificar los parÃ¡metros de las grÃ¡ficas de los
distintos modelos.
â€¢ RF2: El usuario debe poder elegir con quÃ© modelo quiere trabajar.
â€¢ RF3: El sistema debe permitir descargar las imÃ¡genes de las grÃ¡ficas obtenidas.
â€¢ RF4: El sistema debe poder cargar y leer ficheros de datos.
â€¢ RF5: Se debe visualizar el ajuste obtenido mediante grÃ¡ficas.
â€¢ RF6: Para cada ajuste realizado se obtendrÃ¡ los valores estimados
de los parÃ¡metros y los errores.
â€¢ RF7: El sistema debe ser capaz de seleccionar quÃ© modelo se ajusta
mejor a los datos.
Requisitos no funcionales

53

54

desarrollo del software: anÃ¡lisis y diseÃ±o

Figura 17: Modelo en espiral.

Determinar objetivos

AnÃ¡lisis del riesgo

PlanificaciÃ³n

Desarrollar y probar

â€¢ RNF1: No se podrÃ¡n ajustar datos de mÃ¡s de un fichero a la vez.
â€¢ RNF2: Las grÃ¡ficas deben actualizarse en tiempo real.
â€¢ RNF3: Se mostrarÃ¡ informaciÃ³n de ayuda, en caso de ser necesaria.
â€¢ RNF4: Se debe poder usar desde el navegador.
Requisitos de informaciÃ³n
â€¢ RI1: Los ficheros de datos con los que se va a trabajar deben ser
formato csv con una estructura especÃ­fica, dependiente de cada
modelo.

5.2

desarrollo del proyecto

Actualmente hay diversas metodologÃ­as de desarrollo del software. Cada uno
de estos modelos consta de una serie de etapas en las que se ha dividido el
desarrollo. Para este proyecto, se ha optado por el modelo en espiral. En
este modelo el software se desarrolla de forma incremental, es decir, se van
aÃ±adiendo funcionalidades y mejoras al software segÃºn se van evaluando las
que ya tiene. Cada bucle o iteraciÃ³n representa un conjunto de actividades.
Estas actividades no estÃ¡n fijadas a ninguna prioridad, sino que las siguientes
se eligen en funciÃ³n del anÃ¡lisis de riesgo, comenzando por el bucle interior,
como se describe en la figura (17).
Se ha elegido este mÃ©todo de desarrollo ya que se consigue un desarrollo muy
estable, pues toda funcionalidad aÃ±adida al software es probada y evaluada.

5.3 gestiÃ³n de recursos

De esta forma, aunque el proyecto no estÃ© completo, siempre se tiene una
parte funcional, y se va incrementando de forma que siempre disponemos de
un producto mÃ­nimamente viable.

5.3

gestiÃ³n de recursos

Los proyectos que se pueden realizar dependen en gran medida de los recursos que se pueden destinar a ellos. Se requieren unos elementos mÃ­nimos que
son indispensables para poder llevarlo a cabo. Por ello, es muy importante
contar con los recursos necesarios y gestionarlos de manera adecuada.

5.3.1

Recursos humanos

El proyecto consta de un equipo de 3 personas para llevarlo a cabo:
Ana BuendÃ­a Ruiz-Azuaga, se encarga de:
â€¢ PlanificaciÃ³n y anÃ¡lisis del proyecto.
â€¢ BÃºsqueda de bibliografÃ­a.
â€¢ DiseÃ±o e implementaciÃ³n del proyecto.
â€¢ Pruebas para el correcto funcionamiento del proyecto.
â€¢ RedacciÃ³n de la documentaciÃ³n del proyecto.
Tutores: Manuel Pegalajar CuÃ©llar y Teresa E. PÃ©rez, encargados de:
â€¢ Idea original del proyecto.
â€¢ Proporcionar bibliografÃ­a.
â€¢ Guiar para la redacciÃ³n de la memoria y documentaciÃ³n.
â€¢ Supervisar el desarrollo del proyecto.

5.3.2

Recursos hardware

Todo el proyecto se va a desarrollar en un ordenador portÃ¡til con todo el
software y dependencias necesarias. Las especificaciones del portÃ¡til son:
Modelo: Acer Aspire E-5 574G.
CPU: Intel Core i5-6200U.
RAM 8GB RAM DDR3.
Disco duro: 1TB.

55

56

desarrollo del software: anÃ¡lisis y diseÃ±o

Precio: 600â‚¬.
5.3.3 Recursos software
El proyecto se ha llevado a cabo usando como sistema operativo Ubuntu 20.04
LTS, y se ha usado como lenguaje principal Python.
El software necesario para el proyecto es el siguiente:
Flask. Flask es un microframework web en python. Proporciona funcionalidad bÃ¡sica para, de forma sencilla, crear una aplicaciÃ³n web. Una
posible alternativa habrÃ­a sido Django, pero finalmente se ha optado por
Flask debido a su simplicidad, legibilidad y que en este proyecto no se
requieren muchas de las funcionalidades que Django ofrece integradas.
Dash. Dash es un framework opensource basado en plotly.js y react.js
que permite crear fÃ¡cilmente aplicaciones basadas en datos. En este proyecto se ha usado principalmente por su capacidad de crear grÃ¡ficas
interactivas en tiempo real.
VSCode. Se ha usado VSCode como editor de texto, ya que proporciona una gran cantidad de plugins para cualquier lenguaje, asÃ­ como
integraciÃ³n con git.
Draw.io. Para la realizaciÃ³n de diagramas de distintas clases, se ha usado el software de dibujo gratuito Draw.io.
Docker. Con el fin de simplificar el lanzamiento y ejecuciÃ³n de la aplicaciÃ³n web desarrollada se ha usado docker para virtualizar el entorno
y evitar la necesidad de instalar en cualquier mÃ¡quina el software necesario para ejecutarla.
Git. Se ha empleado Git como controlador de versiones, integrado con
Github.
Texmaker. Para redactar la memoria, se ha usado el editor de LaTeX
Texmaker.
Todo el software utilizado ha sido gratuito, por lo que no ha tenido coste
alguno.

5.4 planificaciÃ³n temporal

5.3.4

EstimaciÃ³n del coste

A partir de los recursos previamente listados, se va a realizar una aproximaciÃ³n del coste de la consecuciÃ³n del proyecto, considerando que la duraciÃ³n
del mismo es de 9 meses.
Para los recursos humanos, dado que se considera que la alumna ha trabajado aproximadamente 450 horas de acuerdo a los crÃ©ditos correspondientes
asignados al TFG, y el gasto aproximado es 15â‚¬/h en calidad de alumna de
prÃ¡cticas, se tiene que el coste es de 6.750,00â‚¬.
A los tutores, dada su formaciÃ³n profesional se les supone un coste estimado
de 50â‚¬/h, y aproximando que se dedican 3 horas semanales para la tutorizaciÃ³n del proyecto, se tiene que el coste total tras los 9 meses es de 5.400,00â‚¬
por tutor.
Dado que el portÃ¡til empleado tiene una vida Ãºtil estimada de 5 aÃ±os, le
corresponde un coste de 120,00â‚¬ durante la realizaciÃ³n del proyecto.
Finalmente, dado que todo el software empleado es gratuito, el coste aproximado del proyecto aparece desglosado en la tabla (1).

5.4

planificaciÃ³n temporal

Para la realizaciÃ³n del proyecto se han distinguido distintas etapas, y en cada
una de ellas se ha implementado y trabajado sobre una funcionalidad concreta, de acuerdo al modelo en espiral. Las distintas partes del proyecto han
sido:
T1. Estudio de bibliografÃ­a y estado actual de la epidemiologÃ­a. Se han
consultado diversos libros, artÃ­culos y pÃ¡ginas de interÃ©s con el fin de
comprender mejor y obtener los recursos necesarios para la realizaciÃ³n
del proyecto. AdemÃ¡s, se ha realizado una selecciÃ³n de los modelos a
estudiar y tratar durante el desarrollo del mismo.
T2. EspecificaciÃ³n de requisitos. En base a la informaciÃ³n obtenida del
proyecto, en esta etapa se han especificado los requisitos que el software
debe cumplir.

57

58

desarrollo del software: anÃ¡lisis y diseÃ±o

Cuadro 1: Desglose de presupuesto del proyecto.

Recursos humanos

Coste (â‚¬)

Alumna
Tutor 1
Tutor 2
Suma
Recursos hardware

6.750,00
5.400,00
5.400,00
17.550,00
Coste (â‚¬)

Ordenador portÃ¡til
Suma
Recursos software
Flask
Dash
VSCode
TexMaker
Suma

120,00
120,00
Coste (â‚¬)
0,00
0,00
0,00
0,00
0,00

Suma total

17.670,00

Gastos indirectos (18 %)

3.180,60

Total

20.850,60

IVA (21 %)

4.378,63

Coste final

25.229,23

T3. DiseÃ±o del sistema. A partir de los requisitos especificados, se ha
diseÃ±ado la arquitectura del sistema y cÃ³mo serÃ¡ la interfaz con la que
van a interactuar los usuarios.
T4. Marco teÃ³rico. Se han indicado conceptos y modelos, asÃ­ como estudiado las caracterÃ­sticas de estos con el fin de desarrollar la teorÃ­a
necesaria para trabajar con modelos epidemiolÃ³gicos. Asimismo, se ha
indicado el contexto en el que la epidemiologÃ­a es de gran utilidad.
T5. ImplementaciÃ³n de los modelos discretos. Se ha realizado la implementaciÃ³n de los modelos discretos SI, SIR y SIS, incluyendo grÃ¡ficas
interactivas de los mismos.
T6. ImplementaciÃ³n de los modelos continuos. Se ha realizado la implementaciÃ³n de los modelos continuos SI, SIR y SIS, incluyendo grÃ¡ficas interactivas de los mismos, al igual que informaciÃ³n teÃ³rica.

5.5 diagrama conceptual

T7. Ajuste de datos a diversos modelos. Se ha implementado una funcionalidad para realizar un ajuste de parÃ¡metros de acuerdo a un modelo a elegir, o el sistema puede determinar cuÃ¡l es el modelo que minimiza el error para unos datos dados.
T8. DocumentaciÃ³n del proyecto. Se ha llevado a cabo la documentaciÃ³n del proyecto durante todo su desarrollo.
Con el fin de ayudar a hacer mÃ¡s fÃ¡cil la comprensiÃ³n de cÃ³mo se ha distribuido el tiempo del proyecto, se ha realizado el diagrama (18) en el que
se puede ver cuÃ¡nto tiempo se ha dedicado a cada etapa del desarrollo del
proyecto durante los 10 meses de duraciÃ³n del mismo.

Figura 18: PlanificaciÃ³n temporal de las etapas del proyecto.

5.5

diagrama conceptual

Para el modelado conceptual de la aplicaciÃ³n web, se ha optado por utilizar OOWS (Object-Oriented approach for Web Solutions modelling), que usa
modelado de objetos UML y modelos de navegaciÃ³n y presentaciÃ³n usando UML. AsÃ­, se expresan las caracterÃ­sticas navegacionales de la aplicaciÃ³n
web a la vez que se integra con las restantes vistas del esquema conceptual
mediante una notaciÃ³n UML adaptada.

59

60

desarrollo del software: anÃ¡lisis y diseÃ±o

En (19), se muestra el diagrama conceptual, construido mediante una estrategia top-down:

Figura 19: Modelo conceptual de la aplicaciÃ³n web.

En (20) se muestra el detalle del contexto de Home, en (21) se ve el detalle de Modelos Interactivos, asÃ­ como en (22) el de Ayuda y en (23) el de
Ajuste de datos.

Figura 20: Modelo conceptual del contexto de Inicio.

5.6 casos de uso

Figura 21: Modelo conceptual del contexto de Modelos Interactivos.

Figura 22: Modelo conceptual del contexto de Ayuda.

5.6

casos de uso

A partir de los requisitos listados anteriormente, se obtienen los siguientes
casos de uso:

61

62

desarrollo del software: anÃ¡lisis y diseÃ±o

Figura 23: Modelo conceptual del contexto de Ajuste de Datos.

CU-1: Modificar parÃ¡metro de un modelo.
CU-2: Preprocesar entrada.
CU-3: Subir fichero de datos.
CU-4: Leer fichero de datos.
CU-5: Actualizar grÃ¡fica.
CU-6: Seleccionar modelo de ajuste.
CU-7: Realizar ajuste de datos.
CU-8: Descargar grÃ¡fica.
5.6.1 Actores del sistema

Actor
DescripciÃ³n
CaracterÃ­sticas
Relaciones
Referencias
Autor

Usuario
A-1
Representa el usuario estÃ¡ndar que va a usar la pÃ¡gina web.
InteractÃºa con la aplicaciÃ³n web de forma directa.
Interviene en los casos de uso CU-1, CU-3 y CU-6.
Ana Fecha 25/04/22 VersiÃ³n
1.0

5.6 casos de uso

5.6.2

Diagrama de casos de uso

Se incluye tambiÃ©n el diagrama de los casos de uso, con el fin de ilustrar todos
los posibles casos de uso, asÃ­ como sus relaciones entre ellos. El diagrama
resultante puede verse en (24).
Figura 24: Diagrama de casos de uso

63

64

desarrollo del software: anÃ¡lisis y diseÃ±o

5.6.3 Plantillas de casos de uso
Caso de uso
Actores
Tipo
Referencias
PrecondiciÃ³n
PostcondiciÃ³n
Autor

Modificar parÃ¡metro de un modelo
CU-1
Usuario
Esencial
RF1
CU-2, CU-5
Se debe estar trabajando con un modelo.
Se debe preprocesar la entrada.
Ana
Fecha 25/04/22
VersiÃ³n
1.0

PropÃ³sito
Modificar uno de los parÃ¡metros disponibles del modelo para ver cÃ³mo
afecta al comportamiento del mismo.
Resumen
Se modifica uno de los parÃ¡metros posibles del modelo, modificando asÃ­
su comportamiento y visualizando la nueva grÃ¡fica resultante.
Curso normal
El usuario modifica un
parÃ¡metro
2.
3.

1.

2a.
3a.

Incluir CU-2
Incluir CU-5

Cursos alternos
El formato no es correcto, se asigna un valor por defecto
Incluir CU-5

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Vital
Finalizado

Urgencia
Estabilidad
-

Alto
Alta
Alta

5.6 casos de uso

Caso de uso
Actores
Tipo
Referencias
PrecondiciÃ³n
PostcondiciÃ³n
Autor

Preprocesar entrada

CU-2

(Sistema)
Esencial
RF-1
CU-1
Se debe haber modificado un parÃ¡metro del modelo.
Se debe actualizar la grÃ¡fica.
Ana
Fecha 25/04/22
VersiÃ³n
1.0

PropÃ³sito
Asegurar el correcto formato y validez del valor introducido.
Resumen
Se comprueba la validez y formato del valor introducido para asegurar el
correcto funcionamiento del modelo.
Curso normal
1.
Se comprueba el tipo de valor
(float o entero).
2.
Se comprueba el rango de
validez de los valors de cada
parÃ¡metro.
3. Se comprueba que la poblaciÃ³n
sea constante.

1a
2b.

Cursos alternos
Si el valor no es de un tipo vÃ¡lido se sustituye por 0.
Si el valor no estÃ¡ en el rango se sustituye por 0.

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Vital
Finalizado

Urgencia
Estabilidad
-

Alto
Alta
Alta

65

66

desarrollo del software: anÃ¡lisis y diseÃ±o

Caso de uso
Actores
Tipo
Referencias
PrecondiciÃ³n
PostcondiciÃ³n
Autor

Subir fichero de datos

RF4

Ana

CU-3

Usuario
Esencial
CU-4, CU-5, CU-6, CU-7
Fecha 25/04/22
VersiÃ³n

1.0

PropÃ³sito
El usuario debe poder subir un fichero de datos para trabajar sobre Ã©l.
Resumen
El usuario sube un fichero de datos.
Curso normal
El usuario selecciona un fichero
de datos.
2.
El sistema sube el fichero de
datos seleccionado.

1.

2a.

Cursos alternos
El fichero no tiene formato correcto, por lo que no se deja
seleccionarlo.

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Vital
Finalizado

Urgencia
Estabilidad
-

Alto
Alta
Alta

5.6 casos de uso

Caso de uso
Actores
Tipo
Referencias
PrecondiciÃ³n
PostcondiciÃ³n
Autor

Leer fichero de datos

CU-4

(Sistema)
Esencial
RF4
CU-3, CU-7
Se debe haber subido el fichero a leer.
Se debe actualizar la grÃ¡fica.
Ana
Fecha 25/04/22
VersiÃ³n

1.0

PropÃ³sito
Leer el fichero para poder trabajar con los datos que contiene.
Resumen
Se lee el fichero de datos cargando estos en memoria.
Curso normal
1.
2.

2a.

Se abre el fichero
Se lee el fichero

Cursos alternos
Si el formato del fichero no es el esperado, se muestra un error.

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Vital
Finalizado

Urgencia
Estabilidad
-

Alto
Alta
Alta

67

68

desarrollo del software: anÃ¡lisis y diseÃ±o

Caso de uso
Actores
Tipo
Referencias
PrecondiciÃ³n
PostcondiciÃ³n
Autor

Actualizar grÃ¡ficas

CU-5

(Sistema)
Esencial
RF1, RF2, RF5
CU-1, CU-6
Se ha modificado un parÃ¡metro o ajuste seleccionado.
La grÃ¡fica se ha actualizado.
Ana
Fecha 25/04/22
VersiÃ³n
1.0

PropÃ³sito
Actualizar la grÃ¡fica para tener la visualizaciÃ³n de los datos de acuerdo a
las opciones indicadas.
Resumen
Actualizar la grÃ¡fica cuando el usuario realiza una modificaciÃ³n de
parÃ¡metros o del modelo con el que realizar el ajuste.
Curso normal
1.
Incluir CU-4
2.
Representar los datos con el
nuevo parÃ¡metro.

2a.
3a.

Cursos alternos
Si se ha cambiado el modelo con el que realizar el ajuste, incluir
CU-7.
Representar los datos con el nuevo ajuste.

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Vital
Finalizado

Urgencia
Estabilidad
-

Medio
Alta
Alta

5.6 casos de uso

Caso de uso
Actores
Tipo
Referencias
PrecondiciÃ³n
PostcondiciÃ³n
Autor

Seleccionar modelo de ajuste
CU-6
Usuario
Esencial
RF2
CU-5, CU-7
Se debe tener leÃ­do un fichero de datos.
Se debe realizar el ajuste con el nuevo modelo elegido.
Ana
Fecha 25/04/22
VersiÃ³n
1.0

PropÃ³sito
Poder elegir el modelo con el que realizar el ajuste de los datos.
Resumen
Seleccionar el modelo a partir del cuÃ¡l se va a realizar el ajuste.

1.

Curso normal
El usuario selecciona un
modelo
2.
3.

Incluir CU-7
Incluir CU-5

Cursos alternos
-

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Alta
Finalizado

Urgencia
Estabilidad
-

Alto
Alta
Alta

69

70

desarrollo del software: anÃ¡lisis y diseÃ±o

Caso de uso
Actores
Tipo
Referencias
PrecondiciÃ³n
PostcondiciÃ³n
Autor

Realizar ajuste de datos

CU-7

(Sistema)
Esencial
RF6, RF7
CU-3, CU-4, CU-5, CU-6
Se debe haber leÃ­do un fichero y seleccionado un modelo.
Actualizar las grÃ¡ficas
Ana
Fecha 25/04/22
VersiÃ³n
1.0

PropÃ³sito
Obtener una estimaciÃ³n de los parÃ¡metros y los errores correspondientes
de acuerdo al modelo seleccionado.
Resumen
Se realiza el ajuste de un modelo elegido a los datos leÃ­dos.
Curso normal
Incluir CU-6

1.

2.
3.
4.

2a.
3a.
4a.

Estimar parÃ¡metros
Calcular errores
Incluir CU-5

Cursos alternos
Si se debe elegir el mejor modelo, se calculan los parÃ¡metros para
todos los modelos
Se calculan los errores para todos los modelos
Se elige el mejor modelo de acuerdo a un criterio sobre los errores

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Vital
Finalizado

Urgencia
Estabilidad
-

Alto
Alta
Alta

5.6 casos de uso

Caso de uso
Actores
Tipo
Referencias
PrecondiciÃ³n
PostcondiciÃ³n
Autor

Descargar grÃ¡fica

CU-8
Usuario
Secundario

RF3

Ana

Fecha

25/04/22

VersiÃ³n

1.0

PropÃ³sito
Descargar una grÃ¡fica generada por la aplicaciÃ³n web.
Resumen
Se descarga la imagen de una grÃ¡fica generada.
Curso normal
Pulsa en descargar imagen
2. Muestra el selector de archivos
Selecciona dÃ³nde guardar el
archivo
4. Se genera y descarga la imagen

1.
3.

3a.

Frecuencia
esperada
Importancia
Estado
Comentarios

Cursos alternos
El usuario cancela la descarga.
Otros datos
Baja
Rendimiento
Baja
Finalizado

Urgencia
Estabilidad
-

Alto
Baja
Alta

71

72

desarrollo del software: anÃ¡lisis y diseÃ±o

5.7

diagramas de actividad

Para facilitar la comprensiÃ³n del funcionamiento de las distintas funcionalidades del sistema, se han realizado diagramas de actividad de sus funcionalidades mÃ¡s importantes, siendo estas la posible modificaciÃ³n de los parÃ¡metros
de los modelos interactivos y el ajuste de datos subidos mediante un fichero
de datos.
El diagrama de actividad correspondiente a la modificaciÃ³n de parÃ¡metros
en los modelos se muestra en (25) y el del ajuste de parÃ¡metros se puede ver
en (26).
Figura 25: Diagrama de actividad de la modificaciÃ³n de parÃ¡metros en un modelo.

5.8 pruebas

Figura 26: Diagrama de actividad del ajuste de datos.

5.8

pruebas

A medida que se desarrollaba el proyecto, se han llevado a cabo diversas
pruebas de las distintas funcionalidades que se han desarrollado incremen-

73

74

desarrollo del software: anÃ¡lisis y diseÃ±o

talmente, con el fin de garantizar en todo momento que se disponÃ­a de un
producto mÃ­nimamente viable.
Se han llevado a cabo dos tipos de pruebas:
Pruebas unitarias: Tienen como objetivo asegurar el correcto funcionamiento de las funciones creadas de forma independiente de las demÃ¡s.
Pruebas de usuario: Tratan de simular la interacciÃ³n entre un usuario
y la interfaz del proyecto.
5.8.1 Pruebas unitarias
Preprocesamiento de valores de parÃ¡metros. Se ha probado a introducir diversos valores para los parÃ¡metros modificables en los modelos
interactivos, con el fin de asegurarnos de que se preprocesan adecuadamente. El comportamiento esperado es sustituir el valor introducido
por 0 en caso de que este sea un carÃ¡cter o un valor negativo.
Correcta generaciÃ³n de datos para diversos modelos. Se han representado grÃ¡ficamente los datos generados por las funciones de los modelos
y contrastando el comportamiento de los datos obtenidos con el descrito en la teorÃ­a, asegurando asÃ­ la correcta generaciÃ³n de los datos de
acuerdo a los diversos modelos.
Subida de ficheros. Se ha probado a subir ficheros con extensiones permitidas (csv y txt) y comprobado que se han copiado al directorio pertinente para disponer de los ficheros cuando se requiera, asÃ­ como a
subir ficheros con extensiones no permitidas, verificando que se muestra el error pertinente al no permitirse.
5.8.2 Pruebas de usuario
Prueba de poblaciÃ³n constante. Si el usuario introduce valores para las
condiciones iniciales (S0 , I0 y R0 si es pertinente) tal que su suma no sea
N se actualiza el valor de la poblaciÃ³n de forma que S0 + I0 + R0 = N.
Formato de los valores para parÃ¡metros. Si el usuario introduce un
valor de un parÃ¡metro con formato incorrecto se sustituye por 0.

5.9 diseÃ±o de la interfaz de usuario

Condiciones iniciales son nÃºmeros enteros. Si el usuario introduce un
valor no entero positivo se toma como valor real la parte entera del
valor introducido por el usuario.
Subida de fichero inexistente. Si se trata de subir un fichero al que
no se puede acceder o no selecciona ningÃºn fichero antes de pulsar en
subir fichero se muestra el error pertinente.
InteracciÃ³n con las grÃ¡ficas. Los usuarios pueden hacer zoom, desplazarse y obtener el valor numÃ©rico de las representaciones grÃ¡ficas en
cada momento en tiempo real, asÃ­ como descargar las grÃ¡ficas generadas.

5.9

diseÃ±o de la interfaz de usuario

Para finalizar el diseÃ±o del proyecto, hemos realizado unos prototipos del aspecto aproximado que tendrÃ¡ la interfaz de la pÃ¡gina web en algunas de sus
pÃ¡ginas. Se ha tratado de conseguir una interfaz sencilla e intuitiva, que permita al usuario una navegaciÃ³n clara y eficaz por la pÃ¡gina web, resultando
asÃ­ cÃ³moda desde el primer momento.
Los prototipos de la interfaz se muestran en las figuras (27), (28), (29), (30) y
(31).

5.10

5.10.1

manual de usuario
DescripciÃ³n del proyecto

El proyecto consiste en una pÃ¡gina web de objetivo didÃ¡ctico a la par que
prÃ¡ctico, en la que se ofrece informaciÃ³n sobre diversos modelos bÃ¡sicos de
epidemiologÃ­a de forma sencilla y clara a cualquier usuario.
De esta forma, el usuario puede aprender sobre varios modelos de epidemiologÃ­a comprobando interactivamente el comportamiento de estos modelos en
tiempo real, y cÃ³mo afectan los parÃ¡metros de cada uno de ellos a la evoluciÃ³n de los mismos.
AdemÃ¡s, se pueden subir ficheros con datos, ya sean generados por el propio
usuario o datos reales recogidos y comprobar el resultado de ajustar estos

75

76

desarrollo del software: anÃ¡lisis y diseÃ±o

Figura 27: Prototipo de la pÃ¡gina home.

Figura 28: Prototipo de la pÃ¡gina home, con desplegable mostrÃ¡ndose.

5.10 manual de usuario

Figura 29: Prototipo de la pÃ¡gina de un modelo interactivo.

Figura 30: Prototipo de la pÃ¡gina de ajuste de datos subidos desde un fichero.

77

78

desarrollo del software: anÃ¡lisis y diseÃ±o

Figura 31: Prototipo de la pÃ¡gina de ayuda.

datos a los modelos mencionados, asÃ­ como elegir el mejor modelo que ajusta
a dichos datos.
Para acceder a la pÃ¡gina web el usuario solo requiere de un dispositivo con
un navegador de internet mediante el que acceder a la web, introduciendo la
url correspondiente.

5.10.2

Comenzando a usar la web

Una vez introducida la url de la web en el navegador, aparecemos en la
pÃ¡gina principal de esta, la cual puede verse en (??).
Desde esta pÃ¡gina podemos acceder a todas las funcionalidades e informaciÃ³n de la web desde la barra de navegaciÃ³n y el menÃº lateral.
AdemÃ¡s, la pÃ¡gina principal es accesible en cualquier momento. Para volver
a ella basta clicar en el logo de la esquina superior izquierda o el nombre de
la pÃ¡gina situado a su lado.
Asimismo, en la barra de navegaciÃ³n, situado al lado del tÃ­tulo de la pÃ¡gina
encontramos el enlace a la ayuda de la misma. En esta pÃ¡gina encontramos

5.10 manual de usuario

Figura 32: PÃ¡gina home o principal de la web.

Figura 33: PÃ¡gina de ayuda, secciÃ³n de preguntas frecuentes.

dos secciones: preguntas frecuentes, que puede verse en (33), y contacto, que
se muestra en (34), para recibir asistencia personalizada o sugerir mejoras a
la pÃ¡gina web.
TambiÃ©n puede accederse a la pÃ¡gina de ayuda desde el menÃº lateral, clicando en Â¿CÃ³mo funciona? para mostrar las opciones del desplegable y luego en
ayuda. Aparte, en notaciÃ³n hay un resumen de la notaciÃ³n usada en toda la
pÃ¡gina web, haciendo fÃ¡cil consultarla en cualquier momento. El apartado de
notaciÃ³n se muestra en (35).

79

80

desarrollo del software: anÃ¡lisis y diseÃ±o

Figura 34: PÃ¡gina de ayuda, secciÃ³n de contacto.

Figura 35: PÃ¡gina de notaciÃ³n.

5.10 manual de usuario

81

Figura 36: Desplegable de modelos discretos desplegado.

Finalmente, las distintas funcionalidades de la pÃ¡gina se encuentran en el
menÃº lateral. Estas funcionalidades se explican a continuaciÃ³n.

5.10.3

5.10.3.1

Funcionalidades
ModificaciÃ³n de parÃ¡metros de los modelos interactivos

En el menÃº lateral encontramos dos menÃºs desplegables, llamados Modelos discretos
y Modelos Continuos. Al pulsar sobre cualquiera de ellos se muestran tres enlaces, a los modelos SI, SIR y SIS, como se ve en (36). Al seleccionar cualquiera
de ellos llegamos a la pÃ¡gina de dicho modelo.
En las pÃ¡ginas de los modelos podemos distinguir varias partes principales:
Al comienzo de la pÃ¡gina de cada modelo se explica la teorÃ­a y ecuaciones correspondientes a dicho modelo. Por ejemplo, para el modelo SI
discreto se puede ver la explicaciÃ³n teÃ³rica en (37).
A continuaciÃ³n se muestran los parÃ¡metros del modelo, que el usuario
puede modificar con el fin de ver cÃ³mo varÃ­a el comportamiento del
modelo que se estÃ¡ estudiando. En el modelo SI por ejemplo se pueden
modificar los modelos que se ven en (38).
Finalmente, se muestran una serie de grÃ¡ficas que ilustran el comportamiento del modelo con los parÃ¡metros dados. La primera es una fun-

82

desarrollo del software: anÃ¡lisis y diseÃ±o

Figura 37: PÃ¡gina del modelo SI, explicaciÃ³n teÃ³rica.

cion de cada grupo explÃ­cita grupo, se puede ver en (38), mientras el
resto son funciones implÃ­citas del tiempo, se muestra en (39).

5.10.4

Ajuste de datos

TambiÃ©n es posible subir un fichero en formato csv con datos para ajustar
con alguno de los modelos disponibles.
Es importante que el fichero a subir tenga como mÃ­nimo dos filas y tres
columnas llamadas t, S e I, siendo estas el tiempo, los individuos susceptibles
en ese tiempo y los individuos infectados en ese tiempo, respectivamente.
Adicionalmente, si fuera pertinente se podrÃ­a tener una cuarta columna R
con los recuperados en ese tiempo.
Un ejemplo de un fichero vÃ¡lido serÃ­a fichero_ejemplo.csv conteniendo:
t,S,I,R
0,97.01665754023489,3.377399973205731,-3.816768927775707
1,102.24543170326915,3.341582397679812,-1.2931795115592053
2,104.19872670845312,6.0049071497214,-3.2175059735520164
3,99.79707480976897,10.796475445761393,0.6508408522616295
4,99.993286104437,3.8927305934099175,0.6722548513086043

5.10 manual de usuario

Figura 38: PÃ¡gina del modelo SI, campos para la modificaciÃ³n de parÃ¡metros y grÃ¡fica explÃ­cita del tiempo.

Figura 39: PÃ¡gina del modelo SI, grÃ¡fica implÃ­cita del tiempo.

83

84

desarrollo del software: anÃ¡lisis y diseÃ±o

Figura 40: PÃ¡gina de ajuste de datos. Subida de fichero.

Para subir el fichero en (40) seleccionamos Examinar, de forma que se abre el
navegador de archivos y podemos seleccionar nuestro fichero de datos. Una
vez seleccionado pulsamos Upload y cargamos el archivo.
Una vez cargado el fichero se nos muestra una grÃ¡fica con los datos del
fichero representados, como se ve en (41). A continuaciÃ³n, se muestra un
desplegable para elegir el modelo con el que se van a intentar ajustar los
datos. Las opciones de este son:
Modelo SI. Ajusta un modelo SI a los datos.
Modelo SIR. Ajusta un modelo SIR a los datos.
Modelo SIS. Ajusta un modelo SIS a los datos.
Mejor modelo. El sistema decide cuÃ¡l es el modelo de los ya mencionados que mejor se ajusta a los datos en base a los errores obtenidos y lo
muestra. Realiza el ajuste con dicho modelo.
AdemÃ¡s, se muestra una grÃ¡fica donde se representan los datos y el ajuste
obtenido. Este desplegable y la grÃ¡fica representando el ajuste se muestran
en (42).
Bajo ella, se pueden ver las estimaciones de los parÃ¡metros de acuerdo al
modelo seleccionado y los errores correspondientes. En caso de que la opciÃ³n
para el ajuste haya sido Mejor modelo se muestra tambiÃ©n el modelo elegido.
Estas estimaciones se ven en (43).

5.10 manual de usuario

Figura 41: PÃ¡gina de ajuste de datos. GrÃ¡fica de representaciÃ³n de los datos del fichero.

Figura 42: PÃ¡gina de ajuste de datos. Desplegable y grÃ¡fica con el ajuste.

Figura 43: PÃ¡gina de ajuste de datos. Estimaciones de parÃ¡metros y errores.

85

86

desarrollo del software: anÃ¡lisis y diseÃ±o

5.10.5

InstalaciÃ³n del backend

Para lanzar la pÃ¡gina web de una manera cÃ³moda, rÃ¡pida y simple, se ha
creado un contenedor docker actualizado con todas las dependencias necesarias para el funcionamiento de la misma.
De esta manera, basta con ejecutar el contenedor docker, accesible en Dockerhub, descargarlo y ejecutarlo. El contenedor puede obtenerse en
https://hub.docker.com/repository/docker/mapachana/plotsir.
Para obtener y lanzar la imagen debe abrirse una terminal y ejecutar los
siguientes comandos:
docker pull mapachana/plotsir:latest
docker run -t -p 5000:5000 -p 8050:8050

mapachana/plotsir:latest

Tras esto accedemos a la url localhost:5000 en nuestro navegador.

5.11

datos reales

Una vez estudiados los modelos teÃ³ricos y terminada la implementaciÃ³n vamos a realizar el ajuste de varios modelos aplicado a datos reales de enfermedades. De esta forma, podemos comprobar si los modelos estudiados sirven
para ajustar los datos de algunas enfermedades, ayudando tambiÃ©n asÃ­ a la
comprensiÃ³n del desarrollo de estas.

5.12

el vih en baleares

El VIH (Virus de Inmunodeficiencia Humana) es un virus que ataca al sistema inmunitario del cuerpo. Si no se trata, puede causar SIDA. Actualmente
no hay ninguna cura efectiva contra el VIH, por lo que una vez que se contrae,
se tiene de por vida.
El VIH provino de una especie de chimpancÃ© de Ãfrica, desde la que se propagÃ³ primero por dicho continente, y se estima que lleva en Estados Unidos
desde finales de los aÃ±os 70.

5.12 el vih en baleares

Dado que es una enfermedad para la que una vez infectado no dejas de
tenerla, se tiene que sigue un modelo SI.
El conjunto de datos que se va a usar contiene los datos de los reportes de
nuevos infectados por VIH en Baleares desde 2003 hasta 2019 anualmente. La
fuente de dichos datos es [4].
En el informe se proporcionan los nuevos casos detectados, luego los datos
con los que vamos a trabajar son la suma acumulada de estos casos nuevos.
Esto se debe a que el modelo considera los casos activos, no solo los nuevos.
Por tanto, tenemos que los casos activos son los nuevos mÃ¡s todos los que
habÃ­a antes.
AdemÃ¡s, para que el modelo funcione bien el nÃºmero total de individuos
consideramos es el nÃºmero de individuos estudiados, en este caso N = 2704.
Teniendo esto en cuenta, generamos un fichero csv con el formato de la pÃ¡gina web.
Primeramente, observamos la representaciÃ³n de los datos en (44). Vemos que
el nÃºmero de individuos susceptibles va descendiendo, asÃ­ como el de infectados creciendo en tÃ©rminos globales. Pese a esto, en ciertas partes de la grÃ¡fica
se aprecia una leve curvatura, donde los susceptibles pasan de ser cÃ³ncavos
a convexos y los infectados de convexo a cÃ³ncavo.
Elegimos como modelo de ajuste mejor modelo, donde obtenemos que el mejor modelo segÃºn el sistema es, como se comentaba inicialmente, el modelo
SI.
La representaciÃ³n grÃ¡fica del ajuste se puede ver en (45). En las curvas del
ajuste generado apreciamos con mayor claridad ese cambio de curvatura de
cÃ³ncavo a convexo y viceversa en el ajuste.
En (46) se muestra la estimaciÃ³n de los parÃ¡metros obtenidos para el ajuste,
resultando un Î± â‰ˆ 0,31 e I0 â‰ˆ 287. Dado que los valores de estos parÃ¡metros
son razonables y la representaciÃ³n grÃ¡fica del ajuste aproxima relativamente
bien los datos obtenidos, parece que las infecciones por VIH en Baleares en
efecto siguen un modelo SI.

87

88

desarrollo del software: anÃ¡lisis y diseÃ±o

Figura 44: RepresentaciÃ³n de los datos del VIH en Baleares.

Figura 45: RepresentaciÃ³n del ajuste con el modelo SI a los datos del VIH en Baleares.

5.13 el covid en espaÃ±a

Figura 46: Estimaciones y errores del ajuste con el modelo SI a los datos del VIH en
Baleares.

5.13

el covid en espaÃ±a

El covid es una enfermedad respiratoria aguda causada por el virus SARSCoV-2. Se informÃ³ respecto a ella por primera vez en Diciembre de 2019, tras
detectarse varios casos en Wuhan. Posteriormente se extendiÃ³ a otros paÃ­ses,
entre los que se encuentra EspaÃ±a.
A lo largo de la pandemia del covid en el mundo se han recopilado una gran
cantidad de datos para estudiar esta enfermedad. Para este estudio vamos a
usar el conjunto de datos obtenido de [6].
En [2] se comprueba que se puede modelar mediante el modelo SIR. Vamos
a tratar de ajustarla siguiendo este modelo.
En el fichero csv de los datos hay mucha informaciÃ³n, pero realmente solo
vamos a usar las columnas new_cases, que indica los nuevos casos reportados
y new_deaths, que informa de las nuevas muertes.
Del fichero, nos quedamos con los datos de EspaÃ±a y esas dos columnas, que
a continuaciÃ³n trataremos, ya que al igual que en el caso anterior, necesitamos
todos los casos activos y todos los recuperados hasta el momento.
Vamos a ajustar solo el principio de la pandemia, en concreto vamos a ajustar
a partir del dÃ­a de 5 de Marzo de 2020, ya que en los 10 dÃ­as anteriores no hay
datos reportados pese a que aparecen en los datos, y durante los siguientes
170 dÃ­as, esto es, hasta el 21 de Agosto de 2020, pues es aproximadamente
6 meses, lo que se estima durÃ³ lo que se conoce coloquialmente como la
primera ola.

89

90

desarrollo del software: anÃ¡lisis y diseÃ±o

Por comodidad, vamos a tratar los datos como indexados en el tiempo, correspondiendo por tanto al 5 de Marzo el Ã­ndice 0 y al 21 de Agosto el 170.
Es importante ajustar solamente una ola, pues el modelo SIR considera que
tras recuperarse, los individuos no vuelven a ser susceptibles ni a infectarse,
pero esto no es asÃ­ en la realiidad. El modelo SIR ajusta solamente las olas de
forma independiente.
Para calcular el nÃºmero de infectados activos, dado que el covid al principio
de la pandemia tenÃ­a una duraciÃ³n aproximada de 10 dÃ­as, se han considerado todos los nuevos casos reportados desde 10 dÃ­as atrÃ¡s hasta ese dÃ­a como
activos.
Asimismo, como recuperados se han considerados los fallecidos y los nuevos infectados de hace mÃ¡s de 10 dÃ­as atrÃ¡s, pues ya habrÃ­an superado la
enfermedad y no podrÃ­an volver a infectarse.
AdemÃ¡s, para que el modelo funcione bien el nÃºmero total de individuos
considerados es el nÃºmero de individuos estudiados aproximadamente, en
este caso N = 40000.
Teniendo esto en cuenta, generamos un fichero csv con el formato necesario
para realizar un ajuste en la pÃ¡gina web.
Al igual que antes, comenzamos observando la representaciÃ³n de los datos
en (47). El nÃºmero de recuperados siempre es creciente, asÃ­ como el de susceptibles es siempre decreciente. Llama la atenciÃ³n la forma de los infectados,
que primero suben y luego descienden, indicando asÃ­ el final de la ola.
Elegimos como modelo de ajuste mejor modelo, donde obtenemos que el mejor modelo segÃºn el sistema es, como se comentaba inicialmente, el modelo
SIR.
La representaciÃ³n grÃ¡fica del ajuste se puede ver en (48). El ajuste parece
seguir las tendencias generales de los datos, aunque los infectados quedan
ligeramente por encima en el ajuste que en los datos experimentales, asÃ­ como
los recuperados y susceptibles ajustan peor al final, pues cuanto mÃ¡s nos
alejamos de la ola en sÃ­, peor es el ajuste al modelo SIR.

5.13 el covid en espaÃ±a

Figura 47: RepresentaciÃ³n de los datos del covid en EspaÃ±a desde el 5 de Marzo
hasta e 21 de Agosto de 2020.

Figura 48: RepresentaciÃ³n del ajuste con el modelo SIR a los datos del covid en EspaÃ±a desde el 5 de Marzo hasta el 21 de Agosto de 2020.

91

92

desarrollo del software: anÃ¡lisis y diseÃ±o

Figura 49: Estimaciones y errores del ajuste con el modelo SIR a los datos del covid
en EspaÃ±a.

En (49) se muestra la estimaciÃ³n de los parÃ¡metros obtenidos para el ajuste,
resultando un Î± â‰ˆ 0,21, Î³ â‰ˆ 0,08, I0 â‰ˆ 1, R0 â‰ˆ 536. Dado que los valores de
estos parÃ¡metros son razonables, salvo quizÃ¡ por una estimaciÃ³n ligeramente
alta de los recuperados iniciales, y la representaciÃ³n grÃ¡fica del ajuste aproxima relativamente bien los datos obtenidos, parece que las infecciones por
covid en EspaÃ±a en efecto siguen un modelo SIR.

6
CONCLUSIONES Y VÃAS FUTURAS

6.1

conclusiones

6.2

vÃ­as futuras

93

BIBLIOGRAFÃA

[1] Allen, L. J. (1994). Some discrete-time SI, SIR, and SIS epidemic models.
Mathematical biosciences, 124(1), 83â€“105.
[2] Amaro, J. E. (2022). Systematic description of covid-19 pandemic using
exact sir solutions and gumbel distributions.
URL https://arxiv.org/abs/2204.12550
[3] Brauer, F., & Castillo-Chavez, C. (2012). Mathematical Models in Population
Biology and Epidemiology, vol. 40 of Texts in Applied Mathematics. New York,
NY: Springer New York.
[4] de EspaÃ±a, G. (2022-05-16).
URL
https://www.sanidad.gob.es/ciudadanos/enfLesiones/
enfTransmisibles/sida/vigilancia/Informe_VIH_SIDA_20201130.pdf

Informe vigilancia epidemiolÃ³gica vih espaÃ±a 2019.
[5] Demongeot, J., Griette, Q., & Magal, P. (2021). SI epidemic model applied
to COVID-19 data in mainland China. Royal Society Open Science, 7(12),
201878.
[6] owid (2022-05-16).
URL https://github.com/owid/covid-19-data/tree/master/public/
data/ Owid, covid-19 data.
[7] Salinelli, E., & Tomarelli, F. (2014). Discrete Dynamical Models, vol. 76 of
UNITEXT. Cham: Springer International Publishing.
[8] Strogatz, S. H. (1994). Nonlinear Dynamics and Chaos: With Applications
to Physics, Biology, Chemistry, and Engineering. Studies in Nonlinearity.
Reading, Mass: Addison-Wesley Pub.

94

