MODELOS EPIDEMIOLÓGICOS
ana buendía ruiz-azuaga

Trabajo Fin de Grado
Doble Grado en Ingeniería Informática y Matemáticas
Tutores
Teresa E. Pérez
Manuel Pegalajar Cuéllar
facultad de ciencias
e.t.s. ingenierías informática y de telecomunicación
Granada, a 21 de mayo de 2022

ÍNDICE GENERAL

1.

2.

introducción
1.1.

Motivación . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4

1.2.

Estado del arte . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5

1.3.

Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

1.4.

Descripción . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

1.5.

Fuentes y resultados . . . . . . . . . . . . . . . . . . . . . . . . .

6

1.6.

Estructura de la documentación . . . . . . . . . . . . . . . . . .

6

herramientas básicas

4.

2

7

Ecuaciones en diferencias . . . . . . . . . . . . . . . . . . . . . .

7

2.1.1.

Sistemas de ecuaciones en diferencias . . . . . . . . . .

9

2.1.2.

Puntos de equilibrio . . . . . . . . . . . . . . . . . . . .

9

2.2.

La ecuación logística . . . . . . . . . . . . . . . . . . . . . . . .

11

2.3.

Epidemiología . . . . . . . . . . . . . . . . . . . . . . . . . . . .

15

2.4.

Tipos de modelos epidemiológicos . . . . . . . . . . . . . . . .

16

2.5.

Optimización de parámetros . . . . . . . . . . . . . . . . . . . .

16

2.1.

3.

4

modelos discretos en epidemiología

19

3.1.

Modelos discretos . . . . . . . . . . . . . . . . . . . . . . . . . .

19

3.2.

Modelo SI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

19

3.3.

Modelo SIR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

22

3.4.

Modelo SIS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

29

3.5.

Modelos multipoblacionales . . . . . . . . . . . . . . . . . . . .

33

3.5.1.

Modelo SI . . . . . . . . . . . . . . . . . . . . . . . . . .

35

3.5.2.

Modelo SIR . . . . . . . . . . . . . . . . . . . . . . . . .

36

3.5.3.

Modelo SIS . . . . . . . . . . . . . . . . . . . . . . . . .

37

modelos continuos en epidemiología

39

4.1.

Tipos de modelos . . . . . . . . . . . . . . . . . . . . . . . . . .

39

4.2.

Modelo SI continuo . . . . . . . . . . . . . . . . . . . . . . . . .

40

4.3.

Modelo SIS continuo . . . . . . . . . . . . . . . . . . . . . . . .

42

4.4.

Modelo SIR continuo . . . . . . . . . . . . . . . . . . . . . . . .

44

4.5.

Modelo Kermack-McKendrick . . . . . . . . . . . . . . . . . . .

45

Índice general

.
.
.
.

48
48
50
52

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

53
53
54
55
55
55
56
57
57
59
61
62
63
64
72
73
74
74
75
75
75
78
81
82
86
86
86
89

conclusiones y vías futuras
6.1. Conclusiones . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6.2. Vías futuras . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

93
93
93

4.6.

5.

6.

Análisis de los parámetros de los modelos
4.6.1. Introducción . . . . . . . . . . . . .
4.6.2. Aproximación de I0 y τ (t0 ) . . . .
4.6.3. Fórmula teórica para τ (t) . . . . .

desarrollo del software: análisis y
5.1. Objetivos y análisis de requisitos . . .
5.2. Desarrollo del proyecto . . . . . . . . .
5.3. Gestión de recursos . . . . . . . . . . .
5.3.1. Recursos humanos . . . . . . .
5.3.2. Recursos hardware . . . . . . .
5.3.3. Recursos software . . . . . . . .
5.3.4. Estimación del coste . . . . . .
5.4. Planificación temporal . . . . . . . . .
5.5. Diagrama conceptual . . . . . . . . . .
5.6. Casos de uso . . . . . . . . . . . . . . .
5.6.1. Actores del sistema . . . . . . .
5.6.2. Diagrama de casos de uso . . .
5.6.3. Plantillas de casos de uso . . .
5.7. Diagramas de actividad . . . . . . . . .
5.8. Pruebas . . . . . . . . . . . . . . . . . .
5.8.1. Pruebas unitarias . . . . . . . .
5.8.2. Pruebas de usuario . . . . . . .
5.9. Diseño de la interfaz de usuario . . . .
5.10. Manual de usuario . . . . . . . . . . . .
5.10.1. Descripción del proyecto . . . .
5.10.2. Comenzando a usar la web . .
5.10.3. Funcionalidades . . . . . . . . .
5.10.4. Ajuste de datos . . . . . . . . .
5.10.5. Instalación del backend . . . .
5.11. Datos reales . . . . . . . . . . . . . . . .
5.12. El VIH en Baleares . . . . . . . . . . . .
5.13. El covid en España . . . . . . . . . . . .

Bibliografía

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

diseño
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .
. . . . . .

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

93

3

1
INTRODUCCIÓN

1.1

motivación

Las enfermedades contagiosas como la influenza o tuberculosis son problemas importantes, así como epidemias más recientes como el SIDA, el SARS
o el Ébola. Estas enfermedades y sus comportamientos son interesantes para
una gran parte de la población. En especial, los efectos de estas u otras enfermedades en países menos desarrollados adquiere aún más relevancia ya que
debido a la falta de medios la mortalidad y consecuencias de las epidemias
en estas regiones es mucho más grave que en otros lugares, lo que afecta
entre otros factores a su esperanza de vida y economía.
Las epidemias han tenido un peso importante en la civilización a lo largo de
la historia, encontrando referencias a ellas en diversos escritos históricos, pese
a que antiguamente se referían a estas epidemias como plagas, que registran
caídas de imperios como el Imperio Romano por la plaga de Antonine o el
Imperio de Han en China en circunstancias similares, de acuerdo a cita y cita.
De la misma manera, hay constancia de las importantes consecuencias que
tuvo la plaga bubónica en Asia y Europa durante el siglo XIV.
Cuando hablamos de enfermedades contagiosas, especialmente si nos resultan desconocidas, surgen muchas preguntas, destacando entre otras ”¿Cómo
de grave va a ser la epidemia?”, ”¿Cuántas personas van a contagiarse?” o
”¿Cuánto va a durar la epidemia?”.
Dado que los experimentos para obtener información acerca de las epidemias
son casi imposibles de llevar a cabo por la propia naturaleza de las epidemias

4

1.2 estado del arte

y cuestiones éticas y morales, se suelen obtener los datos de las epidemias que
surgen naturalmente, por lo que muchos de estos datos no están completos
o pueden no ser precisos.
Los modelos matemáticos en epidemiología ayudan a comprender los mecanismos que intervienen en la propagación de la enfermedad a la vez que
sugieren mecanismos para el control de esta. Los modelos suelen identificar
comportamientos que no son evidentes en los datos empíricos.

1.2

estado del arte

La epidemiología tiene su origen con Hipócrates de Cos, conocido como el
padre de la medicina. Fue la primera persona de la que se tiene conocimiento
que haya estudiado la relación entre la aparición de enfermedades y su entorno. Hipócrates creía que la enfermedad era causada por el desequilibrio
de cuatro humores: sangre, flema, bilis amarilla y bilis negra. La cura para
las enfermedades era añadir o quitar el humor correspondiente para reequilibrar el cuerpo. Esta creencia comenzó la aplicación de sangrar a los enfermos
y aplicarles dietas en la medicina. Usó además los términos endémico, para
enfermedades que se encuentran en ciertos lugares y no en otros, y epidemia
para enfermedades que se ven en unos momentos determinados pero no en
otros.
A mediados del siglo XVI el doctor Girolamo Fracastoro fue el primero en
proponer la teoría sobre la existencia de partículas tan pequeñas que resultaban invisibles que causaban enfermedades. Se creía que se propagaban por
el aire, se multiplicaban por sí mismas y se podían destruir aplicando fuego.
Fue el primero en recomendar higiene personal y del entorno de los individuos para prevenir enfermedades. Finalmente, en 1675 Antonie van Leeuenhoek aportó evidencia visual de partículas consistentes con esta teoría con un
microscopio lo suficientemente potente.
Además, Wu Youke también tuvo la idea de que algunas enfermedades eran
causadas por agentes transmisibles cuando observó varias epidemias. Sus
consideraciones aún resultan muy relevantes en la medicina china en la actualidad.

5

6

introducción

Thomas Sydenham fue el primero en distinguir entre diversas fiebres entre
la población de Londres a finales de 1600.
John Graunt, un propietario de una tienda pequeña y estadístico aficionado
analizó la mortalidad en Londres antes de la Gran Plaga, presentando así
una de las primeras tablas de mortalidad, esto es, una tabla mostrando para
cada edad cuál es la probabilidad de que una persona muera antes de su
próximo cumpleaños. También reportó tendencias en el tiempo de múltiples
enfermedades, tanto nuevas como ya conocidas en la época, así como aportó
evidencia estadística para muchas teorías sobre las enfermedades, así como
refutó otras creencias muy extendidas.
John Snow es ampliamente conocido por sus investigaciones sobre la epidemia de cólera del siglo XIV, y se le conoce como el padre de la epidemiología
moderna. Entre sus diversas aportaciones, destaca como terminó el brote de
Broad Street, que el doctor estableció se debía al agua proveniente de un pozo contaminado con heces en esa calle. Mezcló cloro en el agua y cambió la
bomba del pozo, frenando así la epidemia. Esto supuso un gran avance de
cara a la higiene y sanidad pública, pese a que sus investigaciones y avances
no fueron puestas en práctica hasta después de su fallecimiento.
A principios del siglo XX se introdujeron modelos matemáticos en la epidemiología por Ronald Ross, Janed Lane-Claypon y Anderson Gray mcKendrick (cuyo modelo presentaremos más adelante), entre otros. Desde entonces, muchos especialistas se unieron progresivamente al estudio de este campo.

1.3

objetivos

1.4

descripción

1.5

fuentes y resultados

1.6

estructura de la documentación

2
H E R R A M I E N TA S B Á S I C A S

En este capítulo se presentarán algunos conceptos y herramientas básicas que
nos resultarán útiles a lo largo de los siguientes capítulos. Como referencias
se ha usado principalmente [3], [7] y [8].

2.1

ecuaciones en diferencias

Comenzamos presentando la teoría básica necesaria. Para su elaboración se
ha usado principalmente [7].
Definición 1. Se define una ecuación en diferencias de orden k, con k ≥ 1,
como una ecuación en la que intervienen un número fijo de términos consecutivos de una sucesión.

F (n, Xn , Xn+1 , · · · , Xn+k ) = 0,

∀n ∈ N,

(1)

donde F es una función de k + 2 variables en la forma F : N × I k+1 → R,
con I un intervalo con al menos dos puntos, k indica el número de términos necesarios para generar el siguiente y donde la sucesión { Xn }n≥0 es la
incógnita.
En las aplicaciones reales de ecuaciones en diferencias, el subíndice n suele
considerarse el tiempo, por lo que en estas se considera positivo y discreto.
Definición 2. Una ecuación en diferencias de orden k, con k ≥ 1 se dice que
está en forma normal si está expresada de la forma:

7

8

herramientas básicas

Xn+k = Φ(n, Xn , Xn+1 · · · , Xn+k−1 )

(2)

donde Φ es una función dada definida en Φ : N × I k → I.
Definición 3. Una solución de una ecuación en diferencias de orden k es una
sucesión { Xn }n≥0 de números reales definida explícitamente de la forma:
Xn = f ( n ),

n ≥ 0,

donde f : N → I es una función que cumple (1) al sustituir Xn por f (n) para
cualquier n ∈ N.
El conjunto de todas las soluciones de (1) se llama solución general de la
ecuación.
Teorema 1 (Existencia y unicidad). Sea Φ una función de la forma presentada en
(2). Entonces la ecuación en diferencias en forma normal (2) tiene solución. Para cada
k-upla (α0 , α1 , · · · , αk−1 ) ∈ I k el problema anterior en forma normal con condiciones
iniciales dadas tiene una única solución.
Xn+k = Φ(n, Xn , Xn+1 · · · , Xn+k−1 )

X0 = α 0 , X1 = α 1 , · · · , X k − 1 = α k − 1 .

(3)

Demostración. Sustituyendo las condiciones iniciales en (2) con k = 0 obtenemos el valor exacto para Xk , al que llamamos αk . Por definición de Φ,
(α1 , α2 , · · · , αk ) ∈ I k , luego sustituyendo de nuevo en la misma ecuación por
las condiciones iniciales

X1 = α 1 , X2 = α 2 , · · · , X k = α k ,
obtenemos Xk+1 . Repitiendo este proceso se crea una sucesión { Xn }n≥0 única,
que es solución de (2).

2.1 ecuaciones en diferencias

2.1.1

Sistemas de ecuaciones en diferencias

Definición 4. Se define un sistema de m ecuaciones en diferencias como un
conjunto de m ecuaciones en diferencias a resolver.




Xn1 +k = Φ1 (n, Xn1 , · · · , Xn1 +k−1 , Xn2 , · · · , Xn2 +k−1 , · · · , Xnm , · · · Xnm+k−1 )



···




 m
Xn+k = Φm (n, Xn1 , · · · , Xn1 +k−1 , Xn2 , · · · , Xn2 +k−1 , · · · , Xnm , · · · Xnm+k−1 )

(4)

Donde Φi : N × D → D, con D ⊂ Rmk para todo i = 1, · · · , m.
Renombrando, podemos expresar el conjunto de sucesiones como:

Xn = ( Xn1 , Xn2 , · · · , Xnm ) T

(5)

luego el sistema de ecuaciones resultaría:

Xn+k = Φ(n, Xn , · · · , Xn+k−1 )

(6)

donde Φ : D → D, con D siendo el dominio de la función Φ, y por tanto
D ⊂ N × Rk y con Φ = (Φ1 , · · · Φm ).
Definición 5. Una solución de un sistema de ecuaciones en diferencias son
las soluciones explícitas de cada ecuación del sistema, de forma que se satisfagan todas ellas; es decir, encontrar una solución explícita para Xn en (6).

2.1.2

Puntos de equilibrio

Definición 6. Sea D ⊂ Rm y Φ : D → D una función continua. Entonces
un vector X ∗ ∈ Rm se dice que es un punto de equilibrio de un sistema de
ecuaciones en diferencias de la forma (6) si

9

10

herramientas básicas

X ∗ = Φ ( X ∗ ),

X ∗ ∈ D.

Se suele decir que los puntos de equilibrio son soluciones independientes del
tiempo.
Proposición 1. Si tomamos como valor inicial un punto de equilibrio, llamemoslo
X ∗ , de un sistema de ecuaciones en diferencias, entonces la solución explícita del
sistema es constante y viene dada por:
Xn = X ∗ ,

∀n ∈ N.

Definición 7. Un punto de equilibrio X ∗ de un sistema de ecuaciones en
diferencias como (6) se dice que es un atractor global o globalmente asintóticamente estable si para cualquier X0 ∈ D se verifica
lı́m Xn = X ∗ .

n→∞

Definición 8. Un punto de equilibrio X ∗ de un sistema de ecuaciones en
diferencias como (6) se dice que es un atractor local (o es localmente asintóticamente estable) si existe η > 0 tal que para cualquier X0 ∈ D ∩ B( X ∗ , η ) se
verifica
lı́m Xn = X ∗ .
n→∞

Definición 9. Un punto de equilibrio X ∗ de una ecuación en diferencias
Xn+1 = f ( Xn ), con f derivable se dice que es:
Estable si para cualquier e > 0 existe una constante δ > 0 tal que si
| X0 − X ∗ | < δ y Xn = f ( X0 ) con n ∈ N, entonces se verifica

| Xn − X ∗ | < e ∀n ∈ N.
Inestable si no es estable, esto es ∃e0 > 0 tal que para todo δ > 0
podemos encontrar X0 y n0 ∈ N tal que

| X0 − X ∗ | < δ y | X n 0 − X ∗ | > e0 .

2.2 la ecuación logística

Proposición 2. Si X ∗ es un punto de equilibrio de una ecuación en diferencias
Xn+1 = f ( Xn ), f ∈ C1 , entonces:
Si | f 0 ( X ∗ )| < 1 entonces X ∗ es un atractor local o localmente asintóticamente
estable.
Si | f 0 ( X ∗ )| > 1 entonces X ∗ es inestable.
Proposición 3. Si X ∗ es un punto de equilibrio de una ecuación en diferencias
Xn+1 = f ( Xn ), con f ∈ C3 y f 0 ( X ∗ ) = 1, entonces:
Si | f 00 ( X ∗ )| 6= 0 entonces X ∗ es inestable.
Si | f 00 ( X ∗ )| = 0 y f 000 ( X ∗ ) < 0 entonces X ∗ es localmente asintóticamente
estable.
Si | f 00 ( X ∗ )| = 0 y f 000 ( X ∗ ) > 0 entonces X ∗ es inestable.
2.2

la ecuación logística

En este apartado describiremos la ecuación logística discreta y sus principales
propiedades que serán utilizadas más adelante. La teoría puede ampliarse en
[8].
Definición 10. La ecuación logística discreta tiene la siguiente forma:

xn+1 = µxn (1 − xn ),

µ > 0,

que está definida en el intervalo [0, 1]. Definimos

f ( x ) = µx (1 − x )
Para que 0 ≤ xn ≤ 1 es necesario que xn = f ( xn−1 ) esté en el intervalo [0, 1].
Tenemos que f ( x ) es una parábola cóncava con puntos de corte con el eje x
en 0 y 1. Para que f ( x ) < 1 su máximo debe ser menor que 1.
Este máximo se alcanza en

1
2

y su valor es

 


1
1
1
µ
f
=µ
1−
= .
2
2
2
4

11

12

herramientas básicas

Luego debe ser 0 < µ ≤ 4.
Proposición 4. Consideramos la ecuación logística con 0 ≤ x0 ≤ 1 y 0 < µ ≤ 4.
Entonces los puntos de equilibrio son 0, siendo este estable si µ < 1 e inestable si
µ > 1; y 1 − µ1 con µ ≥ 1 siendo estable si 1 < µ < 3 e inestable si µ > 3.
Demostración. Consideramos la ecuación logística:
xn+1 = µxn (1 − xn ),
y definamos f ( x ) = µx (1 − x ). Es claro que f es de clase infinito por ser
polinómica.
Los puntos de equilibrio cumplen
x ∗ = f ( x ∗ ) = µx ∗ (1 − x ∗ ).
Luego se tiene x ∗ = 0 o 1 = µ(1 − x ∗ ), de donde se obtiene x ∗ = 1 − µ1 .
Estudiamos ahora la estabilidad de los puntos de equilibrio a través de su
derivada, para ello consideramos:
f 0 ( x ) = µ(1 − 2x ).
Entonces se tiene que f 0 (0) = µ, por lo tanto x ∗ = 0 es localmente asintóticamente estable si µ < 1 e inestable si µ > 1. Estudiamos ahora el caso
µ = 1.
Tenemos f 00 ( x ) = −2µx y f 000 ( x ) = −2µ. Considerando µ = 1, tenemos que
f 0 (0) = 1,
f 00 (0) = 0,
f 000 (0) = −2.
Por tanto, 0 es localmente asintóticamente estable.

2.2 la ecuación logística

Figura 1: Diagrama Cobweb de la ecuación logística, con x0 = 0,2, µ = 2,8.

x0 = 0.2, µ = 2.8
1.0

0.8

µx(1 − x)

0.6

0.4

0.2

0.0
0.0

0.2

0.4

0.6

0.8

1.0

x

f0



1
µ



Por otra parte,
1−
= 2 − µ. Por tanto es localmente asintóticamente
estable si −1 < 2 − µ < 1, o, equivalentemente, 1 < µ < 3 y es inestable si
µ > 3.
Se ha comprobado gráficamente mediante las representaciones gráficas (1) y
(2).
En (1) podemos ver como el punto de equilibrio x ∗ = 0 es inestable y como
el otro punto de equilibrio x ∗ es localmente asintóticamente estable.
Asimismo, en (2) observamos como ambos puntos de equilibrio son inestables.

Proposición 5. La ecuación logística tiene un 2-ciclo para todo µ > 3, es decir,
existen dos puntos p y q tal que f ( p) = q y f (q) = p.
Demostración. Tenemos que f ( p) = q y f (q) = p es equivalente a f ( f ( p)) =
p y f ( f (q)) = q, es decir, p es un punto fijo al iterar dos veces la función
dada.

13

herramientas básicas

Figura 2: Diagrama Cobweb de la ecuación logística, con x0 = 0,2, µ = 3,8.

x0 = 0.2, µ = 3.8
1.0

0.8

0.6

µx(1 − x)

14

0.4

0.2

0.0
0.0

0.2

0.4

0.6

0.8

1.0

x

Como f ( x ) es una función polinómica de segundo grado, entonces f ( f ( x ))
será de cuarto grado, luego tendrá 4 raíces entre reales y complejas.
Por tanto necesitamos resolver la ecuación de cuarto grado f ( f ( x )) = x. Sabemos que los puntos fijos de la ecuación logística cumplen f ( x ∗ ) = x ∗ , luego
f ( f ( x ∗ )) = f ( x ∗ ) = x ∗ ,
por lo que son solución de la ecuación. Y al factorizar conociendo estas soluciones el problema se reduce a resolver una ecuación cuadrática de la que
obtenemos las siguientes raíces:
p, q =

µ+1±

p

(µ − 3)(µ + 1)
.
2µ

Estas soluciones son reales si µ > 3 luego existe un 2-ciclo.
Si µ = 3 estas raíces coinciden y valen p = q = 32 = 1 −
existe un 2-ciclo, hemos obtenido el mismo punto fijo.

1
3

= 1 − µ1 , luego no

2.3 epidemiología

Por último, si µ < 3 las raíces no son reales y por tanto no existe un 2ciclo.
Si µ = 3,3 tenemos que la solución de la ecuación logística oscila repitiéndose
cada dos iteraciones, es decir, sigue un 2-ciclo. Si µ = 3,5 la solución se
repite cada 4 iteraciones, luego sigue un 4-ciclo. Se encuentran períodos más
grandes (de 8, 16, 32...) a medida que µ toma valores mayores.
Sea µn el valor de µ para el cual aparece un 2n -ciclo. Entonces experimentalmente se obtiene que µn converge a un valor µ∞ = 3,569946....
Proposición 6. En la ecuación logística, se tiene que su solución converge si µ < 3,
oscila si 3 < µ . 3,57 y se produce caos si µ & 3,57.

2.3

epidemiología

Las enfermedades infecciosas como la influenza (o gripe) o la tuberculosis
pueden ser severas. La epidemia del SIDA, pandemias recurrentes de influenza, brotes de ébola y la pandemia del Covid-19 son acontecimientos que preocupan e interesan a muchas personas. La prevalencia y los efectos de estas
enfermedades sobre todo en países menos desarrollados son menos estudiadas, pero de mayor interés, pues la mortalidad de estas y otras enfermedades
en estas zonas es mucho mayor que en países desarrollados. Muchas enfermedades como la malaria o el cólera son endémicas en muchas partes del
mundo. Los efectos de enfermedades con alta mortalidad en la esperanza de
vida y en la economía de los países afectados es considerable. Por ello, el
estudio y modelado de epidemias es muy relevante.
A continuación se explican algunos conceptos básicos de epidemiología. Para
esta sección se ha usado principalmente [3].
Definición 11. Las epidemias son brotes espontáneos de una enfermedad o
situaciones endémicas, en las que la enfermedad está siempre presente.
Los individuos de una población se pueden dividir en tres grupos, haciendo
referencia a su situación con respecto a la enfermedad.

15

16

herramientas básicas

Definición 12. Los individuos susceptibles, que denotamos Sn , son aquellos
que pueden infectarse con la enfermedad pero aún no lo han hecho en el
momento n.
Definición 13. Los individuos infectados, a los que denotamos In , son las
personas infectadas en el instante n por la enfermedad y pueden contagiar la
enfermedad a los individuos susceptibles.
Definición 14. Los individuos recuperados, que denotamos Rn , son los individuos que han estado infectados y ya no contagian la enfermedad ni pueden
volver a infectarse. Los individuos recuperados hacen referencia a los individuos inmunizados, aislados, recuperados o fallecidos.

2.4

tipos de modelos epidemiológicos

Los modelos epidemiológicos (principalmente SI, SIR y SIS) usan los estados
Susceptible, Infectado y Recuperado. Los nombres suelen hacer referencia al
flujo que se sigue para pasar entre los estados. Así, por ejemplo un modelo SI pasa de susceptible a infectado, uno SIR de susceptible a infectado y
recuperado y SIS alterna entre susceptible e infectado.
En estos modelos se hacen dos suposiciones:
1. La población se mezcla de manera homogénea, es decir, todos los individuos tienen la misma probabilidad de contraer la enfermedad.
2. El total de la población es constante y lo denotaremos por N.

2.5

optimización de parámetros

Para la realización de este proyecto se va a desarrollar una funcionalidad
quee estime los parámetros de los modelos de forma automática. Para ello,
se va a utilizar una función de pérdida que sea flexible a varios modelos,
buscando un equilibrio entre su rapidez y precisión.
Se ha decidido utilizar scipy, pues proporciona diversas funciones para minimizar o maximizar funciones objetivo, posiblemente sujetas a restricciones.

2.5 optimización de parámetros

Es importante destacar también que sirve para problemas no lineales, como
lo son los modelos epidemiológicos a estudiar.
Definición 15. Llamamos función objetivo a la función que queremos maximizar o minimizar.
Dado un conjunto de datos con N datos ( x, y) y un modelo que aproxima
y en función de x, al que notamos ŷ = f ( x, w) + ε. Tenemos que ŷ es una
aproximación de y y ε el error de la aproximación según el modelo f . A los
parámetros del modelo, los hemos denotado w, son desconocidos y son los
que buscamos estimar de forma que ŷ sea lo más parecido o cercano a y
posible.
Para medir la bondad del ajuste, escogemos una medida del error, en este
1
caso se ha tomado como medida 1+ MSE
, donde MSE es el Minimum Squared
Error o Error Cuadrático Medio.
Definición 16. El Error Cuadrático Medio (MSE) de una aproximación ŷ de
y se calcula como:
1 N
(ŷ − y)2
MSE(ŷ, y) =
N i∑
=1
Por tanto, queremos encontrar los parámetros que hagan mínima esta medida
del error, siendo esta nuestra función objetivo.
Para estimar estos parámetros, scipy nos ofrece varias funciones que podemos usar. Se han probado dos alternativas, minimize y curve_fit, ambas de
scipy.optimize.
Debido a la simplicidad, rapidez y resultar más intuitiva para su utilización,
finalmente se ha optado por usar curve_fit en lugar de minimize.
curve_fit usa el método de mínimos cuadrados no lineales para ajustar la

función dada a los datos, y con el argumento method='lm', se usa el algoritmo de Levenberg-Marquardt en mínimos cuadrados. Pero dado que este
algoritmo solo admite problemas sin restricciones, no se usará, pues todos
los parámetros en los modelos epidemiológicos están sujetos a restricciones.

17

18

herramientas básicas

Para su utilización, se define una función con el modelo para el ajuste, que
será el primer argumento de curve_fit. En nuestro caso esta función será un
modelo epidemiológico. Su segundo argumento serán los datos x o independientes, en el caso de modelos epidemiológicos será el tiempo, también los
datos y, que en nuestro caso serán el número de infectados, y finalmente como último parámetro se pueden proporcionar restricciones de los intervalos
a los que pertenecen los parámetros buscados.
La función devuelve los parámetros optimizados, a partir de los cuales obtenemos ŷ y podemos calcular el error de forma explícita y la covarianza
estimada de los parámetros optimizados.
popt, pcov = curve_fit(modeloSI, tiempo, I, bounds=((0, 0), (np.inf, N)))

3
MODELOS DISCRETOS EN EPIDEMIOLOGÍA

3.1

modelos discretos

En este capítulo estudiaremos los principales modelos epidemiológicos discretos.
En un modelo discreto el tiempo se considera que toma valores discretos,
siendo estos 1, 2, 3..., expresado en horas, días, semanas...
Para realizar este capítulo se ha usado principalmente la referencia [1].

3.2

modelo si

El modelo SI es el modelo más simple de todos. Los individuos nacen siendo
susceptibles a una enfermedad, y una vez infectados permanecen infectados
el resto de su vida. Un ejemplo de una enfermedad que pueda modelarse
usando SI es el herpes.
Para n ≥ 0 las siguientes ecuaciones describen el modelo SI discreto:


S n +1
In+1


α∆t
= Sn 1 −
In
N


α∆t
Sn
= In 1 +
N

(7)

donde Sn indica el número de individuos susceptibles en el instante tn , e In
hace referencia al número de individuos infectados en ese instante. ∆t es el

19

20

modelos discretos en epidemiología

tiempo transcurrido entre dos instantes tn+1 − tn , y N es el tamaño total de
la población, con condiciones iniciales S0 > 0, I0 > 0 y S0 + I0 = N.
En estas ecuaciones α es la tasa de contacto; es decir, el número medio de
individuos con los que un infectado tiene suficiente contacto para contagiarlo
en un intervalo de tiempo. Por tanto, Sn representa el número de individuos
susceptibles en el tiempo n∆t.
Además, cabe destacar que a partir de (7) podemos obtener la ecuación logística. Usando Sn + In = N tenemos

In+1 = In


α∆t
1+
( N − In ) ,
N

equivalentemente


In+1
In+1
α∆t
In+1
N (1 + α∆t)
luego, tomando Xn =
obtenemos:


α∆t
= In 1 + α∆t −
In ⇔
N


α∆t
In ⇔
= In (1 + α∆t) 1 −
N (1 + α∆t)


α∆t
α∆t
=
In (1 + α∆t) 1 −
In
N (1 + α∆t)
N (1 + α∆t)
α∆t
I
N (1+α∆t) n

(8)

y renombrando en la expresión anterior,

Xn+1 = (1 + α∆t) Xn (1 − Xn ).
Que se corresponde con la expresión de la ecuación logística tomando µ =
1 + α∆t.
Pasaremos a imponer las suposiciones descritas anteriormente para estos modelos. En primer lugar, suponemos que la población se mezcla de manera
homogénea de ahora en adelante. Para imponer la segunda suposición, la población total se mantiene constante, siendo trivial que se cumpla siempre, ya
que sumando el sistema de ecuaciones el resultado es N y asumimos que las
soluciones son siempre positivas dado que las soluciones negativas no tienen
sentido, ya que sería hablar de un número negativo de individuos, ya sean
infectados, recuperados o susceptibles de contraer la enfermedad.

3.2 modelo si

Proposición 7. Las soluciones de las ecuaciones (7) son positivas si y solo si α∆t ≤
1.
Demostración. Supongamos que In , Sn > 0. Por la segunda ecuación del
modelo (7) es claro que In+1 > 0, pues Sn > 0 y 1 + α∆t
N > 0.
Para la primera ecuación tenemos que Sn+1 > 0 si y solo si
1−

α∆t
In > 0,
N

ya que Sn es positivo por hipótesis. Esto equivale a N > α∆tIn , y puesto que
Sn + In = N se tiene:
N > α∆t( N − Sn ),
esto es
α∆tSn > (α∆t − 1) N.
Como α∆tSn > 0, tenemos entonces que la desigualdad se da para todo n si
y solo si:
α∆t − 1 ≤ 0 ⇔ α∆t ≤ 1.

Lema 1. Sn es monótonamente decreciente e In es monótonamente creciente.
Demostración. Sn+1 es Sn multiplicado por un valor menor que 1, mientras
que In+1 corresponde a In multiplicado por un valor mayor que 1.
Buscamos ahora ver cual es el comportamiento del sistema, calculando los
puntos de equilibrio; esto es, las soluciones constantes en el tiempo, resolviendo:

α∆t ∗
S = S 1−
I
N


α∆t ∗
∗
∗
I = I 1+
S
N
∗

∗



S∗ + I ∗ = N

21

modelos discretos en epidemiología

Figura 3: Gráfica del modelo SI discreto, en una población total de 100 individuos,
con valores iniciales S0 = 99, I0 = 1, α = 0,1, T0 = 0, T = 100.

100
80
Datos

22

60

Susceptibles
Infectados

40
20
0

0

20

40

tiempo

60

80

100

Los únicos puntos de equilibrio posibles son: (S∗ , I ∗ ) = (0, N ) y (S∗ , I ∗ ) =
( N, 0). Puesto que las condiciones iniciales son positivas y como Sn es monótonamente decreciente e In es monótonamente creciente, así Sn+1 < Sn y
In+1 > In para cualquier n ∈ N, entonces debe converger a (S∗ , I ∗ ) = (0, N ),
pues son sucesiones monótonas acotadas.
En la figura 4, se representa el número de individuos infectados en función
del número de susceptibles se aprecia una relación lineal pero inversamente
proporcional, donde al subir el número de infectados baja el de susceptibles
y al contrario.

3.3

modelo sir

El modelo SIR comienza como el SI, pero tras infectarse los individuos pasan
a un estado Recuperado, en el cual no pueden volver a infectarse ni infectar
a otros. Un ejemplo de este tipo de enfermedad es la varicela.

3.3 modelo sir

Figura 4: Gráfica del modelo SI, representando el número de infectados según el número de individuos susceptibles, en una población total de 100 individuos,
con valores iniciales S0 = 99, I0 = 1, α = 0,1, T0 = 0, T = 100.

–QIHFWDGRV

0RGHOR 6–

6XVFHSWLEOHV

El modelo es el siguiente:

S n +1 = S n

In+1 = In

α∆t
1−
In
N



α∆t
1 − γ∆t +
Sn
N



(9)

Rn+1 = Rn + γ∆tIn
con condiciones iniciales S0 > 0, I0 > 0, R0 ≥ 0, satisfaciendo S0 + I0 + R0 =
N.
En estas ecuaciones, de nuevo tenemos que α es la tasa de contacto, esto es, el
número medio de individuos con los que un infectado tiene suficiente contacto para contagiarlo en un intervalo de tiempo, y γ es la probabilidad de que
un infectado pase a recuperado/retirado/aislado/fallecido en un intervalo
de tiempo, con α > 0 y γ > 0.
Se supone que la población permanece constante, esto es: Sn + In + Rn = N.

23

24

modelos discretos en epidemiología

Proposición 8. Las soluciones a este sistema discreto son positivas para cualquier
valor de las condiciones iniciales si, y solo si:

máx γ∆t, α∆t ≤ 1
o equivalentemente:

mı́n

1 1
,
γ α



≥ ∆t

Demostración. Comenzamos probando una de las implicaciones, suponien
do que máx γ∆t, α∆t ≤ 1.
Por hipótesis inicial, tenemos que S0 , I0 > 0, R0 ≥ 0 y S0 + I0 + R0 = N, luego
es suficiente comprobar que:
1−
Lo cual es evidente, pues

In
N

α∆t
I0 > 0.
N

< 1 por hipótesis del modelo y α∆t < 1.

Por un razonamiento análogo, como γ∆t < 1, tenemos que
1 − γ∆t +

α∆t
S0 > 0.
N

Y finalmente
R0 + γ∆tI0 > 0
pues γ > 0 y ∆t > 0.
Aplicando un razonamiento por inducción, suponiéndolo para n se puede
demostrar que Sn+1 , In+1 , Rn+1 son siempre positivas.
Para probar el recíproco basta probar que ambas cantidades son menores o
iguales a 1. Comenzamos trabajando en la primera ecuación (9).

S n +1 = S n

α∆t
1−
In
N



3.3 modelo sir

Por hipótesis Sn , Sn+1 > 0, entonces 1 − α∆t
N In > 0. Usamos de nuevo que
In ≤ N luego:
α∆t
0 < 1−
In ≤ 1 − α∆t,
N
y por tanto:
α∆t ≤ 1.
Puesto que α∆t ≤ 1 y In ≤ N, n ≥ 0, entonces Sn+1 < Sn para cualquier
n ≥ 0, luego es una sucesión estrictamente decreciente. Por otro lado, In es
siempre positiva, por tanto
1 − γ∆t +

α∆t
Sn > 0
N

n ≥ 0,

y Sn estrictamente decreciente, por tanto 1 − γ∆t ≥ 0.
Luego, despejando tenemos γ∆t ≤ 1.
De la última ecuación no sacamos ninguna condición más, pues su solución
es siempre positiva por definición de γ y ∆t.

Lema 2. Sn es estrictamente decreciente y Rn es estrictamentre creciente.
Demostración.
Por el Lema 1 de [1], se tiene que lı́mn→∞ Sn = S∞ > 0, cuyo límite existe,
pues es una sucesión estrictamente decreciente y acotada inferiormente por
0.
Estudiamos las condiciones iniciales. Si S0 ≤ γN
α , y, como Sn es estrictamente
decreciente, tenemos que In+1 ≤ In , es decir, no hay epidemia, ya que la
velocidad de propagación no es lo bastante alta.
Nγ
En otro caso, tenemos S0 > γN
α , entonces I1 > I0 . Debe ocurrir que S∞ < α ,
pues si no fuera así, tendríamos que In crece hacia un equilibrio, I∞ , lo que
implica que Rn se aproxima a infinito cuando n → ∞, lo que no es posible, pues el total de la población es constante. Así, el número de infectados
finalmente comienza a decrecer.

25

modelos discretos en epidemiología

Figura 5: Gráfica del modelo SIR, en una población total de 100 individuos, con valores iniciales S0 = 99, I0 = 1, R0 = 0, α = 0,1, γ = 0,01, T0 = 0, T = 300.

100
80
Datos

26

60

Susceptibles
Infectados
Recuperados

40
20
0
0

50

100

150
tiempo

200

250

300

Por tanto, a partir del resultado anterior podemos deducir que el intervalo
de tiempo, ∆t, debe ser menor que el tiempo medio requerido para contagiar
a otro individuo susceptible, α, y menor que el período medio infeccioso, γ.
El comportamiento global del sistema es fácil de ver. Definimos el número
básico reproductivo como la constante

RSIR =

S0 α
.
Nγ

El valor de RSIR determina el comportamiento global del modelo. En particular, si RSIR < 1 se considera que no hay epidemia.
En otros trabajos como [5] este número básico reproductivo se llama tasa de
transmisión media.
En la figura 6 se representan el número de infectados y los individuos susceptibles. En este modelo, al contrario de lo que ocurría en el modelo SI no son

3.3 modelo sir

Figura 6: Gráfica del modelo SIR, representando el número de infectados según el
número de individuos susceptibles, en una población total de 100 individuos, con valores iniciales S0 = 99, I0 = 1, α = 0,1, γ = 0,01, T0 = 0, T =
300.

–QIHFWDGRV

0RGHOR 6–5 – 6

6XVFHSWLEOHV

cantidades inversamente proporcionales. Vemos que primero los infectados
crecen muy rápidamente y después decaen más lentamente, esto es porque
las personas susceptibles se infectan, pero después aunque los individuos
susceptibles sigan disminuyendo los infectados bajan, esto es debido a que
los individuos previamente infectados se están recuperando.
Estudiamos ahora la figura 7, en la que se muestra como varían los individuos
recuperados en función de los susceptibles.
A medida que los individuos susceptibles crecen los recuperados disminuyen,
en particular se ve un decrecimiento exponencial. Esto se debe a que los individuos susceptibles primero deben infectarse y luego recuperarse, y, como
ya hemos visto en la figura 6 los infectados bajan muy rápidamente cuando
las personas susceptibles son pocas, por ello los recuperados también crecen
rápidamente a menor número de individuos susceptibles.
Finalmente, en la figura 8 se muestran los individuos recuperados en función
de los infectados, en una gráfica implícita del tiempo.

27

modelos discretos en epidemiología

Figura 7: Gráfica del modelo SIR discreto, representando el número de recuperados
según el número de individuos susceptibles, en una población total de 100
individuos, con valores iniciales S0 = 99, I0 = 1, α = 0,1, γ = 0,01, T0 =
0, T = 300.
0RGHOR 6–5 5 6

5HFXSHUDGRV

28

6XVFHSWLEOHV

3.4 modelo sis

Figura 8: Gráfica del modelo SIR discreto, representando el número de recuperados
según el número de individuos infectados, en una población total de 100
individuos, con valores iniciales S0 = 99, I0 = 1, α = 0,1, γ = 0,01, T0 =
0, T = 300.

5HFXSHUDGRV

0RGHOR 6–5 5 –

–QIHFWDGRV

Un aspecto a tener en cuenta es la distancia entre las marcas en la curva.
Cada marca indica la medida del número de infectados y recuperados en un
mismo tiempo t.
Al comenzar el número de recuperados es bajo y crece despacio a medida que
aumentan los infectados. Llega un punto máximo del número de infectados,
en el que se produce la curva, y cuando los infectados comienzan a descrecer
los recuperados aumentan rápidamente, lo que se puede ver por la distancia
más corta que hay entre las marcas de la curva.

3.4

modelo sis

El modelo SIS es similar al SI, con la salvedad de que los individuos son susceptibles a múltiples reinfecciones. Por ejemplo, los resfriados pueden modelarse usando SIS.
El modelo es una perturbación del modelo SI descrito anteriormente. Se define de la siguiente forma:

29

30

modelos discretos en epidemiología





+ γ∆tIn


α∆t
= In 1 − γ∆t +
Sn
N

S n +1 = S n
In+1

α∆t
In
1−
N

(10)

con condiciones iniciales positivas S0 > 0, I0 > 0 cumpliendo S0 + I0 = N.
Por lo tanto, el tamaño de la población es constante.
En estas ecuaciones, α de nuevo representa la tasa de contacto, esto es, el número medio de individuos con los que un infectado tiene suficiente contacto
para contagiarlo en un intervalo de tiempo, y γ es la probabilidad de que
un infectado pase a recuperado/retirado/aislado en un intervalo de tiempo,
donde se cumple α > 0 y γ > 0.
Proposición 9. Las soluciones de (10) siempre son positivas si, y solo si:

γ∆t ≤ 1
y


α∆t < 1 +

p

2
γ∆t

Demostración. Sea I0 = e y S0 = N − e, entonces por la definición del modelo
tenemos:


N−e
I1 = e 1 − γ∆t + α∆t
N
2
α∆te
(11)
=−
+ e(1 − γ∆t + α∆t)
N
= p(e)
Luego tenemos que ver cuándo la parábola satisface 0 < p(e) < N para
0 < e < N.
Notemos que p(0) = 0 y p( N ) = N (1 − γ∆t).
Sea (e∗ , p∗ ) el vértice de la parábola, entonces
∗

∗

(e , p ) =



N (1 − γ∆t + α∆t) N (1 − γ∆t + α∆t)2
,
2α∆t
4α∆t


.

3.4 modelo sis

Por tanto, 0 < p(e) < N para 0 < e < N si y solo si:

γ∆t ≤ 1,
y por tanto, o bien e∗ ≥ N, que es equivalente a α∆t ≤ 1 − γ∆t, o bien e∗ <
N y p∗ < N, lo que requiere que α∆t > 1 − γ∆t y (1 − γ∆t + α∆t)2 < 4α∆t.
Estas desigualdades se dan si y solo si:

2
p
1 − γ∆t < α∆t < 1 + γ∆t .

En el modelo SIS, el número básico reproductivo se define como

RSIS =

α
.
γ

Lema 3. Los puntos de equilibrio de (10) son o bien (S∗ , I ∗ ) = ( N, 0), o bien
Nγ
(S∗ , I ∗ ) = ( Nγ
α , N − α ).
Demostración. Consideramos los puntos de equilibrio (S∗ , I ∗ ) cumpliendo
(10) y satisfaciendo S∗ + I ∗ = N.
Por tanto, resolvemos el sistema:

∗



α∆t ∗
1−
I
N



+ γ∆tI ∗


α∆t ∗
∗
∗
I = I 1 − γ∆t +
S
N

S =S

∗

de donde se tiene:

∗

I =I

∗



α∆t ∗
1 − γ∆t +
S
N



⇔

Distinguimos por tanto dos posibles casos:

α∆t ∗ ∗
S I = γ∆tI ∗
N

(12)

31

32

modelos discretos en epidemiología

O bien, si I ∗ = 0 se da la igualdad, y, dado que S∗ + I ∗ = N tenemos que
S∗ = N. Un primer punto de equilibrio sería por tanto (S∗ , I ∗ ) = ( N, 0).
∗
O bien I ∗ 6= 0, luego se tiene que S = Nγ
α , y por tanto I = N −
Nγ
de equilibrio por tanto sería (S∗ , I ∗ ) = ( Nγ
α , N − α ).

Nγ
α .

El punto

Lema 4. Si RSIS ≤ 1 entonces se tiene que In+1 < In , ya que 0 < Sn < N y las
soluciones son positivas. En este caso es fácil ver que el límite, al ser una sucesión
monótona decreciente y acotada inferiormente, es (S∗ , I ∗ ) = ( N, 0).
Si RSIS > 1 las soluciones convergen si se cumple la condición α∆t ≤ 2 + γ∆t.
Demostración. Supongamos que S∗ < N, entonces existen n1 , e tales que
para todo n ≥ n1 :
Sn < S ∗ + e < N
y usando las ecuaciones (10)

In+1 = In

α∆t
Sn
1 − γ∆t +
N



≤ In (1 − γ∆t + α∆t)

(13)

= In ρ
donde hemos denotado ρ = 1 − γ∆t + α∆t.
Como ρ < 1 tendríamos que I ∗ = 0, lo que contradice que S∗ < N.
Si RSIS > 1 realizando la sustitución Sn = N − In y el cambio
xn =

α∆tIn
,
N (1 + α∆t − γ∆t)

tenemos:
α∆tIn = xn N (1 + α∆t − γ∆t) ⇔
In = xn

N (1 + α∆t − γ∆t)
α∆t

(14)

3.5 modelos multipoblacionales

entonces sustituyendo en la ecuación (10):

N (1 − α∆t − γ∆t)
=
α∆t



N (1 + α∆t − γ∆t)
α∆t
N (1 + α∆t − γ∆t)
xn
1 − γ∆t +
N − xn
α∆t
N
α∆t
x n +1

(15)

Despejando de esta expresión:

x n +1 = x n

α∆t
α∆t N (1 + α∆t − γ∆t)
1 − γ∆t +
N−
xn
N
N
α∆t



= xn (1 − γ∆t + α∆t − xn (1 + α∆t − γ∆t))

(16)

= xn ((1 − γ∆t + α∆t)(1 − xn ))

luego obtenemos la ecuación logística con parámetro µ = 1 − γ∆t + α∆t
xn+1 = (1 − γ∆t + α∆t) xn (1 − xn ).
En el modelo SIS la restricción necesaria para garantizar soluciones positivas
no es suficiente para asegurar la convergencia. En este caso a dicha restricción
hay que añadir la condición α∆t ≤ 2 + γ∆t, restricción del parámetro de la
ecuación logística para la convergencia, como vimos en el capítulo 1.

En la figura (10) se representa el número de infectados en función del número
de individuos susceptibles. Se puede ver que son inversamente proporcionales, es decir, a mayor número de infectados menos individuos susceptibles
hay y al revés.
Cabe destacar el parecido de esta gráfica con su análoga del modelo SI (4).

3.5

modelos multipoblacionales

Los modelos multipoblacionales agrupan la población en varias subpoblaciones. En estas subpoblaciones, los individuos pertenecientes a una misma

33

modelos discretos en epidemiología

Figura 9: Gráfica del modelo SIS, en una población total de 100 individuos, con valores iniciales S0 = 95, I0 = 5, α = 0,1, γ = 0,01, T0 = 0, T = 150.
0RGHOR 6–6

6XVFHSWLEOHV

6XVFHSWLEOHV –QIHFWDGRV

–QIHFWDGRV

7LHPSR

Figura 10: Gráfica del modelo SIS discreto, representando el número de infectados
según el número de individuos susceptibles, en una población total de 100
individuos, con valores iniciales S0 = 95, I0 = 5, α = 0,1, γ = 0,01, T0 =
0, T = 200.
0RGHOR 6–6

–QIHFWDGRV

34

6XVFHSWLEOHV

3.5 modelos multipoblacionales

subpoblación interactúan entre ellos, y, al mismo tiempo, interactúan las distintas subpoblaciones entre ellas.
De esta forma, se obtiene un modelo más realista, pues no se asume que
todos los individuos interactúan igual con todos los demás individuos de la
población, si no que se relacionan formando grupos más pequeños que a su
vez interactúan entre ellos.

3.5.1

Modelo SI

El modelo SI discreto multipoblacional muestra el mismo comportamiento
monótono que el modelo SI discreto. Este modelo permite agrupar la población en varias subpoblaciones que se relacionan entre ellas, a la vez que los
individuos de cada una de ellas interactúan, permitiendo así obtener datos
más realistas. Se considera el modelo SI con k subpoblaciones:

Sni

α ∆t
1 − ∑ ik i Ink
N
k =1
K

Sni +1

=

Ini +1

α ∆t
= Ini + Sni ∑ ik i Ink
N
k =1
K

!
(17)

donde i = 1, · · · , K y con las condiciones iniciales S0i > 0 y I0i ≥ 0 para todo
valor de i, existiendo algún k cumpliendo I0k > 0. Y además, para todo i debe
satisfacerse S0i + I0i = N i , siendo N i el tamaño de la i-ésima subpoblación.
Asimismo, αik es la tasa de contacto en la subpoblación i-ésima, es decir, el
número medio de contactos por unidad de tiempo de un grupo infeccioso k
con individuos del grupo i.
Como en el caso discreto ya estudiado, el tamaño de cada subpoblación se
mantiene constante, Sni + Ini = N i .
Proposición 10. Las soluciones del sistema (17) son no negativas para cualquieras
condiciones iniciales si, y solo si,
(
máx
i

αik ∆tN k
∑ Ni
k =1
K

)

≤1

35

36

modelos discretos en epidemiología

Proposición 11. Cada Sni es estrictamente monótonamente decreciente para cada i
y se aproxima a 0, mientras Ini es monótonamente creciente y se aproxima a N i .
3.5.2 Modelo SIR
El modelo SIR discreto multipoblacional muestra el mismo comportamiento
monótono que el modelo SIR discreto. Se considera el modelo SIR con K
subpoblaciones:
α ∆t
1 − ∑ ik i Ink
N
k =1
K

Sni +1 = Sni

Ini +1 = Ini (1 − γi ∆t) + Sni

!

αik ∆t k
I
Ni n
k =1
K

∑

(18)

Rin+1 = Rin + γi ∆tIni
donde i = 1, · · · , K y con las condiciones iniciales S0i > 0, R0i ≥ 0 y I0i ≥ 0
para todo valor de i, existiendo algún k cumpliendo I0k > 0. Y además, para
todo i debe satisfacerse S0i + I0i + R0i = N, siendo N i el tamaño de la i-ésima
subpoblación. Asimismo, αik es la tasa de contacto en la subpoblación i-ésima,
es decir, el número medio de contactos por unidad de tiempo de un grupo
infeccioso k con individuos del grupo i y γi es la probabilidad de que un
infectado pase a recuperado/retirado/aislado/fallecido en un intervalo de
tiempo.
Como en el caso discreto ya estudiado, el tamaño de cada subpoblación se
mantiene constante, Sni + Ini + Rin = N i .
Proposición 12. Las soluciones del sistema (18) son no negativas para cualquiera
condiciones iniciales si, y solo si,
(
máx
i

αik ∆tN k
∑ N i , γi ∆t
k =1
K

)

≤1

Proposición 13. Cada Sni es estrictamente monótonamente decreciente para cada
i, mientras Rin es monótonamente estrictamente creciente. Además, al estar ambas
acotadas, se obtiene que Ini se aproxima a 0 en el límite n → ∞.

3.5 modelos multipoblacionales

En el modelo multipoblacional no es tan simple determinar si ocurre una
epidemia en una subpoblación como en el modelo con una sola población.
Consideramos

RiSIR =

S0i αii
.
γi N i

Si RiSIR > 1 entonces el número de infectados en la i-ésima población comenzará a crecer. Sin embargo, si RiSIR ≤ 1 no es suficiente para garantizar
que no se producirá una epidemia en la población i-esima, ya que las otras
poblaciones influyen también en esta.
En lugar de considerar las subpoblaciones independientemente unas de otras,
se debe tener en cuenta el total de infectados:
K

In =

∑ Ini .

i =1
Si α
∑iK=1 γ0 Niki
k



Si α
∑iK=1 γ0 Niki
k




Si máxk

Si mı́nk

≤ 1 entonces In decrece y no hay una epidemia.
> 1 entonces In crece y hay una epidemia.

Como hemos visto, no se puede definir de manera sencilla un número básico
reproductivo.

3.5.3

Modelo SIS

El modelo SIS discreto multipoblacional muestra el mismo comportamiento
que el modelo SIS discreto. Se considera el modelo SIS con K subpoblaciones:

Sni +1 = Sni
Ini +1

αik ∆t k
I
Ni n
k =1
K

1−

∑

!

+ γi ∆tIni

α ∆t
= Ini (1 − γi ∆t) + Sni ∑ ik i Ink
N
k =1
K

(19)

donde i = 1, · · · , K, y con las condiciones iniciales S0i > 0 y I0i ≥ 0 para todo
valor de i, existiendo algún k cumpliendo I0k > 0. Y además, para todo i debe
satisfacerse S0i + I0i = N i , siendo N i el tamaño de la i-ésima subpoblación.

37

38

modelos discretos en epidemiología

Asimismo, αik es la tasa de contacto en la subpoblación i-ésima, es decir, el
número medio de contactos por unidad de tiempo de un grupo infeccioso k
con individuos del grupo i, y γi es la probabilidad de que un infectado pase
a susceptible de nuevo en un intervalo de tiempo.
Como en el caso discreto ya estudiado, el tamaño de cada subpoblación se
mantiene constante, Sni + Ini = N i .
Proposición 14. Las soluciones del sistema (19) son no negativas para cualquieras
condiciones iniciales si, y solo si,
(
máx
i

∑

k 6 =i

αik

∆tN k
Ni

)
, γi ∆t

≤ 1,

v
2
u
k
p
u
α ∆tN
αii ∆t ≤ t1 − ∑ ik i
+ γi ∆t
N
k 6 =i

4
MODELOS CONTINUOS EN EPIDEMIOLOGÍA

Los modelos continuos, al igual que los discretos, tratan de describir la evolución y desarrollo de una enfermedad a lo largo del tiempo. La diferencia con
los modelos discretos es que, al contrario que en estos, el tiempo se supone
continuo.
Mientras en los modelos discretos consideramos un ∆t que hace referencia
a los incrementos del tiempo entre dos valores consecutivos de la cantidad
de individuos de cada estado, en los modelos continuos el tiempo se supone
continuo, y por tanto no se trabaja con una cantidad numerable de valores.

4.1

tipos de modelos

Al igual que los modelos discretos, los modelos continuos (principalmente SI,
SIR y SIS) usan los estados Susceptible, Infectado y Recuperado. Los nombres
suelen hacer referencia al flujo que se sigue para pasar entre los estados. Así,
por ejemplo un modelo SI pasa de susceptible a infectado, uno SIR de susceptible a infectado y recuperado y SIS alterna entre susceptible e infectado.
En estos modelos se hacen dos suposiciones:
1. La población se mezcla de manera homogénea, es decir, todos los individuos tienen la misma probabilidad de contraer la enfermedad.
2. El total de la población es constante y lo denotaremos por N.
En este capítulo estudiaremos los principales modelos epidemiológicos continuos análogos a los estudiados en el capítulo anterior.

39

40

modelos continuos en epidemiología

4.2

modelo si continuo

Expresando α como una tasa podemos obtener las ecuaciones diferenciales
análogas de la siguiente manera. Considerando
S n +1 − S n
≈ S 0 ( t ),
∆t
El análogo continuo al sistema (7) viene dado por:
S0 (t) = −

α
SI
N

α
I (t) = SI
N
0

(20)

con condiciones iniciales S(0) + I (0) = N.
De (20) se puede ver que I 0 > 0 y S0 < 0, luego ambas funciones son estrictamente monótonas, al igual que el modelo discreto.
Calculamos los puntos de equilibrio de manera análoga al caso discreto, es
decir, suponemos que las funciones son constantes y, resolviendo el sistema
de ecuaciones, podemos comprobar que las soluciones convergen a (S∗ , I ∗ ) =
(0, N ) y, por tanto, tienen el mismo comportamiento que en el caso discreto.
Sustituyendo en el modelo S = N − I obtenemos la ecuación diferencial logística continua

I0 =

α
N ( N − I ).
I

Esta ecuación diferencial se puede resolver por separación de variables como
sigue:

4.2 modelo si continuo

Figura 11: Gráfica del modelo SI continuo, en una población total de 100 individuos,
con valores iniciales S(0) = 99, I (0) = 1, α = 0,1, T0 = 0, T = 100.

α
I = I(N − I) ⇔
N
0

⇔
⇔
⇔
⇔

dI
α
=
dt
I(N − I)
N

Z 
1
1
α
1
+
dI = t + c
N
I
N−I
N
1
I
α
log
= t+c
N
N−I
N
I
= Aeαt
N−I
I = Aeαt ( N − I )

Z

Z

(21)

⇔ I (1 + Aeαt ) = Aeαt N
⇔ I (t) =

Aeαt N
1 + Aeαt

Usando el valor inicial I (0) = I0 tenemos:

I0 = I (0) =

AN
⇔ (1 + A) I0 = AN
1+A
⇔ A( N − I0 ) = I0
I0
⇔A=
N − I0

(22)

41

42

modelos continuos en epidemiología

luego la solución general es:

I (t) =

I0 eαt N
I0 N
=
.
αt
( N − I0 ) + I0 e
( N − I0 )e−αt + I0

Es claro que I tiende monótonamente a N, luego tiene el mismo comportamiento que el modelo discreto.
En (11) tenemos la representación gráfica del comportamiento del modelo SI
continuo. Podemos comprobar que su comportamiento es análogo al modelo
discreto. También es claro que se cumple que I es siempre creciente y tiende
a N, mientras S es decreciente y tiende a 0.

4.3

modelo sis continuo

El modelo continuo correspondiente al modelo SIS se comporta de la misma
forma que el modelo discreto, y viene expresado por:
α
S0 (t) = − SI + γI

N
α
0
S−γ
I (t) = I
N

(23)

donde S(0) + I (0) = N.
Si RSIS ≤ 1 entonces no ocurre una epidemia, y si RSIS > 1 entonces hay
una epidemia.
En (12) comprobamos al igual que hicimos antes que su comportamiento es
análogo al modelo discreto. También se observa que al igual que en el modelo
SI el número de individuos susceptibles es decreciente y tendiente a 0 y el de
infectados creciente y tiende a N, pero esto no siempre es así y se debe a los
parámetros usados.
Por ejemplo, en (13) vemos como variando solamente γ el modelo se comporta de forma muy diferente, pues los susceptibles e infectados parecen
estabilizarse en torno a la mitad de la población.

4.3 modelo sis continuo

Figura 12: Gráfica del modelo SIS continuo, en una población total de 100 individuos,
con valores iniciales S(0) = 95, I (0) = 5, α = 0,1, γ = 0,01, T0 = 0, T =
150.

Figura 13: Gráfica del modelo SIS continuo, en una población total de 100 individuos,
con valores iniciales S(0) = 95, I (0) = 5, α = 0,1, γ = 0,05, T0 = 0, T =
150.

43

44

modelos continuos en epidemiología

Figura 14: Gráfica del modelo SIS continuo, en una población total de 100 individuos,
con valores iniciales S(0) = 95, I (0) = 5, α = 0,1, γ = 0,2, T0 = 0, T = 150.

Por otro lado, si γ > α entonces tenemos que no se produce una epidemia,
pues los infectados tienden a 0 y los susceptibles a N, como puede verse en
(14).

4.4

modelo sir continuo

El modelo continuo correspondiente al modelo SIR se comporta de la misma
forma que el modelo discreto, y viene expresado por:
α
S0 (t) = − SI

N
α
0
I (t) = I
S−γ
N
R0 (t) =γI

(24)

donde S(0) + I (0) + R(0) = N. El número básico reproductivo en este caso
se define como
S (0) α
RSIR =
,
Nγ
y si como hemos visto RSIR ≤ 1 se dice que no hay epidemia, pero en cambio,
si es mayor, se dice que sí la hay.

4.5 modelo kermack-mckendrick

Figura 15: Gráfica del modelo SIR continuo, en una población total de 100 individuos, con valores iniciales S(0) = 99, I (0) = 1, α = 0,1, γ = 0,01, T0 =
0, T = 300.

En (15) observamos el comportamiento del modelo SIR representado. Al igual
que en su análogo discreto, el número de individuos susceptibles siempre
decreciente y el de recuperados siempre creciente.

4.5

modelo kermack-mckendrick

La información para el desarrollo de esta sección se ha obtenido principalmente de [3].
El modelo de Kermack-McKendrick es un modelo sencillo basado en suposiciones simples en el flujo de la población de unos grupos a otros según su
estado respecto a la enfermedad. Estos grupos son susceptibles, infectados y
recuperados, inmunizados o fallecidos.
Este modelo es, por tanto, una modificación del modelo SIR ya estudiado. La
diferencia con el modelo SIR ya estudiado es que en este modelo se supone
que un individuo infectado hace contacto suficiente para contagiar la enfermedad con αN individuos por unidad de tiempo, mientras en el modelo SIR
se supone que α es el número medio de individuos con los que un infectado

45

46

modelos continuos en epidemiología

Figura 16: Esquema del modelo de Kermack-McKendrick y modelo SIR

tiene suficiente contacto para contagiarlo en una unidad de tiempo. Por tanto,
en este apartado y para hacer notar esta diferencia usaremos ᾱ en lugar de α.
El modelo se describe como:
S0 = −ᾱSI

I 0 = ᾱSI − γI

(25)

R0 = γI

Las suposiciones en las que se basa el modelo descrito son:
Un individuo hace contacto suficiente para contagiar la enfermedad con
ᾱN individuos por unidad de tiempo, sienod N el total de la población.
Los infectados pasan a recuperados, inmunizados o fallecidos con la
tasa γI por unidad de tiempo.
La población total es constante, no hay incorporaciones ni salidas.
No se consideran fallecimientos como grupo aparte, así la población es
constante.
De acuerdo con la primera suposición, dado que la probabilidad de que aleaS
toriamente el contacto de un infectado sea con un individuo susceptible es N
,
αNS
el número de nuevos infectados por unidad de tiempo por infectado es N ,
dando lugar a una tasa de nuevos infectados de ᾱNSI
= ᾱSI. Notemos que
N
ambas aproximaciones dan lugar a la misma tasa de nuevos infectados.
Observemos también que, al igual que en el modelo SIR, se cumple N =
S + I + R.
Para la tercera suposición consideramos el grupo de individuos que fueron
infectados en un mismo momento, y sea u(s) el conjunto de estos que aún
son infecciosos s unidades de tiempo después de haber sido infectados. Si

4.5 modelo kermack-mckendrick

una porción γ de estos deja de pertenecer a la clase de individuos infectados
por unidad de tiempo, entonces

u0 = −γu,
y la solución de esta ecuación diferencial es

u(s) = u(0)e−γs .
Por tanto, la fracción de infectados que siguen estando en la clase infectados
s unidades de tiempo después de haberse convertido en infectados es e−γs ,
luego la duración del período infeccioso se distribuye según una exponencial,
con significado
Z
∞

0

e−γs ds = 1/γ,

y esto es lo que la segunda suposición realmente significa. Si en lugar de
suponer esto, suponemos que la fracción de infectados que permanecen infectados en un tiempo τ después de haberse infectado es P(τ ), la segunda
ecuación de (25) se reemplaza por:

I (t) = I0 (t) +

Z ∞
0

ᾱS(t − τ ) I (t − τ ) P(τ )dτ,

donde I0 (t) hace referencia a los miembros de la población que eran infectados en el instante inicial y siguen siendo infecciosos en el momento t.
Las suposiciones de que la tasa de contactos es proporcional al tamaño de
la población N con una constante de proporcionalidad constante ᾱ y de una
distribución exponencial de tasa de recuperación son demasiado simples para
ser realistas. Existen otros modelos más generales que se pueden analizar,
pero finalmente muchos modelos más realistas muestran comportamientos
similares a estos modelos más simples.
En nuestro modelo (25), R se determina una vez que se conocen S e I, pero podemos eliminar la tercera ecuación del modelo, dejando este formado
solamente por dos ecuaciones:

47

48

modelos continuos en epidemiología

S0 = −ᾱSI,

I 0 = (ᾱS − γ) I,

(26)

junto con las condiciones iniciales:
S ( 0 ) = S0 ,

I (0) = I0 ,

S0 + I0 = N.

El modelo solo tiene sentido si S(t) e I (t) se mantienen no negativos, luego
si alguno de los dos llega a 0, consideramos que el estudio ha terminado.
Lema 5. Dado el modelo (26), se tiene que S0 < 0 para todo t, y además I 0 > 0 si, y
solo si, S > γᾱ .
Es decir, I aumenta mientras se cumpla que S > γᾱ , pero como S decrece para
todo t, finalmente se tiene que S < γᾱ , y por tanto I deja de aumentar.
Si S0 < γᾱ , entonces I decrece a 0 y no hay una epidemia, mientras que si
S0 > γᾱ , I comienza creciendo hasta el máximo obtenido cuando S = γᾱ y
luego decrece hasta 0, en cuyo caso hay una epidemia.
Definimos el número básico reproductivo como:

RKMK =

ᾱS0
.
γ

De esta manera, si RKMK < 1 no hay una epidemia, mientras si RKMK > 1
hay una epidemia.

4.6

análisis de los parámetros de los modelos

4.6.1 Introducción
Estimar la tasa de transmisión media es uno de los aspectos más cruciales en
epidemiología. Esta tasa condiciona la fase de la epidemia e incluso si va a
extinguirse. Es combinación de tres factores:
1. Coeficiente de virulencia: Relacionado con el agente infeccioso.

4.6 análisis de los parámetros de los modelos

2. Coeficiente de susceptibilidad: Relacionado con el anfitrión.
3. Número de contactos por unidad de tiempo entre individuos.
Los dos primeros factores se tienen en cuenta a la vez en la probabilidad de
transmisión.
Todos los factores pueden cambiar con el tiempo. El primero, debido a mutaciones del virus y los dos últimos por medidas de contención. Por tanto,
observar el decrecimiento de la transmisión media en una enfermedad es
una buena forma de comprobar la efectividad de las medidas de contención.
En el artículo [5] se presenta un modelo SI modificado con el objetivo de
compararlo con los datos obtenidos en la pandemia de la COVID-19 en China
hasta el momento, y así tratar de predecir su comportamiento en el futuro.
El modelo SI continuo considerado es el siguiente:
S0 (t) = − τ (t)S(t) I (t)

I 0 (t) =τ (t)S(t) I (t) − vI (t)

(27)

donde S(t) es el número de individuos susceptibles , I (t) el número de individuos infectados en el tiempo t y τ (t) la tasa de transmisión, que combina el
número de contactos por unidad de tiempo y la probabilidad de transmisión.
Observemos que τ (t) se considera variable respecto al tiempo, al contrario
que en el caso SI clásico estudiado antes. Además, notemos que v es una
constante, donde 1/v es la duración media del período de infección, y vI (t)
el flujo de individuos recuperados o fallecidos.
Se consideran las condiciones iniciales

S(t0 ) = S0 > 0, I (t0 ) = I0 > 0.
Ahora, consideramos que al final del período infeccioso nos han informado
de una fracción del total de casos, en este caso la fracción la denotamos por
f ∈ (0, 1]. Sea CR (t) el número total acumulado de casos reportados. Entonces:

49

50

modelos continuos en epidemiología

CR (t) = CR0 + v f C I (t), ∀t ≥ t0

(28)

donde CR0 representa el número de casos reportados al inicio del estudio y

C I (t) =

Z t
t0

I (w)dw

siendo C I el número total de infectados acumulado.
Asumimos conocidos S0 > 0, 1/v > 0, f ∈ (0, 1]. Por tanto, queremos averiguar el número inicial de infectados I0 y la tasa de transmisión τ (t).
4.6.2 Aproximación de I0 y τ (t0 )
Siguiendo [5], procedemos a intentar aproximar I0 y τ (t0 ):
Al comienzo de la pandemia podemos suponer que S(t) y τ (t) son constantes
e iguales a S0 y τ0 = τ (t0 ), respectivamente. Sustituyendo estos valores en la
ecuación (27) obtenemos:

I 0 (t) = (τ0 S0 − v) I (t).
Resolviendo la ecuación diferencial llegamos a:

I (t) = I0 exp ((τ0 S0 − v)(t − t0 )).
Sustituyendo en (28):

CR (t) = CR0 + v f I0

e(τ0 S0 −v)(t−t0 ) − 1
.
τ0 S0 − v

De este modo, hemos obtenido un primer modelo para los casos acumulados
al principio de la pandemia.
Reescribimos la ecuación anterior como:

4.6 análisis de los parámetros de los modelos

CR ( t ) = χ 1 eχ2 t − χ 3 .

(29)

Estimamos χ3 usando los datos de la epidemia obtenidos, y el mejor ajuste
para los datos se obtiene con χ3 = 0.
Ahora, usando (28) y (29) tenemos:

I0 =

χ 1 χ 2 eχ2 t0
vf

(30)

Y, como sabemos que χ2 = τ0 S0 − v, entonces
τ0 =

χ2 + v
.
S0

(31)

Si suponemos τ (t) = τ0 constante, tenemos que el modelo queda:
S0 (t) = −τ0 S(t) I (t)

I 0 (t) = τ0 S(t) I (t) − vI (t)

(32)

Usando la ecuación de S(t) y resolviéndola obtenemos:

S(t) = S0 exp −τ0

Z t
t0


I (w)dw

= S0 exp (−τ0 C I (t))

Ahora, sustituyendo esta expresión en la ecuación de I (t) del modelo y usando C 0I (t) = I (t):
I 0 (t) = S0 exp (−τ0 C I (t))τ0 C 0I (t) − vI (t)
Finalmente, integrando entre t0 y t tenemos que:
I (t) = C 0I (t) = I0 + S0 (1 − exp (−τ0 C I (t))) − vC I (t).

51

52

modelos continuos en epidemiología

Observamos entonces que el número total acumulado de infectados es monótono creciente, ya que I (t) > 0 siempre por positividad de las soluciones
y C 0I (t) = I (t) > 0. Cabe destacar que esto no implica que el número de
infectados sea monótono creciente.
Teorema 2. Sea t > t0 fijo. El número de infectados acumulados es estrictamente
creciente respecto a las siguiente cantidades:
I0 > 0: Número inicial de infectados
S0 > 0: Número inicial de individuos susceptibles.
τ > 0: Tasa de transmisión
1/v: Tiempo medio de la infección.
4.6.3 Fórmula teórica para τ (t)
Usando la ecuación del modelo inicial (27) obtenemos:

S(t) = S0 exp −

Z t
t0


τ (w) I (w)dw

Ahora, sustituyendo en la ecuación (27):


0

I (t) = S0 exp −

Z t
t0


τ (w) I (w)dw τ (t) I (t) − vI (t)

Integramos en ambos lados entre t0 y t, luego:
C 0I (t)





= I0 + S0 1 − exp −

Z t
t0


τ (w) I (w)dw

− vC I (t)

Equivalentemente, por (28):

CR0 (t)



= vf


I0 + S0



1
1 − exp −
vf

Z t
t0

τ (w)CR0 (w)dw



+ vCR0 − vCR (t)

Así, obtenemos el Teorema 3.1 de [5], que nos da la relación directa buscada.

5
D E S A R R O L L O D E L S O F T WA R E : A N Á L I S I S Y D I S E Ñ O

5.1

objetivos y análisis de requisitos

Los objetivos que se persiguen al realizar este proyecto son realizar un estudio de distintos modelos de epidemiología. Se pretende comprender cómo
afectan sus parámetros y condiciones iniciales a la evolución en el tiempo de
estos modelos desde un punto de vista tanto teórico como práctico, apoyándonos en distintas gráficas interactivas para ilustrar dichos comportamientos.
Asimismo, se va a analizar la bondad de ajustes de parámetros de algunos
de los modelos presentados aplicados a datos reales comprobando cuáles
proporcionan mejores resultados en cada caso. Con el fin de satisfacer todos
estos objetivos, se ha extraído la siguiente lista de requisitos:
Requisitos funcionales
• RF1: Se debe poder modificar los parámetros de las gráficas de los
distintos modelos.
• RF2: El usuario debe poder elegir con qué modelo quiere trabajar.
• RF3: El sistema debe permitir descargar las imágenes de las gráficas obtenidas.
• RF4: El sistema debe poder cargar y leer ficheros de datos.
• RF5: Se debe visualizar el ajuste obtenido mediante gráficas.
• RF6: Para cada ajuste realizado se obtendrá los valores estimados
de los parámetros y los errores.
• RF7: El sistema debe ser capaz de seleccionar qué modelo se ajusta
mejor a los datos.
Requisitos no funcionales

53

54

desarrollo del software: análisis y diseño

Figura 17: Modelo en espiral.

Determinar objetivos

Análisis del riesgo

Planificación

Desarrollar y probar

• RNF1: No se podrán ajustar datos de más de un fichero a la vez.
• RNF2: Las gráficas deben actualizarse en tiempo real.
• RNF3: Se mostrará información de ayuda, en caso de ser necesaria.
• RNF4: Se debe poder usar desde el navegador.
Requisitos de información
• RI1: Los ficheros de datos con los que se va a trabajar deben ser
formato csv con una estructura específica, dependiente de cada
modelo.

5.2

desarrollo del proyecto

Actualmente hay diversas metodologías de desarrollo del software. Cada uno
de estos modelos consta de una serie de etapas en las que se ha dividido el
desarrollo. Para este proyecto, se ha optado por el modelo en espiral. En
este modelo el software se desarrolla de forma incremental, es decir, se van
añadiendo funcionalidades y mejoras al software según se van evaluando las
que ya tiene. Cada bucle o iteración representa un conjunto de actividades.
Estas actividades no están fijadas a ninguna prioridad, sino que las siguientes
se eligen en función del análisis de riesgo, comenzando por el bucle interior,
como se describe en la figura (17).
Se ha elegido este método de desarrollo ya que se consigue un desarrollo muy
estable, pues toda funcionalidad añadida al software es probada y evaluada.

5.3 gestión de recursos

De esta forma, aunque el proyecto no esté completo, siempre se tiene una
parte funcional, y se va incrementando de forma que siempre disponemos de
un producto mínimamente viable.

5.3

gestión de recursos

Los proyectos que se pueden realizar dependen en gran medida de los recursos que se pueden destinar a ellos. Se requieren unos elementos mínimos que
son indispensables para poder llevarlo a cabo. Por ello, es muy importante
contar con los recursos necesarios y gestionarlos de manera adecuada.

5.3.1

Recursos humanos

El proyecto consta de un equipo de 3 personas para llevarlo a cabo:
Ana Buendía Ruiz-Azuaga, se encarga de:
• Planificación y análisis del proyecto.
• Búsqueda de bibliografía.
• Diseño e implementación del proyecto.
• Pruebas para el correcto funcionamiento del proyecto.
• Redacción de la documentación del proyecto.
Tutores: Manuel Pegalajar Cuéllar y Teresa E. Pérez, encargados de:
• Idea original del proyecto.
• Proporcionar bibliografía.
• Guiar para la redacción de la memoria y documentación.
• Supervisar el desarrollo del proyecto.

5.3.2

Recursos hardware

Todo el proyecto se va a desarrollar en un ordenador portátil con todo el
software y dependencias necesarias. Las especificaciones del portátil son:
Modelo: Acer Aspire E-5 574G.
CPU: Intel Core i5-6200U.
RAM 8GB RAM DDR3.
Disco duro: 1TB.

55

56

desarrollo del software: análisis y diseño

Precio: 600€.
5.3.3 Recursos software
El proyecto se ha llevado a cabo usando como sistema operativo Ubuntu 20.04
LTS, y se ha usado como lenguaje principal Python.
El software necesario para el proyecto es el siguiente:
Flask. Flask es un microframework web en python. Proporciona funcionalidad básica para, de forma sencilla, crear una aplicación web. Una
posible alternativa habría sido Django, pero finalmente se ha optado por
Flask debido a su simplicidad, legibilidad y que en este proyecto no se
requieren muchas de las funcionalidades que Django ofrece integradas.
Dash. Dash es un framework opensource basado en plotly.js y react.js
que permite crear fácilmente aplicaciones basadas en datos. En este proyecto se ha usado principalmente por su capacidad de crear gráficas
interactivas en tiempo real.
VSCode. Se ha usado VSCode como editor de texto, ya que proporciona una gran cantidad de plugins para cualquier lenguaje, así como
integración con git.
Draw.io. Para la realización de diagramas de distintas clases, se ha usado el software de dibujo gratuito Draw.io.
Docker. Con el fin de simplificar el lanzamiento y ejecución de la aplicación web desarrollada se ha usado docker para virtualizar el entorno
y evitar la necesidad de instalar en cualquier máquina el software necesario para ejecutarla.
Git. Se ha empleado Git como controlador de versiones, integrado con
Github.
Texmaker. Para redactar la memoria, se ha usado el editor de LaTeX
Texmaker.
Todo el software utilizado ha sido gratuito, por lo que no ha tenido coste
alguno.

5.4 planificación temporal

5.3.4

Estimación del coste

A partir de los recursos previamente listados, se va a realizar una aproximación del coste de la consecución del proyecto, considerando que la duración
del mismo es de 9 meses.
Para los recursos humanos, dado que se considera que la alumna ha trabajado aproximadamente 450 horas de acuerdo a los créditos correspondientes
asignados al TFG, y el gasto aproximado es 15€/h en calidad de alumna de
prácticas, se tiene que el coste es de 6.750,00€.
A los tutores, dada su formación profesional se les supone un coste estimado
de 50€/h, y aproximando que se dedican 3 horas semanales para la tutorización del proyecto, se tiene que el coste total tras los 9 meses es de 5.400,00€
por tutor.
Dado que el portátil empleado tiene una vida útil estimada de 5 años, le
corresponde un coste de 120,00€ durante la realización del proyecto.
Finalmente, dado que todo el software empleado es gratuito, el coste aproximado del proyecto aparece desglosado en la tabla (1).

5.4

planificación temporal

Para la realización del proyecto se han distinguido distintas etapas, y en cada
una de ellas se ha implementado y trabajado sobre una funcionalidad concreta, de acuerdo al modelo en espiral. Las distintas partes del proyecto han
sido:
T1. Estudio de bibliografía y estado actual de la epidemiología. Se han
consultado diversos libros, artículos y páginas de interés con el fin de
comprender mejor y obtener los recursos necesarios para la realización
del proyecto. Además, se ha realizado una selección de los modelos a
estudiar y tratar durante el desarrollo del mismo.
T2. Especificación de requisitos. En base a la información obtenida del
proyecto, en esta etapa se han especificado los requisitos que el software
debe cumplir.

57

58

desarrollo del software: análisis y diseño

Cuadro 1: Desglose de presupuesto del proyecto.

Recursos humanos

Coste (€)

Alumna
Tutor 1
Tutor 2
Suma
Recursos hardware

6.750,00
5.400,00
5.400,00
17.550,00
Coste (€)

Ordenador portátil
Suma
Recursos software
Flask
Dash
VSCode
TexMaker
Suma

120,00
120,00
Coste (€)
0,00
0,00
0,00
0,00
0,00

Suma total

17.670,00

Gastos indirectos (18 %)

3.180,60

Total

20.850,60

IVA (21 %)

4.378,63

Coste final

25.229,23

T3. Diseño del sistema. A partir de los requisitos especificados, se ha
diseñado la arquitectura del sistema y cómo será la interfaz con la que
van a interactuar los usuarios.
T4. Marco teórico. Se han indicado conceptos y modelos, así como estudiado las características de estos con el fin de desarrollar la teoría
necesaria para trabajar con modelos epidemiológicos. Asimismo, se ha
indicado el contexto en el que la epidemiología es de gran utilidad.
T5. Implementación de los modelos discretos. Se ha realizado la implementación de los modelos discretos SI, SIR y SIS, incluyendo gráficas
interactivas de los mismos.
T6. Implementación de los modelos continuos. Se ha realizado la implementación de los modelos continuos SI, SIR y SIS, incluyendo gráficas interactivas de los mismos, al igual que información teórica.

5.5 diagrama conceptual

T7. Ajuste de datos a diversos modelos. Se ha implementado una funcionalidad para realizar un ajuste de parámetros de acuerdo a un modelo a elegir, o el sistema puede determinar cuál es el modelo que minimiza el error para unos datos dados.
T8. Documentación del proyecto. Se ha llevado a cabo la documentación del proyecto durante todo su desarrollo.
Con el fin de ayudar a hacer más fácil la comprensión de cómo se ha distribuido el tiempo del proyecto, se ha realizado el diagrama (18) en el que
se puede ver cuánto tiempo se ha dedicado a cada etapa del desarrollo del
proyecto durante los 10 meses de duración del mismo.

Figura 18: Planificación temporal de las etapas del proyecto.

5.5

diagrama conceptual

Para el modelado conceptual de la aplicación web, se ha optado por utilizar OOWS (Object-Oriented approach for Web Solutions modelling), que usa
modelado de objetos UML y modelos de navegación y presentación usando UML. Así, se expresan las características navegacionales de la aplicación
web a la vez que se integra con las restantes vistas del esquema conceptual
mediante una notación UML adaptada.

59

60

desarrollo del software: análisis y diseño

En (19), se muestra el diagrama conceptual, construido mediante una estrategia top-down:

Figura 19: Modelo conceptual de la aplicación web.

En (20) se muestra el detalle del contexto de Home, en (21) se ve el detalle de Modelos Interactivos, así como en (22) el de Ayuda y en (23) el de
Ajuste de datos.

Figura 20: Modelo conceptual del contexto de Inicio.

5.6 casos de uso

Figura 21: Modelo conceptual del contexto de Modelos Interactivos.

Figura 22: Modelo conceptual del contexto de Ayuda.

5.6

casos de uso

A partir de los requisitos listados anteriormente, se obtienen los siguientes
casos de uso:

61

62

desarrollo del software: análisis y diseño

Figura 23: Modelo conceptual del contexto de Ajuste de Datos.

CU-1: Modificar parámetro de un modelo.
CU-2: Preprocesar entrada.
CU-3: Subir fichero de datos.
CU-4: Leer fichero de datos.
CU-5: Actualizar gráfica.
CU-6: Seleccionar modelo de ajuste.
CU-7: Realizar ajuste de datos.
CU-8: Descargar gráfica.
5.6.1 Actores del sistema

Actor
Descripción
Características
Relaciones
Referencias
Autor

Usuario
A-1
Representa el usuario estándar que va a usar la página web.
Interactúa con la aplicación web de forma directa.
Interviene en los casos de uso CU-1, CU-3 y CU-6.
Ana Fecha 25/04/22 Versión
1.0

5.6 casos de uso

5.6.2

Diagrama de casos de uso

Se incluye también el diagrama de los casos de uso, con el fin de ilustrar todos
los posibles casos de uso, así como sus relaciones entre ellos. El diagrama
resultante puede verse en (24).
Figura 24: Diagrama de casos de uso

63

64

desarrollo del software: análisis y diseño

5.6.3 Plantillas de casos de uso
Caso de uso
Actores
Tipo
Referencias
Precondición
Postcondición
Autor

Modificar parámetro de un modelo
CU-1
Usuario
Esencial
RF1
CU-2, CU-5
Se debe estar trabajando con un modelo.
Se debe preprocesar la entrada.
Ana
Fecha 25/04/22
Versión
1.0

Propósito
Modificar uno de los parámetros disponibles del modelo para ver cómo
afecta al comportamiento del mismo.
Resumen
Se modifica uno de los parámetros posibles del modelo, modificando así
su comportamiento y visualizando la nueva gráfica resultante.
Curso normal
El usuario modifica un
parámetro
2.
3.

1.

2a.
3a.

Incluir CU-2
Incluir CU-5

Cursos alternos
El formato no es correcto, se asigna un valor por defecto
Incluir CU-5

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Vital
Finalizado

Urgencia
Estabilidad
-

Alto
Alta
Alta

5.6 casos de uso

Caso de uso
Actores
Tipo
Referencias
Precondición
Postcondición
Autor

Preprocesar entrada

CU-2

(Sistema)
Esencial
RF-1
CU-1
Se debe haber modificado un parámetro del modelo.
Se debe actualizar la gráfica.
Ana
Fecha 25/04/22
Versión
1.0

Propósito
Asegurar el correcto formato y validez del valor introducido.
Resumen
Se comprueba la validez y formato del valor introducido para asegurar el
correcto funcionamiento del modelo.
Curso normal
1.
Se comprueba el tipo de valor
(float o entero).
2.
Se comprueba el rango de
validez de los valors de cada
parámetro.
3. Se comprueba que la población
sea constante.

1a
2b.

Cursos alternos
Si el valor no es de un tipo válido se sustituye por 0.
Si el valor no está en el rango se sustituye por 0.

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Vital
Finalizado

Urgencia
Estabilidad
-

Alto
Alta
Alta

65

66

desarrollo del software: análisis y diseño

Caso de uso
Actores
Tipo
Referencias
Precondición
Postcondición
Autor

Subir fichero de datos

RF4

Ana

CU-3

Usuario
Esencial
CU-4, CU-5, CU-6, CU-7
Fecha 25/04/22
Versión

1.0

Propósito
El usuario debe poder subir un fichero de datos para trabajar sobre él.
Resumen
El usuario sube un fichero de datos.
Curso normal
El usuario selecciona un fichero
de datos.
2.
El sistema sube el fichero de
datos seleccionado.

1.

2a.

Cursos alternos
El fichero no tiene formato correcto, por lo que no se deja
seleccionarlo.

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Vital
Finalizado

Urgencia
Estabilidad
-

Alto
Alta
Alta

5.6 casos de uso

Caso de uso
Actores
Tipo
Referencias
Precondición
Postcondición
Autor

Leer fichero de datos

CU-4

(Sistema)
Esencial
RF4
CU-3, CU-7
Se debe haber subido el fichero a leer.
Se debe actualizar la gráfica.
Ana
Fecha 25/04/22
Versión

1.0

Propósito
Leer el fichero para poder trabajar con los datos que contiene.
Resumen
Se lee el fichero de datos cargando estos en memoria.
Curso normal
1.
2.

2a.

Se abre el fichero
Se lee el fichero

Cursos alternos
Si el formato del fichero no es el esperado, se muestra un error.

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Vital
Finalizado

Urgencia
Estabilidad
-

Alto
Alta
Alta

67

68

desarrollo del software: análisis y diseño

Caso de uso
Actores
Tipo
Referencias
Precondición
Postcondición
Autor

Actualizar gráficas

CU-5

(Sistema)
Esencial
RF1, RF2, RF5
CU-1, CU-6
Se ha modificado un parámetro o ajuste seleccionado.
La gráfica se ha actualizado.
Ana
Fecha 25/04/22
Versión
1.0

Propósito
Actualizar la gráfica para tener la visualización de los datos de acuerdo a
las opciones indicadas.
Resumen
Actualizar la gráfica cuando el usuario realiza una modificación de
parámetros o del modelo con el que realizar el ajuste.
Curso normal
1.
Incluir CU-4
2.
Representar los datos con el
nuevo parámetro.

2a.
3a.

Cursos alternos
Si se ha cambiado el modelo con el que realizar el ajuste, incluir
CU-7.
Representar los datos con el nuevo ajuste.

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Vital
Finalizado

Urgencia
Estabilidad
-

Medio
Alta
Alta

5.6 casos de uso

Caso de uso
Actores
Tipo
Referencias
Precondición
Postcondición
Autor

Seleccionar modelo de ajuste
CU-6
Usuario
Esencial
RF2
CU-5, CU-7
Se debe tener leído un fichero de datos.
Se debe realizar el ajuste con el nuevo modelo elegido.
Ana
Fecha 25/04/22
Versión
1.0

Propósito
Poder elegir el modelo con el que realizar el ajuste de los datos.
Resumen
Seleccionar el modelo a partir del cuál se va a realizar el ajuste.

1.

Curso normal
El usuario selecciona un
modelo
2.
3.

Incluir CU-7
Incluir CU-5

Cursos alternos
-

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Alta
Finalizado

Urgencia
Estabilidad
-

Alto
Alta
Alta

69

70

desarrollo del software: análisis y diseño

Caso de uso
Actores
Tipo
Referencias
Precondición
Postcondición
Autor

Realizar ajuste de datos

CU-7

(Sistema)
Esencial
RF6, RF7
CU-3, CU-4, CU-5, CU-6
Se debe haber leído un fichero y seleccionado un modelo.
Actualizar las gráficas
Ana
Fecha 25/04/22
Versión
1.0

Propósito
Obtener una estimación de los parámetros y los errores correspondientes
de acuerdo al modelo seleccionado.
Resumen
Se realiza el ajuste de un modelo elegido a los datos leídos.
Curso normal
Incluir CU-6

1.

2.
3.
4.

2a.
3a.
4a.

Estimar parámetros
Calcular errores
Incluir CU-5

Cursos alternos
Si se debe elegir el mejor modelo, se calculan los parámetros para
todos los modelos
Se calculan los errores para todos los modelos
Se elige el mejor modelo de acuerdo a un criterio sobre los errores

Frecuencia
esperada
Importancia
Estado
Comentarios

Otros datos
Alta
Rendimiento
Vital
Finalizado

Urgencia
Estabilidad
-

Alto
Alta
Alta

5.6 casos de uso

Caso de uso
Actores
Tipo
Referencias
Precondición
Postcondición
Autor

Descargar gráfica

CU-8
Usuario
Secundario

RF3

Ana

Fecha

25/04/22

Versión

1.0

Propósito
Descargar una gráfica generada por la aplicación web.
Resumen
Se descarga la imagen de una gráfica generada.
Curso normal
Pulsa en descargar imagen
2. Muestra el selector de archivos
Selecciona dónde guardar el
archivo
4. Se genera y descarga la imagen

1.
3.

3a.

Frecuencia
esperada
Importancia
Estado
Comentarios

Cursos alternos
El usuario cancela la descarga.
Otros datos
Baja
Rendimiento
Baja
Finalizado

Urgencia
Estabilidad
-

Alto
Baja
Alta

71

72

desarrollo del software: análisis y diseño

5.7

diagramas de actividad

Para facilitar la comprensión del funcionamiento de las distintas funcionalidades del sistema, se han realizado diagramas de actividad de sus funcionalidades más importantes, siendo estas la posible modificación de los parámetros
de los modelos interactivos y el ajuste de datos subidos mediante un fichero
de datos.
El diagrama de actividad correspondiente a la modificación de parámetros
en los modelos se muestra en (25) y el del ajuste de parámetros se puede ver
en (26).
Figura 25: Diagrama de actividad de la modificación de parámetros en un modelo.

5.8 pruebas

Figura 26: Diagrama de actividad del ajuste de datos.

5.8

pruebas

A medida que se desarrollaba el proyecto, se han llevado a cabo diversas
pruebas de las distintas funcionalidades que se han desarrollado incremen-

73

74

desarrollo del software: análisis y diseño

talmente, con el fin de garantizar en todo momento que se disponía de un
producto mínimamente viable.
Se han llevado a cabo dos tipos de pruebas:
Pruebas unitarias: Tienen como objetivo asegurar el correcto funcionamiento de las funciones creadas de forma independiente de las demás.
Pruebas de usuario: Tratan de simular la interacción entre un usuario
y la interfaz del proyecto.
5.8.1 Pruebas unitarias
Preprocesamiento de valores de parámetros. Se ha probado a introducir diversos valores para los parámetros modificables en los modelos
interactivos, con el fin de asegurarnos de que se preprocesan adecuadamente. El comportamiento esperado es sustituir el valor introducido
por 0 en caso de que este sea un carácter o un valor negativo.
Correcta generación de datos para diversos modelos. Se han representado gráficamente los datos generados por las funciones de los modelos
y contrastando el comportamiento de los datos obtenidos con el descrito en la teoría, asegurando así la correcta generación de los datos de
acuerdo a los diversos modelos.
Subida de ficheros. Se ha probado a subir ficheros con extensiones permitidas (csv y txt) y comprobado que se han copiado al directorio pertinente para disponer de los ficheros cuando se requiera, así como a
subir ficheros con extensiones no permitidas, verificando que se muestra el error pertinente al no permitirse.
5.8.2 Pruebas de usuario
Prueba de población constante. Si el usuario introduce valores para las
condiciones iniciales (S0 , I0 y R0 si es pertinente) tal que su suma no sea
N se actualiza el valor de la población de forma que S0 + I0 + R0 = N.
Formato de los valores para parámetros. Si el usuario introduce un
valor de un parámetro con formato incorrecto se sustituye por 0.

5.9 diseño de la interfaz de usuario

Condiciones iniciales son números enteros. Si el usuario introduce un
valor no entero positivo se toma como valor real la parte entera del
valor introducido por el usuario.
Subida de fichero inexistente. Si se trata de subir un fichero al que
no se puede acceder o no selecciona ningún fichero antes de pulsar en
subir fichero se muestra el error pertinente.
Interacción con las gráficas. Los usuarios pueden hacer zoom, desplazarse y obtener el valor numérico de las representaciones gráficas en
cada momento en tiempo real, así como descargar las gráficas generadas.

5.9

diseño de la interfaz de usuario

Para finalizar el diseño del proyecto, hemos realizado unos prototipos del aspecto aproximado que tendrá la interfaz de la página web en algunas de sus
páginas. Se ha tratado de conseguir una interfaz sencilla e intuitiva, que permita al usuario una navegación clara y eficaz por la página web, resultando
así cómoda desde el primer momento.
Los prototipos de la interfaz se muestran en las figuras (27), (28), (29), (30) y
(31).

5.10

5.10.1

manual de usuario
Descripción del proyecto

El proyecto consiste en una página web de objetivo didáctico a la par que
práctico, en la que se ofrece información sobre diversos modelos básicos de
epidemiología de forma sencilla y clara a cualquier usuario.
De esta forma, el usuario puede aprender sobre varios modelos de epidemiología comprobando interactivamente el comportamiento de estos modelos en
tiempo real, y cómo afectan los parámetros de cada uno de ellos a la evolución de los mismos.
Además, se pueden subir ficheros con datos, ya sean generados por el propio
usuario o datos reales recogidos y comprobar el resultado de ajustar estos

75

76

desarrollo del software: análisis y diseño

Figura 27: Prototipo de la página home.

Figura 28: Prototipo de la página home, con desplegable mostrándose.

5.10 manual de usuario

Figura 29: Prototipo de la página de un modelo interactivo.

Figura 30: Prototipo de la página de ajuste de datos subidos desde un fichero.

77

78

desarrollo del software: análisis y diseño

Figura 31: Prototipo de la página de ayuda.

datos a los modelos mencionados, así como elegir el mejor modelo que ajusta
a dichos datos.
Para acceder a la página web el usuario solo requiere de un dispositivo con
un navegador de internet mediante el que acceder a la web, introduciendo la
url correspondiente.

5.10.2

Comenzando a usar la web

Una vez introducida la url de la web en el navegador, aparecemos en la
página principal de esta, la cual puede verse en (??).
Desde esta página podemos acceder a todas las funcionalidades e información de la web desde la barra de navegación y el menú lateral.
Además, la página principal es accesible en cualquier momento. Para volver
a ella basta clicar en el logo de la esquina superior izquierda o el nombre de
la página situado a su lado.
Asimismo, en la barra de navegación, situado al lado del título de la página
encontramos el enlace a la ayuda de la misma. En esta página encontramos

5.10 manual de usuario

Figura 32: Página home o principal de la web.

Figura 33: Página de ayuda, sección de preguntas frecuentes.

dos secciones: preguntas frecuentes, que puede verse en (33), y contacto, que
se muestra en (34), para recibir asistencia personalizada o sugerir mejoras a
la página web.
También puede accederse a la página de ayuda desde el menú lateral, clicando en ¿Cómo funciona? para mostrar las opciones del desplegable y luego en
ayuda. Aparte, en notación hay un resumen de la notación usada en toda la
página web, haciendo fácil consultarla en cualquier momento. El apartado de
notación se muestra en (35).

79

80

desarrollo del software: análisis y diseño

Figura 34: Página de ayuda, sección de contacto.

Figura 35: Página de notación.

5.10 manual de usuario

81

Figura 36: Desplegable de modelos discretos desplegado.

Finalmente, las distintas funcionalidades de la página se encuentran en el
menú lateral. Estas funcionalidades se explican a continuación.

5.10.3

5.10.3.1

Funcionalidades
Modificación de parámetros de los modelos interactivos

En el menú lateral encontramos dos menús desplegables, llamados Modelos discretos
y Modelos Continuos. Al pulsar sobre cualquiera de ellos se muestran tres enlaces, a los modelos SI, SIR y SIS, como se ve en (36). Al seleccionar cualquiera
de ellos llegamos a la página de dicho modelo.
En las páginas de los modelos podemos distinguir varias partes principales:
Al comienzo de la página de cada modelo se explica la teoría y ecuaciones correspondientes a dicho modelo. Por ejemplo, para el modelo SI
discreto se puede ver la explicación teórica en (37).
A continuación se muestran los parámetros del modelo, que el usuario
puede modificar con el fin de ver cómo varía el comportamiento del
modelo que se está estudiando. En el modelo SI por ejemplo se pueden
modificar los modelos que se ven en (38).
Finalmente, se muestran una serie de gráficas que ilustran el comportamiento del modelo con los parámetros dados. La primera es una fun-

82

desarrollo del software: análisis y diseño

Figura 37: Página del modelo SI, explicación teórica.

cion de cada grupo explícita grupo, se puede ver en (38), mientras el
resto son funciones implícitas del tiempo, se muestra en (39).

5.10.4

Ajuste de datos

También es posible subir un fichero en formato csv con datos para ajustar
con alguno de los modelos disponibles.
Es importante que el fichero a subir tenga como mínimo dos filas y tres
columnas llamadas t, S e I, siendo estas el tiempo, los individuos susceptibles
en ese tiempo y los individuos infectados en ese tiempo, respectivamente.
Adicionalmente, si fuera pertinente se podría tener una cuarta columna R
con los recuperados en ese tiempo.
Un ejemplo de un fichero válido sería fichero_ejemplo.csv conteniendo:
t,S,I,R
0,97.01665754023489,3.377399973205731,-3.816768927775707
1,102.24543170326915,3.341582397679812,-1.2931795115592053
2,104.19872670845312,6.0049071497214,-3.2175059735520164
3,99.79707480976897,10.796475445761393,0.6508408522616295
4,99.993286104437,3.8927305934099175,0.6722548513086043

5.10 manual de usuario

Figura 38: Página del modelo SI, campos para la modificación de parámetros y gráfica explícita del tiempo.

Figura 39: Página del modelo SI, gráfica implícita del tiempo.

83

84

desarrollo del software: análisis y diseño

Figura 40: Página de ajuste de datos. Subida de fichero.

Para subir el fichero en (40) seleccionamos Examinar, de forma que se abre el
navegador de archivos y podemos seleccionar nuestro fichero de datos. Una
vez seleccionado pulsamos Upload y cargamos el archivo.
Una vez cargado el fichero se nos muestra una gráfica con los datos del
fichero representados, como se ve en (41). A continuación, se muestra un
desplegable para elegir el modelo con el que se van a intentar ajustar los
datos. Las opciones de este son:
Modelo SI. Ajusta un modelo SI a los datos.
Modelo SIR. Ajusta un modelo SIR a los datos.
Modelo SIS. Ajusta un modelo SIS a los datos.
Mejor modelo. El sistema decide cuál es el modelo de los ya mencionados que mejor se ajusta a los datos en base a los errores obtenidos y lo
muestra. Realiza el ajuste con dicho modelo.
Además, se muestra una gráfica donde se representan los datos y el ajuste
obtenido. Este desplegable y la gráfica representando el ajuste se muestran
en (42).
Bajo ella, se pueden ver las estimaciones de los parámetros de acuerdo al
modelo seleccionado y los errores correspondientes. En caso de que la opción
para el ajuste haya sido Mejor modelo se muestra también el modelo elegido.
Estas estimaciones se ven en (43).

5.10 manual de usuario

Figura 41: Página de ajuste de datos. Gráfica de representación de los datos del fichero.

Figura 42: Página de ajuste de datos. Desplegable y gráfica con el ajuste.

Figura 43: Página de ajuste de datos. Estimaciones de parámetros y errores.

85

86

desarrollo del software: análisis y diseño

5.10.5

Instalación del backend

Para lanzar la página web de una manera cómoda, rápida y simple, se ha
creado un contenedor docker actualizado con todas las dependencias necesarias para el funcionamiento de la misma.
De esta manera, basta con ejecutar el contenedor docker, accesible en Dockerhub, descargarlo y ejecutarlo. El contenedor puede obtenerse en
https://hub.docker.com/repository/docker/mapachana/plotsir.
Para obtener y lanzar la imagen debe abrirse una terminal y ejecutar los
siguientes comandos:
docker pull mapachana/plotsir:latest
docker run -t -p 5000:5000 -p 8050:8050

mapachana/plotsir:latest

Tras esto accedemos a la url localhost:5000 en nuestro navegador.

5.11

datos reales

Una vez estudiados los modelos teóricos y terminada la implementación vamos a realizar el ajuste de varios modelos aplicado a datos reales de enfermedades. De esta forma, podemos comprobar si los modelos estudiados sirven
para ajustar los datos de algunas enfermedades, ayudando también así a la
comprensión del desarrollo de estas.

5.12

el vih en baleares

El VIH (Virus de Inmunodeficiencia Humana) es un virus que ataca al sistema inmunitario del cuerpo. Si no se trata, puede causar SIDA. Actualmente
no hay ninguna cura efectiva contra el VIH, por lo que una vez que se contrae,
se tiene de por vida.
El VIH provino de una especie de chimpancé de África, desde la que se propagó primero por dicho continente, y se estima que lleva en Estados Unidos
desde finales de los años 70.

5.12 el vih en baleares

Dado que es una enfermedad para la que una vez infectado no dejas de
tenerla, se tiene que sigue un modelo SI.
El conjunto de datos que se va a usar contiene los datos de los reportes de
nuevos infectados por VIH en Baleares desde 2003 hasta 2019 anualmente. La
fuente de dichos datos es [4].
En el informe se proporcionan los nuevos casos detectados, luego los datos
con los que vamos a trabajar son la suma acumulada de estos casos nuevos.
Esto se debe a que el modelo considera los casos activos, no solo los nuevos.
Por tanto, tenemos que los casos activos son los nuevos más todos los que
había antes.
Además, para que el modelo funcione bien el número total de individuos
consideramos es el número de individuos estudiados, en este caso N = 2704.
Teniendo esto en cuenta, generamos un fichero csv con el formato de la página web.
Primeramente, observamos la representación de los datos en (44). Vemos que
el número de individuos susceptibles va descendiendo, así como el de infectados creciendo en términos globales. Pese a esto, en ciertas partes de la gráfica
se aprecia una leve curvatura, donde los susceptibles pasan de ser cóncavos
a convexos y los infectados de convexo a cóncavo.
Elegimos como modelo de ajuste mejor modelo, donde obtenemos que el mejor modelo según el sistema es, como se comentaba inicialmente, el modelo
SI.
La representación gráfica del ajuste se puede ver en (45). En las curvas del
ajuste generado apreciamos con mayor claridad ese cambio de curvatura de
cóncavo a convexo y viceversa en el ajuste.
En (46) se muestra la estimación de los parámetros obtenidos para el ajuste,
resultando un α ≈ 0,31 e I0 ≈ 287. Dado que los valores de estos parámetros
son razonables y la representación gráfica del ajuste aproxima relativamente
bien los datos obtenidos, parece que las infecciones por VIH en Baleares en
efecto siguen un modelo SI.

87

88

desarrollo del software: análisis y diseño

Figura 44: Representación de los datos del VIH en Baleares.

Figura 45: Representación del ajuste con el modelo SI a los datos del VIH en Baleares.

5.13 el covid en españa

Figura 46: Estimaciones y errores del ajuste con el modelo SI a los datos del VIH en
Baleares.

5.13

el covid en españa

El covid es una enfermedad respiratoria aguda causada por el virus SARSCoV-2. Se informó respecto a ella por primera vez en Diciembre de 2019, tras
detectarse varios casos en Wuhan. Posteriormente se extendió a otros países,
entre los que se encuentra España.
A lo largo de la pandemia del covid en el mundo se han recopilado una gran
cantidad de datos para estudiar esta enfermedad. Para este estudio vamos a
usar el conjunto de datos obtenido de [6].
En [2] se comprueba que se puede modelar mediante el modelo SIR. Vamos
a tratar de ajustarla siguiendo este modelo.
En el fichero csv de los datos hay mucha información, pero realmente solo
vamos a usar las columnas new_cases, que indica los nuevos casos reportados
y new_deaths, que informa de las nuevas muertes.
Del fichero, nos quedamos con los datos de España y esas dos columnas, que
a continuación trataremos, ya que al igual que en el caso anterior, necesitamos
todos los casos activos y todos los recuperados hasta el momento.
Vamos a ajustar solo el principio de la pandemia, en concreto vamos a ajustar
a partir del día de 5 de Marzo de 2020, ya que en los 10 días anteriores no hay
datos reportados pese a que aparecen en los datos, y durante los siguientes
170 días, esto es, hasta el 21 de Agosto de 2020, pues es aproximadamente
6 meses, lo que se estima duró lo que se conoce coloquialmente como la
primera ola.

89

90

desarrollo del software: análisis y diseño

Por comodidad, vamos a tratar los datos como indexados en el tiempo, correspondiendo por tanto al 5 de Marzo el índice 0 y al 21 de Agosto el 170.
Es importante ajustar solamente una ola, pues el modelo SIR considera que
tras recuperarse, los individuos no vuelven a ser susceptibles ni a infectarse,
pero esto no es así en la realiidad. El modelo SIR ajusta solamente las olas de
forma independiente.
Para calcular el número de infectados activos, dado que el covid al principio
de la pandemia tenía una duración aproximada de 10 días, se han considerado todos los nuevos casos reportados desde 10 días atrás hasta ese día como
activos.
Asimismo, como recuperados se han considerados los fallecidos y los nuevos infectados de hace más de 10 días atrás, pues ya habrían superado la
enfermedad y no podrían volver a infectarse.
Además, para que el modelo funcione bien el número total de individuos
considerados es el número de individuos estudiados aproximadamente, en
este caso N = 40000.
Teniendo esto en cuenta, generamos un fichero csv con el formato necesario
para realizar un ajuste en la página web.
Al igual que antes, comenzamos observando la representación de los datos
en (47). El número de recuperados siempre es creciente, así como el de susceptibles es siempre decreciente. Llama la atención la forma de los infectados,
que primero suben y luego descienden, indicando así el final de la ola.
Elegimos como modelo de ajuste mejor modelo, donde obtenemos que el mejor modelo según el sistema es, como se comentaba inicialmente, el modelo
SIR.
La representación gráfica del ajuste se puede ver en (48). El ajuste parece
seguir las tendencias generales de los datos, aunque los infectados quedan
ligeramente por encima en el ajuste que en los datos experimentales, así como
los recuperados y susceptibles ajustan peor al final, pues cuanto más nos
alejamos de la ola en sí, peor es el ajuste al modelo SIR.

5.13 el covid en españa

Figura 47: Representación de los datos del covid en España desde el 5 de Marzo
hasta e 21 de Agosto de 2020.

Figura 48: Representación del ajuste con el modelo SIR a los datos del covid en España desde el 5 de Marzo hasta el 21 de Agosto de 2020.

91

92

desarrollo del software: análisis y diseño

Figura 49: Estimaciones y errores del ajuste con el modelo SIR a los datos del covid
en España.

En (49) se muestra la estimación de los parámetros obtenidos para el ajuste,
resultando un α ≈ 0,21, γ ≈ 0,08, I0 ≈ 1, R0 ≈ 536. Dado que los valores de
estos parámetros son razonables, salvo quizá por una estimación ligeramente
alta de los recuperados iniciales, y la representación gráfica del ajuste aproxima relativamente bien los datos obtenidos, parece que las infecciones por
covid en España en efecto siguen un modelo SIR.

6
CONCLUSIONES Y VÍAS FUTURAS

6.1

conclusiones

6.2

vías futuras

93

BIBLIOGRAFÍA

[1] Allen, L. J. (1994). Some discrete-time SI, SIR, and SIS epidemic models.
Mathematical biosciences, 124(1), 83–105.
[2] Amaro, J. E. (2022). Systematic description of covid-19 pandemic using
exact sir solutions and gumbel distributions.
URL https://arxiv.org/abs/2204.12550
[3] Brauer, F., & Castillo-Chavez, C. (2012). Mathematical Models in Population
Biology and Epidemiology, vol. 40 of Texts in Applied Mathematics. New York,
NY: Springer New York.
[4] de España, G. (2022-05-16).
URL
https://www.sanidad.gob.es/ciudadanos/enfLesiones/
enfTransmisibles/sida/vigilancia/Informe_VIH_SIDA_20201130.pdf

Informe vigilancia epidemiológica vih españa 2019.
[5] Demongeot, J., Griette, Q., & Magal, P. (2021). SI epidemic model applied
to COVID-19 data in mainland China. Royal Society Open Science, 7(12),
201878.
[6] owid (2022-05-16).
URL https://github.com/owid/covid-19-data/tree/master/public/
data/ Owid, covid-19 data.
[7] Salinelli, E., & Tomarelli, F. (2014). Discrete Dynamical Models, vol. 76 of
UNITEXT. Cham: Springer International Publishing.
[8] Strogatz, S. H. (1994). Nonlinear Dynamics and Chaos: With Applications
to Physics, Biology, Chemistry, and Engineering. Studies in Nonlinearity.
Reading, Mass: Addison-Wesley Pub.

94

