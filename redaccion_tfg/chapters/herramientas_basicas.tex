\chapter{Herramientas básicas}

\section{Tipos de modelos}

Los modelos discretos (por ejemplo SI, SIR y SIS) usan las etiquetas Susceptible, Infectado y Recuperado. Los nombres suelen hacer referencia al flujo que se sigue para pasar entre las etiquetas. Así, por ejemplo un modelo SI pasa de susceptible a infectado, uno SIR de susceptible, infectado y recuperado y SIS alterna entre susceptible e infectado.

En estos modelos se hacen dos suposiciones:
\begin{enumerate}
\item La población se mezcla de manera homogénea, es decir, todos los individuos tienen la misma probabilidad de contraer la enfermedad.
\item El total de la población es constante.
\end{enumerate}

\subsection{Modelo SI}
Es el modelo más simple de todos, los individuos nacen siendo susceptibles a una enfermedad, y una vez infectados no hay tratamiento y permanecen infectados el resto de su vida.
Un ejemplo de una enfermedad que pueda modelarse usando SI es el herpes.

\begin{equation}
\label{eqn: SI_S}
S_{n+1}=S_n\left( 1-\frac{\alpha\Delta t}{N}I_n\right)
\end{equation}

\begin{equation}
\label{eqn: SI_I}
I_{n+1}=I_n\left( 1+\frac{\alpha\Delta t}{N}S_n\right)
\end{equation}

Con condiciones iniciales $S_0>0$, $I_0>0$ y $S_0+I_0=N$.

En estas ecuaciones $\alpha$ es la tasa de contacto, esto es, el número medio de individuos con los que un infectado tiene suficiente contacto para contagiarlo en un intervalo de tiempo. Por tanto, $S_n$ representa el número de individuos susceptibles en el tiempo $n\Delta t$.

Ahora, imponemos las suposiciones descritas anteriormente para estos modelos. Empezamos por la segunda: La población total se mantiene constante, que es trivial que se cumpla siempre, ya que sumando el sistema de ecuaciones el resultado es $N$ y asumimos que las soluciones son siempre positivas (las soluciones negativas no tienen sentido).
Para imponer que las ecuaciones tienen soluciones positivas:
En el caso de la $S_n$ una condición necesaria y suficiente es $\alpha\Delta t \leq 1$. 

Buscamos ahora ver cuál es el comportamiento del sistema, si calculamos los puntos de equilibrio del sistema, para lo que resolvemos:

$$
\begin{cases}
S^*=S^*\left( 1-\frac{\alpha\Delta t}{N}I^*\right) \\
I^*=I^*\left( 1+\frac{\alpha\Delta t}{N}S^*\right) \\
S^*+I^*=N
\end{cases}
$$

Los únicos puntos de equilibrio posibles son: $S^*=0, I^*=N$ y $S^*=N, I^*=0$, y como sabemos que tenemos condiciones iniciales positivas y $S_n$ es monótonamente decreciente e $I_n$ es monótonamente creciente, entonces debe converger a $S^*=0, I^*=N$.

Expresando $\alpha$ como una tasa podemos obtener las ecuaciones diferenciales análogas de la sigueinte manera:

$$\frac{S_{n+1} - S_n}{\Delta t} \approx \frac{dS}{dt}$$

luego su análoga continua es:

\begin{equation}
\frac{dS}{dt} = -\frac{\alpha}{N}SI
\end{equation}


\begin{equation}
\frac{dI}{dt} = \frac{\alpha}{N}SI
\end{equation}

con condiciones iniciales $S(0)+I(0)=N$.

De manera análoga al caso discreto (es decir, suponiendo las funciones constantes y resolviendo el sistema de ecuaciones), podemos comprobar que este sistema converge a $S^*=0, I^*=N$ y, por tanto, tiene el mismo comportamiento que el caso discreto.

\textcolor{blue}{ESTO ES NUEVOO}

He programado el modelo discreto y el resultado de la gráfica ha sido:

\begin{figure}[H]
\begin{center}
\includegraphics[scale=1]{graficaSI}
\end{center}
\end{figure}


\subsection{Modelo SIS}
Es similar al SI, pero tras infectarse los individuos vuelven a ser susceptibles.
Por ejemplo, los resfriados pueden modelarse usando SIS.

\textcolor{blue}{ESTO ES NUEVO}

El modelo es el siguiente:

\begin{equation}
\label{eqn: modelo_SIS_S}
S_{n+1} = S_n \left(1-\frac{\alpha\Delta t}{N} I_n \right) + \gamma \Delta t I_n
\end{equation}

\begin{equation}
\label{eqn: modelo_SIS_I}
I_{n+1} = I_n \left( 1-\gamma \Delta t + \frac{\alpha\Delta t}{N} S_n \right)
\end{equation}

con condiciones iniciales positivas $S_0>0$, $I_0>0$ cumpliendo $S_0+I_0=N$. Por lo tanto, el tamaño de la población es constante.

En estas ecuaciones, tenemos que $\alpha$ es la tasa de contacto, esto es, el número medio de individuos con los que un infectado tiene suficiente contacto para contagiarlo en un intervalo de tiempo y $\gamma$ es la probabilidad de que un infectado pase a recuperado/retirado/aislado/fallecido en un intervalo de tiempo. Donde se cumple $\alpha >0$ y $\gamma >0$ siempre.

Además las soluciones son positivas siempre si, y solo si:

$\gamma \Delta t \leq 1$ y $\alpha\Delta t< \left( 1+\sqrt{\gamma \Delta t} \right)^2$

Esto se puede consultar en el Lema 2 del Apéndice de \cite{allenDiscretetimeSISIR1994}.

\textcolor{red}{No he comprobado las cuentas de esas condiciones}

La tasa reproductiva de este modelo es $\mathcal{R}=\alpha /\gamma$ \textcolor{red}{No entiendo como saca esa tasa reproductiva, a mi me sale la misma tasa reproductiva que en el caso del modelo SIR :(}

 

\subsection{Modelo SIR}
Comienza como el SI, pero tras infectarse los individuos pasan a un estado Recuperado, en el cuál no pueden infectarse ni infectar a otros.
Por ejemplo, la varicela. 

El modelo es el siguiente:

\begin{equation}
\label{eqn: SIR_modelo_S}
S_{n+1} = S_n \left(1-\frac{\alpha\Delta t}{N} I_n \right)
\end{equation}

\begin{equation}
\label{eqn: SIR_modelo_I}
I_{n+1} = I_n \left( 1-\gamma \Delta t + \frac{\alpha\Delta t}{N} S_n \right)
\end{equation}

\begin{equation}
\label{eqn: SIR_modelo_R}
R_{n+1} = R_n + \gamma \Delta t I_n
\end{equation}

con condiciones iniciales $S_0>0$, $I_0>0$, $R_0\geq 0$. Y satisfaciendo $S_0+I_0+R_0=N$.

En estas ecuaciones, tenemos que $\alpha$ es la tasa de contacto, esto es, el número medio de individuos con los que un infectado tiene suficiente contacto para contagiarlo en un intervalo de tiempo y $\gamma$ es la probabilidad de que un infectado pase a recuperado/retirado/aislado/fallecido en un intervalo de tiempo. Donde se cumple $\alpha >0$ y $\gamma >0$ siempre.

Es fácil comprobar que la población permanece constante, $S_n+I_n+R_n=N$.

Además, tenemos que las soluciones a este sistema discreto son positivas para cualquier valor de las condiciones iniciales si, y solo si:

$$\max{\big\{\gamma\Delta t, \alpha\Delta t\big\} } \leq 1$$

Equivalentemente:

$$\min{\bigg\{ \frac{1}{\gamma}, \frac{1}{\alpha} \bigg\} } \geq \Delta t$$

Por tanto, el intervalo de tiempo debe ser menor que el tiempo medio requerido para un contacto exitoso \textcolor{red}{Con contacto exitoso asumo que se refiere al tiempoe necesario para infectar a un individuo} y menor que el período medio infeccioso.

El comportamiento global del sistema es fácil de ver. Sea $\mathcal{R}=S_0 \alpha/(N\gamma )$ la tasa reproductiva. \textcolor{red}{¿Por qué $\mathcal{R}$ es justo eso?}. El valor de $\mathcal{R}$ determina el comportamiento global del modelo. \textcolor{red}{(a esto después lo llamo tasa de transmisión media en el artículo \cite{demongeotSIEpidemicModel})}. 

Notemos que $S_n$ es estrictamente decreciente y $R_n$ es estrictamente creciente.

Sea $S_\infty=\lim_{n\rightarrow\infty} S_n\geq 0$, que depende de las condiciones iniciales. Si $S_0\leq \frac{\gamma N}{\alpha}$, o, equivalentemente, $\mathcal{R}\leq 1$ entonces $I_1\leq I_0$ y, como $S_n$ es estrictamente decreciente, tenemos que $I_{n+1}\leq I_n$, es decir, no hay epidemia. En otro caso, tenemos $S_0> \frac{\gamma N}{\alpha}$, entonces $I_1>I_0$. Debe ocurrir que $S_x\infty <\frac{N\gamma}{\alpha}$, pues si no fuera así, tendríamos que $I_n$ crece hacia un equilibrio, $I_\infty$, lo que implica que $R_n$ se aproxima a infinito cuando $n\rightarrow\infty$, lo cuál no es posible. Así, el número de infectados finalmente comienza a decrecer y se aproxima a $0$. Además, sabemos por el Lema 1 de \cite{allenDiscretetimeSISIR1994} que $S_\infty>0$.

El modelo continuo se comporta de la misma forma que el modelo discreto, este sería:

\begin{equation}
\label{eqn: modelo_SIR_continuo}
\begin{cases}
\frac{dS}{dt} = -\frac{\alpha}{N}SI \\
\frac{dI}{dt} = I\left(\frac{\alpha}{N}S-\gamma \right) \\
\frac{dR}{dt} = R+\gamma I
\end{cases}
\end{equation}

donde $S(0)+I(0)+R(0)=N$. La tasa reproductiva en este caso es $\mathcal{R}=S(0)\alpha /(N\gamma )$, y si $\mathcal{R}\leq 1$  no hay epidemia, pero en cambio, si es mayor, hay epidemia.

He programado el modelo discreto y el resultado de la gráfica ha sido:

\begin{figure}[H]
\begin{center}
\includegraphics[scale=1]{graficaSIR}
\end{center}
\end{figure}





\section{Cosas del articulo de rsos que no sé que nombre ponerles}

\subsection{Introducción}

Estimar la tasa de transmisión media es uno de los aspectos más cruciales en epidemiología. Esta tasa condiciona la fase de la epidemia (incluso si va a extinguirse). Es combinación de tres factores:

\begin{enumerate}
\item Coeficiente de virulencia: Relacionado con el agente infeccioso.
\item Coeficiente de susceptibilidad: Relacionado con el anfitrión.
\item Número de contactos por unidad de tiempo entre individuos.
\end{enumerate}

Los dos primeros factores se tienen en cuenta a la vez en la probabilidad de transmisión.

Todos los factores pueden cambiar con el tiempo, el primero debido a mutaciones del virus y los dos últimos por medidas de contención. Por tanto, observar el decrecimiento de la transmisión media en una enfermedad es una buena forma de comprobar la efectividad de las medidas de contención.

Consideramos un modelo SI con el objetivo de compararlo con los datos obtenidos en la pandemia hasta el momento y así tratar de predecir su comportamiento en el futuro.

El modelo SI es el siguiente:

\begin{equation}
\label{eqn: SI_S_cont}
S'(t) = -\tau (t)S(t)I(t)
\end{equation}

\begin{equation}
\label{eqn: SI_I_cont}
I'(t) = \tau (t)S(t)I(t) -vI(t)
\end{equation}

donde $S(t)$ es el número de individuos susceptibles , $I(t)$ el número de individuos infectados en el tiempo $t$ y $\tau$ la tasa de transmisión, que combina el número de contactos por unidad de tiempo y la probabilidad de transmisión. Además, notemos que $v$ es constante, donde $1/v$ es la duración media del período de infección, y $vI(t)$ el flujo de individuos recuperados o fallecidos \textcolor{red}{¿Por que ese es el flujo de recuperados o muertos?}. Consideramos condiciones iniciales:

$$S(t_0)=S_0>0, \: I(t_0)=I_0>0$$

Ahora, consideramos que al final del período infeccioso nos han reportado una fracción del total de casos, en este caso $f\in (0,1]$. Sea $CR(t)$ el número total (acumulado) de casos reportados. Entonces:

\begin{equation}
\label{eqn: acumulada}
CR(t) = CR_0 + vfCI(t) \; \forall t \geq t_0
\end{equation}

\textcolor{red}{¿Por qué $vfCI(t)$ va multiplicado por $v$?}

donde

$$CI(t) = \int_{t_0}^t I(\sigma ) d\sigma $$

Asumimos conocidos $S_0 > 0$, $1/v>0$, $f\in (0,1]$. Por tanto, queremos averiguar $I_0$, $\tau (t)$

\subsection{Aproximando $I_0$ y $\tau (t_0)$}
Ahora, procedemos a intentar aproximar $I_0$ y $\tau (t_0)$:

Al comienzo de la pandemia podemos asumir que $S(t)$ y $\tau (t)$ son constantes e iguales a $S_0$ y $\tau_0 = \tau (t_0)$ respectivamente. Así, sustituyendo estos valores en la ecuación (\ref{eqn: SI_I_cont}) obtenemos:

$$I'(t) = (\tau_0 S_0 -v) I(t)$$

Resolviendo la ecuación diferencial llegamos a:

$$I(t) = I_0\exp{((\tau_0 S_0-v)(t-t_0))}$$

Sustituyendo en (\ref{eqn: acumulada}):

$$CR(t) = CR_0 + vfI_0\frac{\mathrm{e}^{(\tau_0 S_0 -v)(t-t_0)} -1}{\tau_0 S_0-v}$$

Así, hemos obtenido un primer modelo para los casos acumulados al principio de la pandemia.

Reescribimos la ecuación como:

\begin{equation}
\label{eqn: acumulada_modelo}
CR(t) = \chi_1 \mathrm{e}^{\chi_2 t} -\chi_3
\end{equation}

Estimamos $\chi_3$ usando los datos de la epidemia obtenidos, y el mejor ajuste para los datos es $\chi_3=0$

Ahora, usando (\ref{eqn: acumulada}) y (\ref{eqn: acumulada_modelo}) tenemos:

\begin{equation}
I_0=\frac{\chi_1\chi_2\mathrm{e}^{\chi_2 t_0}}{vf}
\end{equation}

Y, como de reescribir sabemos que $\chi_2 = \tau_0 S_0-v$ entonces

\begin{equation}
\tau_0 = \frac{\chi_2+v}{S_0}
\end{equation}

Si suponemos que $\tau (t) = \tau_0$ tenemos que el modelo queda:

\begin{equation}
S'(t) = -\tau_0S(t)I(t)
\end{equation}

\begin{equation}
I'(t) = \tau_0S(t)I(t) -vI(t)
\end{equation}

Usando la ecuación de $S(t)$ y resolviéndola obtenemos:

$$S(t) = S_0\exp{\left( -\tau_0 \int_{t_0}^t I(\sigma ) d\sigma \right)} = S_0\exp{(-\tau_0 CI(t))}$$

Ahora, sustituyendo esta expresión en la ecuación de $I(t)$ del modelo y usando $CI'(t)=I(t)$:

$$I'(t) = S_0\exp{\left( -\tau_0 CI(t)\right) }\tau_0 CI'(t)-vI(t)$$

Finalmente, integrando entre $t_0$ y $t$ tenemos que:

$$I(t)=CI'(t)=I_0+S_0(1-\exp{(-\tau_0 CI(t)}))-vCI(t)$$

Observamos entonces que el número total de infectados es monótono creciente (¡pero no el número de infectados!). 

\begin{theorem}
Sea $t>t_0$ fijo. El número de infectados acumulados es estrictamente creciente respecto a las siguiente cantidades:
\begin{itemize}
\item $I_0>0$ Número inicial de infectados
\item $S_0>0$ Número inicial de individuos susceptibles.
\item $\tau>0$ Tasa de transmisión
\item $1/v$ Tiempo medio de la infección.
\end{itemize}
\end{theorem}

\textcolor{blue}{ESTO ES NUEVO}

\subsection{Fórmula teórica para $\tau (t)$}

Usando la ecuación de la $S$ del modelo inicial (\ref{eqn: SI_S_cont}) obtenemos:

$$S(t) = S_0 \exp{\left( - \int_{t_0}^t \tau(\sigma ) I(\sigma ) d\sigma \right) } $$ 

Ahora, usando (\ref{eqn: SI_I_cont}):

$$I'(t) = S_0 \exp{\left( - \int_{t_0}^t \tau(\sigma ) I(\sigma ) d\sigma \right) } \tau (t) I(t) -vI(t) $$

Integramos en ambos lados entre $t_0$ y $t$, luego:

$$ CI'(t) = I_0 + S_0 \left( 1-\exp{\left(- \int_{t_0}^t \tau (\sigma ) I(\sigma )d\sigma \right)}\right) -vCI(t)$$

Equivalentemente, por (\ref{eqn: acumulada}):

$$CR'(t) = vf\left( I_0 + S_0 \left( 1-\exp{\left(- \frac{1}{vf}\int_{t_0}^t \tau (\sigma ) I(\sigma )d\sigma \right)}\right)\right) +vCR_0 -vCR(t)$$

\textcolor{red}{Esta cuenta no termina de salirme, pero tiene más o menos sentido}

Así, obtenemos el teorema 3.1 de \cite{demongeotSIEpidemicModel}, que nos da la relación directa buscada.







